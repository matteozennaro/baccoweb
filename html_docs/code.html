

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Documentation for the Code &mdash; bacco 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Several expamples of BACCO’s use" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> bacco
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">QuickStart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cosmology-class">Cosmology Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-class">Simulation Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#baryons-class">Baryons Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization-class">Visualization Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mock-class">Mock Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scaler-class">Scaler Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-bacco.statistics">Statistics Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampler-class">Sampler Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lightcone-class">Lightcone Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-bacco.utils">Utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bacco</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Documentation for the Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/code.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-bacco">
<span id="documentation-for-the-code"></span><span id="bacco-code"></span><h1>Documentation for the Code<a class="headerlink" href="#module-bacco" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cosmology-class">
<h2>Cosmology Class<a class="headerlink" href="#cosmology-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Cosmology">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Cosmology</code><span class="sig-paren">(</span><em class="sig-param">hubble=0.73</em>, <em class="sig-param">omega_cdm=0.205</em>, <em class="sig-param">omega_baryon=0.045</em>, <em class="sig-param">omega_de=None</em>, <em class="sig-param">omega_k=None</em>, <em class="sig-param">geometry='flat'</em>, <em class="sig-param">use_radiation=False</em>, <em class="sig-param">neutrino_mass=0.0</em>, <em class="sig-param">sigma8=0.9</em>, <em class="sig-param">ns=0.9611</em>, <em class="sig-param">tau=0.0952</em>, <em class="sig-param">de_model='LCDM'</em>, <em class="sig-param">w0=-1</em>, <em class="sig-param">wa=0</em>, <em class="sig-param">A_s=None</em>, <em class="sig-param">DeltaNeff=3.046</em>, <em class="sig-param">approx_nu=False</em>, <em class="sig-param">expfactor=1.0</em>, <em class="sig-param">ReNormalizeInputSpectrum=True</em>, <em class="sig-param">pkfile_expfactor=1.0</em>, <em class="sig-param">pkfile=None</em>, <em class="sig-param">initial_growth_expfac=0.01</em>, <em class="sig-param">mDM=None</em>, <em class="sig-param">tag=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that implements a cosmological model</p>
<p>It stores the cosmological parameters and gives the user access to a number of
functions to compute predictions of many quantities. If not otherwise specified
all quantities are in units of <span class="math notranslate nohighlight">\(h\)</span>. Cosmological distances are in
<span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span>, masses in <span class="math notranslate nohighlight">\(10^{10} h^{-1} \mathrm{M}_\odot\)</span>.
In bacco the preferred  time variable is neither cosmic time nor redshift,
but the expansion factor <span class="math notranslate nohighlight">\(a = 1 / (1+z)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hubble</strong> (<em>float</em><em>, </em><em>optional</em>) – Hubble parameter, H0 / 100, defaults to 0.73</p></li>
<li><p><strong>omega_cdm</strong> (<em>float</em><em>, </em><em>optional</em>) – Cold dark matter density parameter, defaults to 0.205</p></li>
<li><p><strong>omega_baryon</strong> (<em>float</em><em>, </em><em>optional</em>) – Baryon density parameter, defaults to 0.045</p></li>
<li><p><strong>omega_de</strong> (<em>float</em><em>, </em><em>optional</em>) – Dark energy density parameter, defaults to None</p></li>
<li><p><strong>omega_k</strong> (<em>float</em><em>, </em><em>optional</em>) – Curvature density parameter, defaults to None</p></li>
<li><p><strong>geometry</strong> (<em>string</em><em>, </em><em>optional</em>) – Geometry model, defaults to ‘flat’</p></li>
<li><p><strong>use_radiation</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to include radiation in the background, requires that
config[‘growth’][‘method’] be set to ‘reps’, defaults to False</p></li>
<li><p><strong>neutrino_mass</strong> (<em>float</em><em>, </em><em>optional</em>) – The total mass of neutrinos (sum of all mass eigenstates)
expressed in eV, defaults to 0</p></li>
<li><p><strong>sigma8</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear amplitude of fluctuations smoothed on the scale
<span class="math notranslate nohighlight">\(R=8 h^{-1} Mpc\)</span> at redshift <span class="math notranslate nohighlight">\(z=0\)</span>. If None, A_s should
be specified instead, defaults to 0.9</p></li>
<li><p><strong>ns</strong> (<em>float</em><em>, </em><em>optional</em>) – The spectral index of scalar primordial fluctuations, defaults to 0.9611</p></li>
<li><p><strong>tau</strong> (<em>float</em><em>, </em><em>optional</em>) – The optical depth at recombination, defaults to 0.0952</p></li>
<li><p><strong>de_model</strong> (<em>string</em>) – Dark energy model, it can be ‘LCDM’, ‘w0wa’ or ‘w0wa_steigerwald’
or the path to a valid file containing a 2 column table [z, w(z)],
defaults to ‘LCDM’</p></li>
<li><p><strong>w0</strong> (<em>float</em><em>, </em><em>optional</em>) – Present time value of the dark energy equation of state, defaults to -1</p></li>
<li><p><strong>wa</strong> (<em>float</em><em>, </em><em>optional</em>) – Time dependent parameter of the dark energy equation of state according to
LC parametrization, <span class="math notranslate nohighlight">\(w = w_0 + (1-a) w_a\)</span>, defaults to 0</p></li>
<li><p><strong>A_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the spectrum of scalar perturbations at recombination at pivot
scale <span class="math notranslate nohighlight">\(k = 0.05 \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>DeltaNeff</strong> (<em>float</em><em>, </em><em>optional</em>) – Residual number of relativistic species in the early universe (normally
considered to be 3.046), defaults to 3.046</p></li>
<li><p><strong>approx_nu</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether neutrinos should be treated as nonrelativistic matter at all times,
defaults to False</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The expansion factor <span class="math notranslate nohighlight">\(a = 1/(1+z)\)</span> at which this cosmology is defined.
All evaluation that will not include an explicit expfactor, will correspond
to this time, defaults to 1</p></li>
<li><p><strong>ReNormalizeInputSpectrum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the present time power spectrum of this cosmology should be
renormalized in order to match the given sigma_8 or A_s, defaults to True</p></li>
<li><p><strong>pkfile_expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – If pkfile is not None, this is the expfansion factor corresponding to the
time of the power spectrum contained in pkfile, defaults to 1</p></li>
<li><p><strong>pkfile</strong> (<em>string</em>) – Origin of the present time power spectrum used to build the cosmology class. If
‘CAMB’ or ‘CLASS’ are selected, the corresponding Boltzmann code will be internally
called. If the path to a file is provided, the power spectrum will be read from
such file (change pkfile_expfactor is this file is not at z=0). If None,
‘CLASS’ will be assumed, defaults to None</p></li>
<li><p><strong>initial_growth_expfac</strong> (<em>float</em><em>, </em><em>optional</em>) – If config[‘growth’][‘method’] is ‘reps’, this is the expfactor at which the
boundary conditions for the ODE solution are computed, defaults to 0.01</p></li>
<li><p><strong>mDM</strong> (<em>float</em>) – If None, standard cold dark matter is assumed; otherwise mDM is the mass of the
dark matter particle in the warm dark matter context, defaults to None</p></li>
<li><p><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em>) – The name of this cosmology, defaults to None</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to get verbose outputs, defaults to None</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bacco</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="bacco.Cosmology.As">
<code class="sig-name descname">As</code><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.As"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.As" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the amplitude of the linear perturbations at <span class="math notranslate nohighlight">\(k=0.05 \mathrm{Mpc}^{-1}\)</span> (chached)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="n">A_s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sigma8</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">As</span><span class="p">)</span>
<span class="gp">... </span><span class="mf">2.2367731302095207e-09</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.DE_EoS">
<code class="sig-name descname">DE_EoS</code><span class="sig-paren">(</span><em class="sig-param">redshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.DE_EoS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.DE_EoS" title="Permalink to this definition">¶</a></dt>
<dd><p>The time dependent equation of state <span class="math notranslate nohighlight">\(w_{\rm de}\)</span> of the dark energy component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>redshift</strong> (<em>array_like</em>) – The desired redshift(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.Ez_function">
<code class="sig-name descname">Ez_function</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Ez_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.Ez_function" title="Permalink to this definition">¶</a></dt>
<dd><p>The renormalized Hubble function H/H0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The normalized Hubble function E(a) = H(a) / H0</p>
</dd>
<dt class="field-odd">Array_like</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.Ez_function_norad">
<code class="sig-name descname">Ez_function_norad</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Ez_function_norad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.Ez_function_norad" title="Permalink to this definition">¶</a></dt>
<dd><p>The renormalized Hubble function H/H0 without radiation</p>
<p>Even if the cosmology was created with radiation, this function
return the renormalized Hubble function E(a) = H(a) / H0 computed
without including radiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The normalized radiationless Hubble function E(a) = H(a) / H0</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Cosmology.Gammas">
<code class="sig-name descname">Gammas</code><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Gammas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.Gammas" title="Permalink to this definition">¶</a></dt>
<dd><p>The parameters of the expansion of <span class="math notranslate nohighlight">\(\Omega_{m}^\gamma\)</span></p>
<p>This is referred to the log expansion presented in <a class="reference external" href="https://arxiv.org/pdf/1403.0898.pdf">https://arxiv.org/pdf/1403.0898.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary of ‘gamma0’, ‘gamma1’, ‘gamma2’</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.Kaiser_boost">
<code class="sig-name descname">Kaiser_boost</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Kaiser_boost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.Kaiser_boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Kaiser boost at a given expfactor and for a given bias
parameter (default = 1), for different multipole expansion orders:</p>
<p>l = 0, monopole
l = 2, quadrupole
l = 4, hexadecapole</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factors</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavenumbers in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – Multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.Kaiser_moments">
<code class="sig-name descname">Kaiser_moments</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Kaiser_moments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.Kaiser_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mutliplicative factors for the redshift space
moments of the power spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The moment, defaults to 0</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – Linear bias, defaults to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.comoving_radial_distance">
<code class="sig-name descname">comoving_radial_distance</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.comoving_radial_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.comoving_radial_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the comoving radial distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – Expansion factor at which the comoving radial distance is computed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Comoving radial distance in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.comoving_volume">
<code class="sig-name descname">comoving_volume</code><span class="sig-paren">(</span><em class="sig-param">z1</em>, <em class="sig-param">z2</em>, <em class="sig-param">area</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.comoving_volume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.comoving_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the comoving volume</p>
<p>It correspondes to the volume (in comoving coordinates) of
a redshift bin going from the initial redshift z1 out to
the final redshift z2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z1</strong> (<em>float</em>) – Initial redshift of the redshift bin</p></li>
<li><p><strong>z2</strong> – Final redshift of the redshift bin</p></li>
<li><p><strong>area</strong> (<em>float</em>) – Sky area in deg^2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The comoving volume in <span class="math notranslate nohighlight">\((h^{-1} \mathrm{Mpc})^3\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_biasfunction">
<code class="sig-name descname">compute_biasfunction</code><span class="sig-paren">(</span><em class="sig-param">nu=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">model=None</em>, <em class="sig-param">Delta=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_biasfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_biasfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear bias according to a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The peak-height, required if mass is not passed, defaults to None</p></li>
<li><p><strong>mass</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The mass in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{M}_\odot\)</span>, required if nu is not pass, defaults to None</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, if None the one of the cosmology class is used, defaults to None</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – The bias model to choose among ‘mowhite96’, ‘sheth01’, ‘tinker10’, defaults to None</p></li>
<li><p><strong>Delta</strong> (<em>float</em><em>, </em><em>optional</em>) – The overdensity threshold, defaults to 200</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_bihalofit">
<code class="sig-name descname">compute_bihalofit</code><span class="sig-paren">(</span><em class="sig-param">k1</em>, <em class="sig-param">k2</em>, <em class="sig-param">theta</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_bihalofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_bihalofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nonlinear bispectrum through halofit.</p>
<p>This implementation of Halofit follows Takahashi et al 2019: 1911.07886</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>array_like</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h\mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>k2</strong> (<em>array_like</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h\mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Angles between <span class="math notranslate nohighlight">\(k_1\)</span> and <span class="math notranslate nohighlight">\(k_2\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, in None the one of the cosmology
class is used, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply halofit to the cold or total matter
bispectrum, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarry</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_bispectrum_k3">
<code class="sig-name descname">compute_bispectrum_k3</code><span class="sig-paren">(</span><em class="sig-param">k1</em>, <em class="sig-param">k2</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_bispectrum_k3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_bispectrum_k3" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the length of the third leg of a triangle given the other two legs
and the angle between them.</p>
<p><span class="math notranslate nohighlight">\(k_3 = \sqrt{k_1^2 + k_2^2 - 2 k_1 k_2 \cos \vartheta}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>float</em>) – First leg of the triangle</p></li>
<li><p><strong>k2</strong> (<em>float</em>) – Second leg of the triangle</p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Angle(s) between the two legs</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_concentration">
<code class="sig-name descname">compute_concentration</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">Einasto=False</em>, <em class="sig-param">model=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the halo concentration c(M) in a given model</p>
<p>Possible models are:
‘prada12’,
‘ludlow16’,
‘ludlow16_approx’,
‘diemer15’,
‘diemer18’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – The mass in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{M}_\odot\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to None</p></li>
<li><p><strong>Einasto</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use Einasto profiles, defaults to False</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – The concentratio-mass model among ‘prada12’, ‘ludlow16’,
‘ludlow16_approx’, ‘diemer15’, ‘diemer18’, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_halofit">
<code class="sig-name descname">compute_halofit</code><span class="sig-paren">(</span><em class="sig-param">expfactor=None</em>, <em class="sig-param">boltzmann_solver=False</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_halofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_halofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halofit corrected power spectrum.</p>
<p>This implementation of Halofit follows Takahashi et al 2013: <a class="reference external" href="http://arxiv.org/pdf/1208.2701v2.pdf">http://arxiv.org/pdf/1208.2701v2.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to None</p></li>
<li><p><strong>boltzmann_solver</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the native halofit power spectrum from class/camb, defaults to False</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply halofit to the cold of total matter power spectrum, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_halomodel">
<code class="sig-name descname">compute_halomodel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_halomodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_halomodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nonlinear power spectrum with the halo model Cooray &amp; Sheth (2012)</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_massfunction">
<code class="sig-name descname">compute_massfunction</code><span class="sig-paren">(</span><em class="sig-param">nu=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">qty='nufnu'</em>, <em class="sig-param">model=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_massfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_massfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo mass function for a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The peak-height, required if mass is not passed, defaults to None</p></li>
<li><p><strong>mass</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The mass in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{M}_\odot\)</span>, required if nu is not pass, defaults to None</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, if None the one of the cosmology class is used, defaults to None</p></li>
<li><p><strong>qty</strong> (<em>str</em><em>, </em><em>optional</em>) – The form of the returned mass function to be chosen among ‘nufnu’,
‘dn_dlnM’, ‘dn_dlnM_sub’, ‘nufnu_sub’, and ‘fnu’, defaults to ‘nufnu’</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – The mass function model, to be chosen among ‘despali16’, ‘angulo12’, ‘musso12’,
‘jenkins01’, ‘PS74’, if None the one in the config.ini is used, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_sigmaR_z0">
<code class="sig-name descname">compute_sigmaR_z0</code><span class="sig-paren">(</span><em class="sig-param">rr</em>, <em class="sig-param">kmin=None</em>, <em class="sig-param">kk=None</em>, <em class="sig-param">pk=None</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">pk_interpolated=True</em>, <em class="sig-param">nthreads=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_sigmaR_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_sigmaR_z0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Computes the square root of the mass variance, <span class="math notranslate nohighlight">\(\sigma(R)\)</span>, for a given power spectrum and cosmology</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rr</strong> (<em>array_like</em>) – The smoothing radius in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>kmin</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum wavenumber used in the integration, defaults to None</p></li>
<li><p><strong>kk</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The wavemodes over which the power spectrum is required, defaults to None</p></li>
<li><p><strong>pk</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The linear power spectrum, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use the cold or total matter spectrum, defaults to True</p></li>
<li><p><strong>pk_interpolated</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to allow a resampling of the spectrum, defaults to True</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of threads for openMP (if None, all available threads
are used), defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – kk and pk should be provided</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.compute_tree_level_bispectrum">
<code class="sig-name descname">compute_tree_level_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">k1</em>, <em class="sig-param">k2</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_tree_level_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.compute_tree_level_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute tree level bispectrum, see the review by Bernardeau et al (2002)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>float</em>) – First leg of the triangle</p></li>
<li><p><strong>k2</strong> (<em>float</em>) – Second leg of the triangle</p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Angle(s) between the two legs</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.dHubble_dz">
<code class="sig-name descname">dHubble_dz</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.dHubble_dz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.dHubble_dz" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of the Hubble function with respect to redshift</p>
<p>Please note that the expfactor is passed, but dH(a) / dz(a) is
the quantity computed by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The derivative of the Hubble function wrt redshift</p>
</dd>
<dt class="field-odd">Rtype array_like</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.delta_c">
<code class="sig-name descname">delta_c</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">correction='mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.delta_c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.delta_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Critical overdensity for collapse.
We use the redshift-dependence of Kitayama &amp; Suto (1996)
– as used in Despali et al 2016 – alternatively, we can use the
value derived in S5.1 of the Mo, van den Bosch and White’s book.
If the correction is None, then the uncorrected value from the
spherical collapse model is returned.</p>
<p>Note on the neutrino case: works such as Castorina et el 2015 found that
the critical overdensity for collapse in cosmologies that include massive
neutrinos is still well approximated by the usual 1.6865 (default value
here if no correction is specified). No study to my knowledge assessed
this issue for the kitayama or mo correction. TODO: it should be in
principle easy to check if omega_matter or omega_cold should be used in
this case (I would bet on omega_cold).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
<li><p><strong>correction</strong> (<em>string</em><em>, </em><em>optional</em>) – The correction to apply for the calculation of the threshold collapse
overdensity, among none, ‘mo’ and ‘kitayama’</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.dgrowthfactor_dz">
<code class="sig-name descname">dgrowthfactor_dz</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">growthfactor=None</em>, <em class="sig-param">k=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.dgrowthfactor_dz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.dgrowthfactor_dz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the derivative <span class="math notranslate nohighlight">\(\mathrm{d}D / \mathrm{d}a\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p></li>
<li><p><strong>growthfactor</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Value of the current grwoth factor, if None computed internally, defaults to None</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, used if growth method is ‘reps’, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.fsigma8_z">
<code class="sig-name descname">fsigma8_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.fsigma8_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.fsigma8_z" title="Permalink to this definition">¶</a></dt>
<dd><p>The product <span class="math notranslate nohighlight">\(f(a) \sigma_8(a)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.gamma_z">
<code class="sig-name descname">gamma_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.gamma_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.gamma_z" title="Permalink to this definition">¶</a></dt>
<dd><p>The time dependent power low index <span class="math notranslate nohighlight">\(\gamma\)</span> of <span class="math notranslate nohighlight">\(\Omega_{\mathrm{m}}^\gamma\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_alpha_eff">
<code class="sig-name descname">get_alpha_eff</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_alpha_eff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_alpha_eff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the logarithmic derivative of the growth factor <span class="math notranslate nohighlight">\(\mathrm{d} \ln D / \mathrm{d} \ln a\)</span></p>
<p>This corresponds to <span class="math notranslate nohighlight">\(\alpha_{\rm eff}\)</span> in Diemer &amp; Joyce (2018)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes if growth method is ‘reps’, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold (True, default)
or total (False) dark matter is desired, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_concentration">
<code class="sig-name descname">get_concentration</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo concentration at cosmology expansion factor</p>
<p>Note that the model specified in config[‘nonlinear’][‘concentration’] is
used. The default is ‘ludlow16’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Halo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The halo concentration</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_concentration_z0">
<code class="sig-name descname">get_concentration_z0</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_concentration_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_concentration_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo concentration at present time</p>
<p>Note that the model specified in config[‘nonlinear’][‘concentration’] is
used. The default is ‘ludlow16’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Halo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The halo concentration</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_correlationfunction">
<code class="sig-name descname">get_correlationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_correlationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_correlationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear 2-point correlation function at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_correlationfunction_z">
<code class="sig-name descname">get_correlationfunction_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_correlationfunction_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_correlationfunction_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear 2-point correlation function at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_dlnP_dlnk">
<code class="sig-name descname">get_dlnP_dlnk</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_dlnP_dlnk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_dlnP_dlnk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the logarithmic derivative <span class="math notranslate nohighlight">\(\mathrm{d}\ln P / \mathrm{d}\ln k\)</span> for the z=0 spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_dlnS_dlnR">
<code class="sig-name descname">get_dlnS_dlnR</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">kappa=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_dlnS_dlnR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_dlnS_dlnR" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the logaritmic derivative <span class="math notranslate nohighlight">\(\mathrm{d}\ln \sigma / \mathrm{d} \ln R\)</span> at the cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>kappa</strong> (<em>float</em>) – TODO: what is kappa?</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_growth_z">
<code class="sig-name descname">get_growth_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_growth_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_growth_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the growth factor <span class="math notranslate nohighlight">\(D(a) = \sqrt{P(a) / P(a=1)}\)</span></p>
<p>If the growth method is ‘reps’, the growth rate is computed as a
scale depndent quantity and the wavemode at which it is requested
must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes if growth method is ‘reps’,
defauts to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired,
defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_halomassfunction">
<code class="sig-name descname">get_halomassfunction</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">qty='dn_dlnM'</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_halomassfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_halomassfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo mass function at the cosmology expansion factor</p>
<p>Note that the model specified in config[‘nonlinear’][‘mass_function’] is
used. The default is ‘despali16’.</p>
<p>The mass function can be returned in different forms. If qty is ‘dn_dlnM’
then it will be returned as <span class="math notranslate nohighlight">\(\mathrm{d}n / \mathrm{d}\ln M\)</span>, in units
of <span class="math notranslate nohighlight">\(h^2 \mathrm{M}_\odot^{-1} \mathrm{Mpc}^{-3}\)</span> per unit log mass.
If qty is ‘nufnu’, then the universal mass function
<span class="math notranslate nohighlight">\(\nu f(\nu)\)</span> is returned instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Halo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>qty</strong> (<em>str</em><em>, </em><em>optional</em>) – the form of the returned mass function, defaults to ‘dn_dlnM’</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_loggrowth_z">
<code class="sig-name descname">get_loggrowth_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">derivative=0</em>, <em class="sig-param">k=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_loggrowth_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_loggrowth_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the natural logarithm of the growth factor <span class="math notranslate nohighlight">\(\ln D(a)\)</span></p>
<p>For the actual growth factor see <a class="reference internal" href="#bacco.Cosmology.get_growth_z" title="bacco.Cosmology.get_growth_z"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bacco.Cosmology.get_growth_z()</span></code></a></p>
<p>If the growth method is ‘reps’, the growth rate is computed as a
scale depndent quantity and the wavemode at which it is requested
must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>derivative</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, return <span class="math notranslate nohighlight">\(\mathrm{d} \ln D / \mathrm{d} \ln a\)</span>,
defaults to 0</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes if growth method is ‘reps’, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_logvariance_z">
<code class="sig-name descname">get_logvariance_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">invert=False</em>, <em class="sig-param">derivative=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_logvariance_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_logvariance_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute logarithm of the linear density amplitude <span class="math notranslate nohighlight">\(\ln \sigma_R(a)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span>. If invert is
True, this is sigma and the radius is returned instead</p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>invert</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the radius corresponding to the given sigma,
defaults to False</p></li>
<li><p><strong>derivative</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, the logaritmic derivative
<span class="math notranslate nohighlight">\(\mathrm{d}\sigma / \mathrm{d} R\)</span> is returned,
defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired,
defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlcorrelationfunction">
<code class="sig-name descname">get_nlcorrelationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlcorrelationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlcorrelationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear 2-point correlation function at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlcorrelationfunction_z">
<code class="sig-name descname">get_nlcorrelationfunction_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlcorrelationfunction_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlcorrelationfunction_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear 2-point correlation function at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlcorrelationfunction_z0">
<code class="sig-name descname">get_nlcorrelationfunction_z0</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlcorrelationfunction_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlcorrelationfunction_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear 2-point correlation function at present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlpowerspec">
<code class="sig-name descname">get_nlpowerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlpowerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlpowerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlpowerspec_z">
<code class="sig-name descname">get_nlpowerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlpowerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlpowerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlpowerspec_z0">
<code class="sig-name descname">get_nlpowerspec_z0</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlpowerspec_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlpowerspec_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear power spectrum at present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlzcorrelationfunction">
<code class="sig-name descname">get_nlzcorrelationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlzcorrelationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlzcorrelationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear redshift space 2-point correlation function at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlzpowerspec">
<code class="sig-name descname">get_nlzpowerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlzpowerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlzpowerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear redshift space power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nlzpowerspec_z">
<code class="sig-name descname">get_nlzpowerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlzpowerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nlzpowerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear redshift space power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nonlinear_scale">
<code class="sig-name descname">get_nonlinear_scale</code><span class="sig-paren">(</span><em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nonlinear_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nonlinear_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavemode where nonlinearities become important</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the cosmology rescaling parameters,
defaults to True</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The nonlinear scale in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_nu_from_mass">
<code class="sig-name descname">get_nu_from_mass</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">correction='mo'</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nu_from_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_nu_from_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the peak-height correspondening to teh given mass at the given redshift</p>
<p>The peak-height <span class="math notranslate nohighlight">\(\nu = \delta_{\rm collapse} / \sigma(M)\)</span> depends
on the model assumed to compute the collapse threshold. If correction is None,
the spherical collapse value 1.686 is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor (if None, the comsology expansion
factor is used), defaults to None</p></li>
<li><p><strong>correction</strong> (<em>str</em><em>, </em><em>optional</em>) – The correction for the collapse density threshold (None,
‘mo’ or ‘kitayama), defaults to ‘mo’</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_powerspec">
<code class="sig-name descname">get_powerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_powerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_powerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_powerspec_z">
<code class="sig-name descname">get_powerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_powerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_powerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_powerspec_z0">
<code class="sig-name descname">get_powerspec_z0</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_powerspec_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_powerspec_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear power spectrum at present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_subhalomassfunction">
<code class="sig-name descname">get_subhalomassfunction</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">qty='dn_dlnM'</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_subhalomassfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_subhalomassfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the subhalo mass function at the cosmology expansion factor</p>
<p>Note that this is defined only if the model specified
in config[‘nonlinear’][‘mass_function’] is ‘angulo12’.</p>
<p>The mass function can be returned in different forms. If qty is ‘dn_dlnM’
then it will be returned as <span class="math notranslate nohighlight">\(\mathrm{d}n / \mathrm{d}\ln M\)</span>, in units
of <span class="math notranslate nohighlight">\(h^2 \mathrm{M}_\odot^{-1} \mathrm{Mpc}^{-3}\)</span> per unit log mass.
If qty is ‘nufnu’, then the universal mass function
<a href="#id1"><span class="problematic" id="id2">:mathrm:`\nu f(\nu)`</span></a> is returned instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Subhalo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>qty</strong> (<em>str</em><em>, </em><em>optional</em>) – the form of the returned mass function, defaults to ‘dn_dlnM’</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_variance">
<code class="sig-name descname">get_variance</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear density amplitude <span class="math notranslate nohighlight">\(\sigma_R(a)\)</span> at the cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_variance_z">
<code class="sig-name descname">get_variance_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_variance_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_variance_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear density amplitude <span class="math notranslate nohighlight">\(\sigma_R(a)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_variance_z0">
<code class="sig-name descname">get_variance_z0</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_variance_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_variance_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear density amplitude <span class="math notranslate nohighlight">\(\sigma_R(a)\)</span> at the present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_zcorrelationfunction">
<code class="sig-name descname">get_zcorrelationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zcorrelationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_zcorrelationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the redshift space 2-point correlation function at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_zpowerspec">
<code class="sig-name descname">get_zpowerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zpowerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_zpowerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear redshift space power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>l</strong> (<em>float</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_zpowerspec_moments">
<code class="sig-name descname">get_zpowerspec_moments</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zpowerspec_moments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_zpowerspec_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the momenta of teh redshift space power spectrum</p>
<p>This corresponds to <span class="math notranslate nohighlight">\(P_\ell(k) = \int \mathrm{d}\mu P(k) \mu^\ell\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>l</strong> (<em>float</em><em>, </em><em>optional</em>) – The moment <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.get_zpowerspec_z">
<code class="sig-name descname">get_zpowerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zpowerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.get_zpowerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear redshift space power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>l</strong> (<em>float</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.growthfactor">
<code class="sig-name descname">growthfactor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">exact=True</em>, <em class="sig-param">derivative=False</em>, <em class="sig-param">wavemode=None</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">nthreads=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.growthfactor" title="Permalink to this definition">¶</a></dt>
<dd><p>The linear growth factor</p>
<p>Function that computes the growth factor at high redshift (i.e. matter-radiation regime) analytically,
using Equation 5 in Gnedin et al. 2011 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJS..194...46G">http://adsabs.harvard.edu/abs/2011ApJS..194…46G</a>), while
at low redshift (i.e. matter-dark energy regime) through integration. The two regimes are linearly
interpoleted following e.g.  Benedikt Diemer 2017 (<a class="reference external" href="https://arxiv.org/pdf/1712.04512.pdf">https://arxiv.org/pdf/1712.04512.pdf</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p></li>
<li><p><strong>exact</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether if the exact solution is required TODO: what does this mean?, defaults to True</p></li>
<li><p><strong>derivative</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the derivative <span class="math notranslate nohighlight">\(\mathrm{d} \ln D / \mathrm{d} \ln a\)</span> should be
returned instead, defaults to False</p></li>
<li><p><strong>wavemode</strong> (<em>array_like</em><em>, </em><em>optional</em>) – If the growth method is ‘reps’, the wavemodes at which the growth factor
is required, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to get the cold or total matter growth factor, defaults to True</p></li>
<li><p><strong>nthreads</strong> (<em>bool</em><em>, </em><em>optional</em>) – The number of threads used for ompenMP (if None, all available threads
are used), defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>arra_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.growthfactorD2">
<code class="sig-name descname">growthfactorD2</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactorD2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.growthfactorD2" title="Permalink to this definition">¶</a></dt>
<dd><p>The second order growth factor for LPT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(a)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.growthfactorD3a">
<code class="sig-name descname">growthfactorD3a</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactorD3a"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.growthfactorD3a" title="Permalink to this definition">¶</a></dt>
<dd><p>First part of the 3rd order growth factor in LPT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.growthfactorD3b">
<code class="sig-name descname">growthfactorD3b</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactorD3b"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.growthfactorD3b" title="Permalink to this definition">¶</a></dt>
<dd><p>Second part of the 3rd order growth factor in LPT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.growthrate">
<code class="sig-name descname">growthrate</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">k=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.growthrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the growth rate at the given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter growth rate, defaults to True</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavenumbers in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.hubble_z">
<code class="sig-name descname">hubble_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.hubble_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.hubble_z" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hubble function H</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Hubble function H(a) in <span class="math notranslate nohighlight">\(\mathrm{km} \, \mathrm{s}^{-1} \, \mathrm{Mpc}^{-1}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.lookback_time">
<code class="sig-name descname">lookback_time</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.lookback_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.lookback_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute lookback time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lookback time in Gyrs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.luminosity_distance">
<code class="sig-name descname">luminosity_distance</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.luminosity_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.luminosity_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the luminosity distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – Expfactor of the required luminosity distance</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Luminosity distance in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.mass_to_eulerian_radius">
<code class="sig-name descname">mass_to_eulerian_radius</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">overdensity=200.0</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_eulerian_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.mass_to_eulerian_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the radius <span class="math notranslate nohighlight">\(R_{200, \mathrm{crit}}\)</span> enclosing a given mass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Mass in a sphere expressed in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p></li>
<li><p><strong>overdensity</strong> (<em>float</em><em>, </em><em>optional</em>) – Overdensity threshold, defaults to 200</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled simulation parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radius <cite>R_{200, mathrm{crit}}</cite> in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.mass_to_nu">
<code class="sig-name descname">mass_to_nu</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">expfactor=1</em>, <em class="sig-param">correction='mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_nu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.mass_to_nu" title="Permalink to this definition">¶</a></dt>
<dd><p>Peak height nu given a mass M, at time given by expfact.</p>
<p>Note that this is always computed for the cold matter component (which
is different from the total matter fraction when neutrinos are considered)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
<li><p><strong>correction</strong> (<em>string</em><em>, </em><em>optional</em>) – The correction to apply for the calculation of the threshold collapse
overdensity, among none, ‘mo’ and ‘kitayama’</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.mass_to_overdensity">
<code class="sig-name descname">mass_to_overdensity</code><span class="sig-paren">(</span><em class="sig-param">enclosed_mass</em>, <em class="sig-param">radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_overdensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.mass_to_overdensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the enclosed overdensity relative to the critical density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encolsed_mass</strong> – The mass enclosed in a sphere of given radius, in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius enclosing the given mass, in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{Mpc}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.mass_to_radius">
<code class="sig-name descname">mass_to_radius</code><span class="sig-paren">(</span><em class="sig-param">mass</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.mass_to_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the radius enclosing a given cold (cdm + baryons) mass</p>
<p>Note that this is always computed for the cold matter component (baryons
and cdm), which is different from the total matter fraction when
neutrinos are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mass</strong> (<em>array_like</em>) – Mass in a sphere expressed in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radius in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.neutrino_eos">
<code class="sig-name descname">neutrino_eos</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_eos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.neutrino_eos" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent neutrino pressure parameter, <span class="math notranslate nohighlight">\(w_\nu(a)\)</span>.</p>
<p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.neutrino_fluid_free_streaming_scale">
<code class="sig-name descname">neutrino_fluid_free_streaming_scale</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_fluid_free_streaming_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.neutrino_fluid_free_streaming_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent neutrino free streaming scale <span class="math notranslate nohighlight">\(h\)</span> / Mpc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.neutrino_fluid_speed_of_sound">
<code class="sig-name descname">neutrino_fluid_speed_of_sound</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_fluid_speed_of_sound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.neutrino_fluid_speed_of_sound" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent neutrino sound speed in km / s</p>
<p>See Blas et al (2014) for details</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.neutrino_nonrel_transition">
<code class="sig-name descname">neutrino_nonrel_transition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_nonrel_transition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.neutrino_nonrel_transition" title="Permalink to this definition">¶</a></dt>
<dd><p>Expansion factor at the time on non-rel transition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.nu_to_mass">
<code class="sig-name descname">nu_to_mass</code><span class="sig-paren">(</span><em class="sig-param">nu</em>, <em class="sig-param">expfactor=1</em>, <em class="sig-param">correction='mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.nu_to_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.nu_to_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Mass M given the Peak height nu, at time given by expfact.</p>
<p>Note that this is always computed for the cold matter component (which
is different from the total matter fraction when neutrinos are considered)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em>) – peak height</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
<li><p><strong>correction</strong> (<em>string</em><em>, </em><em>optional</em>) – The correction to apply for the calculation of the threshold collapse
overdensity, among none, ‘mo’ and ‘kitayama’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.nu_to_radius">
<code class="sig-name descname">nu_to_radius</code><span class="sig-paren">(</span><em class="sig-param">nu</em>, <em class="sig-param">expfactor=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.nu_to_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.nu_to_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Radius R given the Peak height nu, at time given by expfact.</p>
<p>Note that this is always computed for the cold matter component (which
is different from the total matter fraction when neutrinos are considered)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em>) – peak height</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding radius in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_baryons_z">
<code class="sig-name descname">omega_baryons_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_baryons_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_baryons_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the baryon density parameter :math:<a href="#id3"><span class="problematic" id="id4">`</span></a>Omega_{</p>
</div></blockquote>
<p>m b}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_cdm_z">
<code class="sig-name descname">omega_cdm_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_cdm_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_cdm_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the cold dark matter density parameter :math:<a href="#id5"><span class="problematic" id="id6">`</span></a>Omega_{</p>
</div></blockquote>
<p>m cdm}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_cold_z">
<code class="sig-name descname">omega_cold_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_cold_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_cold_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the cold matter (cdm+baryon) density parameter :math:<a href="#id7"><span class="problematic" id="id8">`</span></a>Omega_{</p>
</div></blockquote>
<p>m cold}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_de_z">
<code class="sig-name descname">omega_de_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_de_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_de_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the dark energy density parameter :math:<a href="#id9"><span class="problematic" id="id10">`</span></a>Omega_{</p>
</div></blockquote>
<p>m de}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_matter_z">
<code class="sig-name descname">omega_matter_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_matter_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_matter_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the total matter density parameter :math:<a href="#id11"><span class="problematic" id="id12">`</span></a>Omega_{</p>
</div></blockquote>
<p>m m}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_neutrino_nonrel">
<code class="sig-name descname">omega_neutrino_nonrel</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_neutrino_nonrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_neutrino_nonrel" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Time dependent non-relativistic neutrino fraction, :math:<a href="#id13"><span class="problematic" id="id14">`</span></a>[1 - 3 <a href="#id33"><span class="problematic" id="id34">w_</span></a></p>
</div></blockquote>
<p>u(a)]Omega_
u(a)`</p>
<blockquote>
<div><p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_neutrino_rel">
<code class="sig-name descname">omega_neutrino_rel</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_neutrino_rel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_neutrino_rel" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Time dependent relativistic neutrino fraction, :math:<a href="#id15"><span class="problematic" id="id16">`</span></a>3 <a href="#id35"><span class="problematic" id="id36">w_</span></a></p>
</div></blockquote>
<p>u(a) Omega_
u(a)`</p>
<blockquote>
<div><p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_neutrino_z">
<code class="sig-name descname">omega_neutrino_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_neutrino_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_neutrino_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the neutrino density parameter :math:<a href="#id17"><span class="problematic" id="id18">`</span></a>Omega_</p>
</div></blockquote>
<p>u(a)`</p>
<blockquote>
<div><p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.omega_rad_z">
<code class="sig-name descname">omega_rad_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_rad_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.omega_rad_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the radiation density parameter :math:<a href="#id19"><span class="problematic" id="id20">`</span></a>Omega_{</p>
</div></blockquote>
<p>m cdm}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.radius_to_eulerian_mass">
<code class="sig-name descname">radius_to_eulerian_mass</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">overdensity=200.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.radius_to_eulerian_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.radius_to_eulerian_mass" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compute the mass related to the given critical overdensity threshold within a given radius</p>
<p>This is the mass enclosed in a sphere of radius R, such that the overdensity
in this sphere is :math:<a href="#id21"><span class="problematic" id="id22">`</span></a></p>
</div></blockquote>
<dl class="simple">
<dt>arepsilon` times the critical density, where</dt><dd><p>:math:<a href="#id23"><span class="problematic" id="id24">`</span></a></p>
</dd>
</dl>
<p>arepsilon` is given by the parameter overdensity</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param radius</dt>
<dd class="field-odd"><p>Radius of a sphere in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-even">type radius</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">param overdensity</dt>
<dd class="field-odd"><p>Overdensity threshold, defaults to 200</p>
</dd>
<dt class="field-even">type overdensity</dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">returns</dt>
<dd class="field-odd"><p>Enclosed <span class="math notranslate nohighlight">\(M_{200, \mathrm{crit}}\)</span> in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p>
</dd>
<dt class="field-even">rtype</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.radius_to_mass">
<code class="sig-name descname">radius_to_mass</code><span class="sig-paren">(</span><em class="sig-param">radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.radius_to_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.radius_to_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mass M enclosed in a given radius</p>
<p>Note that this is always computed for the cold matter component (baryons
and cdm), which is different from the total matter fraction when
neutrinos are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>radius</strong> (<em>array_like</em>) – Radius of a sphere in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Enclosed mass in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.redshift_to_comoving_distance">
<code class="sig-name descname">redshift_to_comoving_distance</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.redshift_to_comoving_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.redshift_to_comoving_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the redshift corresponding to a given radial comoving distance.</p>
<p>:param d : Comoving radial distance in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span>
:type d: array_like</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Redshift corresponding to d</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.reps_boundary_conditions">
<code class="sig-name descname">reps_boundary_conditions</code><span class="sig-paren">(</span><em class="sig-param">boundary_expfactor</em>, <em class="sig-param">kmax=10.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.reps_boundary_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.reps_boundary_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and store the boundary conditions used by reps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boundary_expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>kmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavelength considered, defaults to config[‘pk’][‘ktransition’]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.reps_growth">
<code class="sig-name descname">reps_growth</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">betab=None</em>, <em class="sig-param">betan=None</em>, <em class="sig-param">fzib=None</em>, <em class="sig-param">fzic=None</em>, <em class="sig-param">fzin=None</em>, <em class="sig-param">boundary_expfactor=0.02</em>, <em class="sig-param">kmax=10.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.reps_growth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.reps_growth" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to call reps.</p>
<p>This function calls reps to create a table of scal dependent growth factors
and growth rates at a number of expansion factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factors</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>betab</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The baryon to cdm fraction, defaults to None</p></li>
<li><p><strong>betan</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The neutrino to cdm fraction, defaults to None</p></li>
<li><p><strong>fzib</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The baryon growth rate at the time corresponding to the
boundary conditions, defaults to None</p></li>
<li><p><strong>fzic</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The cdm growth rate at the time corresponding to the
boundary conditions, defaults to None, defaults to None</p></li>
<li><p><strong>fzin</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The neutrino growth rate at the time corresponding to the
boundary conditions, defaults to None</p></li>
<li><p><strong>boundary_expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The expansion factor of the boundary
conditions, defaults to 0.02</p></li>
<li><p><strong>kmax</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The maximum wavemode considered, defaults to config[‘pk’][‘ktransition’]</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.rho_de">
<code class="sig-name descname">rho_de</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">derivative=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.rho_de"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.rho_de" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Time dependent dark energy density normalized :math:<a href="#id25"><span class="problematic" id="id26">`</span></a>Omega_{</p>
</div></blockquote>
<p>m de}(a) / Omega_{
m de,0}`.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">param derivative</dt>
<dd class="field-odd"><p>By default (False) returns density, otherwise returns the
derivative :math:<a href="#id27"><span class="problematic" id="id28">`</span></a>mathrm{d}Omega_{</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>m de} / mathrm{d} a`,</dt><dd><blockquote>
<div><p>defaults to False</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">type derivative</dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
<dt class="field-even">returns</dt>
<dd class="field-even"><p>Either the normalized dark energy density or its derivative</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.rhoback_z">
<code class="sig-name descname">rhoback_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.rhoback_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.rhoback_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the background density in units of <span class="math notranslate nohighlight">\(10^{10} M_\odot \mathrm{Mpc}^{-3} h^{-2}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The background density in units of <span class="math notranslate nohighlight">\(10^{10} M_\odot \mathrm{Mpc}^{-3} h^{-2}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.rhocrit_z">
<code class="sig-name descname">rhocrit_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.rhocrit_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.rhocrit_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the critical density in units of <span class="math notranslate nohighlight">\(\mathrm{M}_\odot /\mathrm{Mpc}^3 h^2\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The critical density in units of <span class="math notranslate nohighlight">\(\mathrm{M}_\odot /\mathrm{Mpc}^3 h^2\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.set_expfactor">
<code class="sig-name descname">set_expfactor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_expfactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.set_expfactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the expansion factor of this cosmology.</p>
<p>All quantities not explicitly requiring a expansion factor will be evaluated
at the one specified here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>float</em>) – The required expansion factor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.set_initial_growth_expfac">
<code class="sig-name descname">set_initial_growth_expfac</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_initial_growth_expfac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.set_initial_growth_expfac" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the expansion factor used to compute the boundary conditions for reps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>float</em>) – The required expansion factor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.set_par">
<code class="sig-name descname">set_par</code><span class="sig-paren">(</span><em class="sig-param">par=None</em>, <em class="sig-param">value=None</em>, <em class="sig-param">fixed_omega_matter=True</em>, <em class="sig-param">geometry='flat'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_par"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.set_par" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Set a parameter of the cosmology class.</p>
<p>Please note this is the recommended way of changing parameters of a existing cosmology.
Trying to directly access the stored parameters may result in inconsistencies. This
function instead performs all the needed checks, and updates the relevant variables.</p>
<dl class="field-list simple">
<dt class="field-odd">param par</dt>
<dd class="field-odd"><p>The name of the cosmology parameter to update, defaults to None</p>
</dd>
<dt class="field-even">type par</dt>
<dd class="field-even"><p>string, optional</p>
</dd>
<dt class="field-odd">param value</dt>
<dd class="field-odd"><p>The new value for the parameter ‘par’, defaults to None</p>
</dd>
<dt class="field-even">type value</dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">param fixed_omega_matter</dt>
<dd class="field-odd"><p>Whether to keep the value of
:math:<a href="#id29"><span class="problematic" id="id30">`</span></a>Omega_{</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>m m}` unchanged, defaults to True</dt><dd><dl class="field-list simple">
<dt class="field-odd">type fixed_omega_matter</dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
<dt class="field-even">param geometry</dt>
<dd class="field-even"><p>If ‘flat’, ensures that after changes to the values of the density
parameters, they still sum to 1, defaults to ‘flat’</p>
</dd>
<dt class="field-odd">type geometry</dt>
<dd class="field-odd"><p>string, optional</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="o">**</span><span class="n">bacco</span><span class="o">.</span><span class="n">cosmo_parameters</span><span class="o">.</span><span class="n">nenya</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">omega_cdm_z</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">... </span><span class="mf">0.265</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;omega_cdm&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">omega_cdm_z</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">... </span><span class="mf">0.8</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.set_rescaling">
<code class="sig-name descname">set_rescaling</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_rescaling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.set_rescaling" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the rescaling parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> – The dictionary of the rescaling parameters as returned
by <a class="reference internal" href="#bacco.Scaler.runmin" title="bacco.Scaler.runmin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bacco.Scaler.runmin()</span></code></a>.</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="o">**</span><span class="n">bacco</span><span class="o">.</span><span class="n">cosmo_parameters</span><span class="o">.</span><span class="n">nenya</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="o">**</span><span class="n">bacco</span><span class="o">.</span><span class="n">cosmo_parameters</span><span class="o">.</span><span class="n">narya</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Scaler</span><span class="p">(</span><span class="n">original_cosmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">runmin</span><span class="p">(</span><span class="n">target_cosmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">original_cosmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_cosmo</span><span class="o">.</span><span class="n">set_rescaling</span><span class="p">(</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">])</span> <span class="c1"># now it should look like target</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Cosmology.sigma8">
<code class="sig-name descname">sigma8</code><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.sigma8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.sigma8" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(sigma_8(z=0)\)</span> (cached)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="n">A_s</span><span class="o">=</span><span class="mf">2.23677e-9</span><span class="p">,</span> <span class="n">sigma8</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">sigma8</span><span class="p">)</span>
<span class="gp">... </span><span class="mf">0.8</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.sigma8_z">
<code class="sig-name descname">sigma8_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.sigma8_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.sigma8_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear amplitude of fluctuations smoothed on a scale <span class="math notranslate nohighlight">\(R=8 h^{-1} \mathrm{Mpc}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.time_to_present">
<code class="sig-name descname">time_to_present</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.time_to_present"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.time_to_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute time from elapsed from goven expansion factor present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Elapsed time in internal units</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Cosmology.vel_factor">
<code class="sig-name descname">vel_factor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.vel_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Cosmology.vel_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the multiplicative factor <span class="math notranslate nohighlight">\(D_v: v(q) = D_v \Psi(q)\)</span>, where
<span class="math notranslate nohighlight">\(\Psi\)</span> is the displacemnt field</p>
<p>In case of scaling with massive neutrinos:
growthrate will be taken by default at <span class="math notranslate nohighlight">\(k = 0.5 h/\mathrm{Mpc}\)</span>. This is fine
as long as this correction is applied to scales below the free streaming scale,
while for larger scales the matching of velocities is taken care of by the
large scale correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="simulation-class">
<h2>Simulation Class<a class="headerlink" href="#simulation-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Simulation">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Simulation</code><span class="sig-paren">(</span><em class="sig-param">basedir=None</em>, <em class="sig-param">dm_file=None</em>, <em class="sig-param">halo_file=None</em>, <em class="sig-param">desc_file=None</em>, <em class="sig-param">tree_file=None</em>, <em class="sig-param">lgals_file=None</em>, <em class="sig-param">sim_cosmology=None</em>, <em class="sig-param">parameter_file=None</em>, <em class="sig-param">Nmesh=None</em>, <em class="sig-param">snapnum=None</em>, <em class="sig-param">use_orphans=False</em>, <em class="sig-param">tag='Default'</em>, <em class="sig-param">pkfile=None</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">ns=None</em>, <em class="sig-param">tau=None</em>, <em class="sig-param">A_s=None</em>, <em class="sig-param">sigma8=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">sim_format='gadget_hdf5'</em>, <em class="sig-param">do_compression=False</em>, <em class="sig-param">dask=False</em>, <em class="sig-param">fixedPk=None</em>, <em class="sig-param">RaylQuantile=0</em>, <em class="sig-param">phase=None</em>, <em class="sig-param">add_relativistic_effects=False</em>, <em class="sig-param">lpicola=False</em>, <em class="sig-param">pinocchio=False</em>, <em class="sig-param">total_snapshots=100</em>, <em class="sig-param">numpart=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that defines a cosmological simulation</p>
<dl class="method">
<dt id="bacco.Simulation.compute_subhalo_mask">
<code class="sig-name descname">compute_subhalo_mask</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Simulation.compute_subhalo_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes 2 masks to apply to subhalo positions and velocities: one mask
selects subs according a property (vmax, vpeak), either retaining
only the objects that make up the given number density n (if cut is
None), or retaining all objects with values of the given propery larger
than cut.</p>
<dl>
<dt>Inputs:</dt><dd><p>prop:              the property used to sort subs (vmax, vpeak)
cut:               the threshold for prop; if None, n is used to</p>
<blockquote>
<div><p>fix a number density</p>
</div></blockquote>
<p>n:                 used when cut is None to fix a number density
compute_noOrphans: if True, only subs that are not orphans are</p>
<blockquote>
<div><p>retained</p>
</div></blockquote>
<dl class="simple">
<dt>no_destruction:    if False, only consider subs that are still</dt><dd><p>alive</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="simple">
<dt>mask, mask_orph:   two masks, the first one that selects the</dt><dd><p>subs that comply with the selection criterion
while mask_orph selects, from the provious
sample, the ones that are not orphans</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Simulation.store_and_load_sdm_statistics">
<code class="sig-name descname">store_and_load_sdm_statistics</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_method='sampled'</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">gadget_pk=False</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.store_and_load_sdm_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Simulation.store_and_load_sdm_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>To load power spectrum, correlation function &amp; bispectrum from file.</p>
<p>If the file does not exist or force_recompute is True, these quantities
are computed and stored to file, before being returned.</p>
<p>TODO: could possibly become part of self.sdmPower</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Simulation.store_and_load_statistics">
<code class="sig-name descname">store_and_load_statistics</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_method='sampled'</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">dilution=None</em>, <em class="sig-param">gadget_pk=False</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.store_and_load_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Simulation.store_and_load_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>To load power spectrum, correlation function &amp; bispectrum from file.</p>
<p>If the file does not exist or force_recompute is True, these quantities
are computed and stored to file, before being returned.</p>
<p>If dilution is not None, it must contain the dilution level expressed as
the percentage of particles to RETAIN (so, dilution=0.2 will create a
catalogue containing the 20% of the original catalogue).</p>
<p>TODO: could possibly become part of self.Power</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Simulation.store_and_load_xspectra">
<code class="sig-name descname">store_and_load_xspectra</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_method='brute-force'</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">dilution=None</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.store_and_load_xspectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Simulation.store_and_load_xspectra" title="Permalink to this definition">¶</a></dt>
<dd><p>To load cross power spectrum from file.</p>
<p>If the file does not exist or force_recompute is True, these quantity
is computed and stored to file, before being returned.</p>
<p>If dilution is not None, it must contain the dilution level expressed as
the percentage of particles to RETAIN (so, dilution=0.2 will create a
catalogue containing the 20% of the original catalogue).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="baryons-class">
<h2>Baryons Class<a class="headerlink" href="#baryons-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Baryons">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Baryons</code><span class="sig-paren">(</span><em class="sig-param">Simulation</em>, <em class="sig-param">M_c=120000000000000.0</em>, <em class="sig-param">eta=0.5</em>, <em class="sig-param">beta=0.6</em>, <em class="sig-param">M1=152600000000.0</em>, <em class="sig-param">eject_model='A'</em>, <em class="sig-param">use_dm=False</em>, <em class="sig-param">use_sdm=True</em>, <em class="sig-param">component_subsample=False</em>, <em class="sig-param">single_component=None</em>, <em class="sig-param">mode='truncated'</em>, <em class="sig-param">ParticlesRadius=1.0</em>, <em class="sig-param">bin=(0.1</em>, <em class="sig-param">20.0</em>, <em class="sig-param">30)</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">tauv=8</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">min_halo_mass=100.0</em>, <em class="sig-param">max_halo_mass=1000000.0</em>, <em class="sig-param">mass_binning=False</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">halos=None</em>, <em class="sig-param">logpars=False</em>, <em class="sig-param">SMHM_z_evolution=True</em>, <em class="sig-param">thermodynamical_props=False</em>, <em class="sig-param">tag='standardAGN'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to compute baryonic effects on a N-body simulation.</p>
<p>This class implements a baryonic correction model to
modify the density field of a gravity-only simulation,
following Aricò et al. 2020.</p>
<p>——-inputs:</p>
<p>Simulation: simulation, the Simulation you want to use to compute the baryonic effects
M_c: float, characteristic halo mass for the hot-gas suppression (see Mohammed et al 2015 &lt;arXiv1410.6826&gt;)
eta: float, scaling factor of the ejected gas radius as a function of the escape radius, i.e. r_ej=eta*r_esc
beta: float, slope of the hot-gas suppression toward small halo masses
M1: float, parameter that control both the normalization and the slope of the mass fraction of central galaxy/halo
eject_model: str, ‘A’ for modeling the ejected radius proportionally to the halo escape radius e.g. ej_rad = eta * ej_esc;</p>
<blockquote>
<div><p>‘B’ for a more complex and phisical motivated model, obtained integrating the Maxwell-Boltzmann distribution</p>
</div></blockquote>
<p>use_dm: bool, whether to apply the baryon corrections to all the Simulation particles or not
use_sdm: bool, whether to apply the baryon corrections to the Simulation particles or not
component_subsample: bool, whether to assign the particle to a specific component or not
single_component: string, considering the effect of just one component (e.g. eject_gas’, ‘galaxy’, ‘bound_gas’, ‘relax_dark_matter’)
mode: string,</p>
<blockquote>
<div><p>‘truncated’ (default) to truncate the density profiles performing long-range displacements (e.g. Aricò et al. 2020);
‘all’ to displace all the particles (e.g. Schneider &amp; Teyssier et al. 2016);
‘fof’ to displace only the particles belonging to the fof halo (warning: this is not formally correct!);
‘outern’ to indicate the radius from the halo center in which displace the particles</p>
</div></blockquote>
<p>ParticlesRadius: float, maximum radius within you want to displace particles in outern mode (in r_200 units)
bin: Tuple, initial and final radii in r_200 units, and number of shells to compute the profiles
plot: bool,
tauv: double, truncation of NFW profile; tau = tauv*concentration
min_halo_mass: float, minimum halo mass to compute the baryon corrections, in unit of 10^10 solar masses
max_halo_mass: float, maximum halo mass to compute the baryon corrections, in unit of 10^10 solar masses
mass_binning: bool, wheter to apply the corrections binning the halos in mass or not.
halos: list of halos ids for computing the baryon corrections. If None, all the halos wil be considered.
thermodynamical_props: Bool, wheter to compute thermodynamical properties as Temperature and Pressure or not</p>
<p>—-outputs:</p>
<blockquote>
<div><p>Baryons object</p>
</div></blockquote>
<dl class="attribute">
<dt id="bacco.Baryons.ComponentsPower">
<code class="sig-name descname">ComponentsPower</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.ComponentsPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.ComponentsPower" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns a dictionary with power spectrum of the different components</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Baryons.Correl">
<code class="sig-name descname">Correl</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.Correl" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass correlation function on the baryon simulation.</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Baryons.Fields">
<code class="sig-name descname">Fields</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.Fields" title="Permalink to this definition">¶</a></dt>
<dd><p>return a dictionary with the positions and the masses of the different components</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Baryons.Mfof_200">
<code class="sig-name descname">Mfof_200</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Mfof_200"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.Mfof_200" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the Mass of the particles belonging to the FOF halos inside r200</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Baryons.Power">
<code class="sig-name descname">Power</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.Power" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass power spectrum on the baryon simulation</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.approximate_baryon_simulation">
<code class="sig-name descname">approximate_baryon_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.approximate_baryon_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.approximate_baryon_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which compute and apply the displacement of particles in a simulation,
binning the halos by mass.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.create_baryon_simulation">
<code class="sig-name descname">create_baryon_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.create_baryon_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.create_baryon_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which compute and apply the displacement of particles in a simulation,
on halo-by-halo basis.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.minimise_rho_r">
<code class="sig-name descname">minimise_rho_r</code><span class="sig-paren">(</span><em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">frac</em>, <em class="sig-param">rhob200</em>, <em class="sig-param">M_200</em>, <em class="sig-param">rho_og_r200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.minimise_rho_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.minimise_rho_r" title="Permalink to this definition">¶</a></dt>
<dd><p>A function wich find a rho’ and r’ such that a nfw profile + costant is normalised
at r200</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.pressure_bound_gas">
<code class="sig-name descname">pressure_bound_gas</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">norm</em>, <em class="sig-param">rho_s</em>, <em class="sig-param">gammaf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.pressure_bound_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.pressure_bound_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which return a ploytropic density profile, in erg/cm^3
following  Martizzi et al. 2013</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.rho_nfw_plus_constant">
<code class="sig-name descname">rho_nfw_plus_constant</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">y1</em>, <em class="sig-param">norm</em>, <em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_nfw_plus_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.rho_nfw_plus_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>A NFW profile + constant, used to make sure that the density is continous in
the truncation mode</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Baryons.sdmCorrel">
<code class="sig-name descname">sdmCorrel</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.sdmCorrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.sdmCorrel" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass correlation function on the baryon simulation, using
a subsampled catalogue of particles.</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.Baryons.sdmPower">
<code class="sig-name descname">sdmPower</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.sdmPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.sdmPower" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass power spectrum on the baryon simulation, using
a subsampled catalogue of particles.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.temperature_bound_gas">
<code class="sig-name descname">temperature_bound_gas</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">rho_s</em>, <em class="sig-param">gammaf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.temperature_bound_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.temperature_bound_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bound gas Temperature profiles in K</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Baryons.universal_pressure_profile">
<code class="sig-name descname">universal_pressure_profile</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.universal_pressure_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Baryons.universal_pressure_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which return the universal density profile of a cluster, in erg/cm^3
following  Nagai, Kravtsov &amp; Vikhlinin 2007; Arnaud et al 2010.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="visualization-class">
<h2>Visualization Class<a class="headerlink" href="#visualization-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Visualization">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Visualization</code><span class="sig-paren">(</span><em class="sig-param">pos=None, simulation=None, npix=[128, 128], boxsize=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualization class</p>
<p>in principle this should simply take a simulation object
and offer several methods to visualize the simulattion simply</p>
<p>since the simulation objects are not working for generic 
cases, right now the current default usage is to provide
an (idsorted) position array and the boxsize</p>
<dl class="method">
<dt id="bacco.Visualization.image">
<code class="sig-name descname">image</code><span class="sig-paren">(</span><em class="sig-param">maxngrid=0</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">show=False</em>, <em class="sig-param">wrapto=None</em>, <em class="sig-param">spherical_smoothing=None</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">rfac=None</em>, <em class="sig-param">tetnbody=None</em>, <em class="sig-param">mass=1.0</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws (resampled interpolated) particles using a projection matrix</p>
<p>This function use the sheet interpolation to create interpolated
pseudo particles which are binned to an image. The parameters
control projection, refinement, weighting, binning and wrapping</p>
<dl class="simple">
<dt>pos<span class="classifier">numpy array of float 32 with shape (npart, 3)</span></dt><dd><p>input positions which are assumed to be sorted (unless ids given)</p>
</dd>
<dt>projection<span class="classifier">numpy array of float 32 with shape (4,4) </span></dt><dd><p>matrix that is used to project the positions to the image
plane (which goes from [-0.5,0.5] in x and y and [0,1] in z for
distance clipping). Best to use functions to define it</p>
</dd>
<dt>npix<span class="classifier">tuple with 2 ints of form (npix_x, npix_y)</span></dt><dd><p>defines x and y pixel resolution</p>
</dd>
<dt>boxsize<span class="classifier">float</span></dt><dd><p>boxsize (used for periodic wrapping – to [-L/2, L/2])</p>
</dd>
<dt>wrapto<span class="classifier">tuple with 3 floats of form (x, y, z)</span></dt><dd><p>(if boxsize &gt; 0.) the wrapping is done sothat (x,y,z) is the
center of the box (note that no shift is applied). Usually you 
should use wrapto = lookat (or eye) when using a lookat matrix</p>
</dd>
<dt>maxngrid<span class="classifier">integer</span></dt><dd><p>maximum resampled particles per tet per dimension (in the default
deposit mode the number of resampled particles is set exactly to 
this)</p>
</dd>
<dt>nthreads: integer</dt><dd><p>number of openmp threads</p>
</dd>
</dl>
<dl class="simple">
<dt>ndeposit<span class="classifier">int32 array of length npart to specify the deposit depth</span></dt><dd><p>for each tet (limitted to maxngrid)</p>
</dd>
<dt>fade<span class="classifier">tuple of two float32 arrays of form tuple(ri, fi)</span></dt><dd><p>ri specifies a set of distances and fi specifies the weight 
particles at each distance should be multiplied with</p>
</dd>
<dt>spherical<span class="classifier">boolean</span></dt><dd><p>set to True to use equirectangular projection</p>
</dd>
<dt>rclip<span class="classifier">tuple of two float32 (rnear, rfar)</span></dt><dd><p>clipping boundaries in case of spherical projection (ignored 
otherwise)</p>
</dd>
<dt>mass<span class="classifier">a single float or an array of npart float32</span></dt><dd><p>particle mass(es) used for weighting</p>
</dd>
<dt>ids<span class="classifier">numpy array of npart int64 values</span></dt><dd><p>if specified these will be used for sorting the positions</p>
</dd>
<dt>usecic<span class="classifier">boolean</span></dt><dd><p>set to True if you want a cic binning (otherwise ngp)</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>verbosity (can be 0 for no output or higher)</p>
</dd>
</dl>
<p>don’t use these for now, look into qtets.imagenew for more information</p>
<p>Typically you want to call this function in the following manner
proj = matrix_perspective_lookat(…)
myim = vi.qtets_image(pos, proj, npix=.., boxsize=.., wrapto=..,</p>
<blockquote>
<div><p>maxngrid=4, nthreads=4)</p>
</div></blockquote>
<p>where npix and maxngrid are the main quality parameters. Make sure
that pos and proj are float32 arrays with the correct shapes.
More advanced features are best interfaced through the Visualization
class below</p>
<p>catch errors with wrong shapes
catch error for int32 ids
simplify code for checking input</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.project_points">
<code class="sig-name descname">project_points</code><span class="sig-paren">(</span><em class="sig-param">pos=None</em>, <em class="sig-param">boxwrapping=False</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">wrapto=None</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">clipping=True</em>, <em class="sig-param">pixels=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.project_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.project_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Projects points in to the image plane normalized to (-0.5,0.5)</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_fade_equation">
<code class="sig-name descname">set_fade_equation</code><span class="sig-paren">(</span><em class="sig-param">ri=None</em>, <em class="sig-param">rclip=None</em>, <em class="sig-param">rfade=None</em>, <em class="sig-param">r0=1.0</em>, <em class="sig-param">rpow=0.0</em>, <em class="sig-param">plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_fade_equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_fade_equation" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives some intuitive interface for the fading equation</p>
<p>The goal is to define a set of ri and fi values as a radial 
weighting function. Use plot=True to see what happens</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_fading">
<code class="sig-name descname">set_fading</code><span class="sig-paren">(</span><em class="sig-param">ri</em>, <em class="sig-param">fi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_fading"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_fading" title="Permalink to this definition">¶</a></dt>
<dd><p>set fading (distance dependent weights)</p>
<p>ri : radii of the weights
fi : weights</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_fixed_smoothing">
<code class="sig-name descname">set_fixed_smoothing</code><span class="sig-paren">(</span><em class="sig-param">r=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_fixed_smoothing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_fixed_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>set a fixed smoothing</p>
<dl class="simple">
<dt>r<span class="classifier">float</span></dt><dd><p>size of the smoothing in percent of the image width</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_mixed_tetnb">
<code class="sig-name descname">set_mixed_tetnb</code><span class="sig-paren">(</span><em class="sig-param">relf</em>, <em class="sig-param">npos=None</em>, <em class="sig-param">mass=0.015625</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_mixed_tetnb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_mixed_tetnb" title="Permalink to this definition">¶</a></dt>
<dd><p>relf has shape (ngrid/2, ngrid/2, ngrid/2)</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_perspective_projection">
<code class="sig-name descname">set_perspective_projection</code><span class="sig-paren">(</span><em class="sig-param">eye=(0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">-1)</em>, <em class="sig-param">lookat=(0.0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">up=(0.0</em>, <em class="sig-param">1.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">angle=1.0</em>, <em class="sig-param">zclip=(0.0001</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">aspect=None</em>, <em class="sig-param">wrapto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_perspective_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_perspective_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the projection matrix to a planar perspective lookat projection
Chains a projection matrix “lookat” with a perspective projection</p>
<blockquote>
<div><p>See matrix_perspective (defines position/directions) and matrix_look_at 
(defines camera angle and clipping) for detailled explanations:</p>
<p>eye : (3 component) location of the camera
lookat : (3 component) location the camera is looking at
up : (3 component) the y-direction in the image
angle : opening angle of the projection
znear : close clipping plane
zfar : far away clipping plane
aspect : aspect ratio of the camera image</p>
<p>res : (4,4) projection matrix (homogeneous coordinates)</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_smoothing">
<code class="sig-name descname">set_smoothing</code><span class="sig-paren">(</span><em class="sig-param">rbins=None</em>, <em class="sig-param">rfac=1.0</em>, <em class="sig-param">extsize=None</em>, <em class="sig-param">nbrfac=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_smoothing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>set an adaptive smoothing</p>
<p>Set smoothing with number of rbins different kernelsizes
rbins can be an array or an integer (recommended). – 
this is normalized to the mean particle separation. For simulations
this is a good choice generally. However, in other cases you can use 
the parameter extsize to rescale the default physical width of the 
kernels</p>
<dl class="simple">
<dt>extsize<span class="classifier">Can be used to manipulate the calculation of the mean particle</span></dt><dd><p>separation (default extsize=boxsize). dr = extsize/cbrt(npart)
This can be used as a constant factor to rescale the kernel size to fit
into the kernel bins</p>
</dd>
<dt>rbins<span class="classifier">the kernel bin boundaries or the number of bins </span></dt><dd><p>This is given in image coordinates. E.g. a kernel size of
0.3 means that the sigma of a gaussian kernel is 30% of the
image width</p>
</dd>
</dl>
<p>rfac : has a similar effect like extsize, but is only applied after the binning</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Visualization.set_spherical_projection">
<code class="sig-name descname">set_spherical_projection</code><span class="sig-paren">(</span><em class="sig-param">eye=(0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">-1)</em>, <em class="sig-param">lookat=(0.0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">up=(0.0</em>, <em class="sig-param">1.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">rclip=(0.0</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">wrapto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_spherical_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Visualization.set_spherical_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up a spherical projection</p>
<blockquote>
<div><p>Sets up a spherical projection and defines the camera position/direction 
through a look_at matrix as in matrix_lookat</p>
<dl class="simple">
<dt>rclip<span class="classifier">tuple with 2 entries (rnear, rfar)</span></dt><dd><p>inner / outer clipping boundary</p>
</dd>
</dl>
<p class="attribution">—matrix_lookat —
Creates a rotation/translation matrix in homogeneous coordinates</p>
</div></blockquote>
<p>This function creates a projection matrix which rotates/translates
the coordinate system so that an object (lookat) is focused from
the camera position (eye)</p>
<p>eye : (3 component) location of the camera
lookat : (3 component) location the camera is looking at
up : (3 component) the y-direction in the image</p>
<p>res : (4,4) projection matrix (homogeneous coordinates)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mock-class">
<h2>Mock Class<a class="headerlink" href="#mock-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Mock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Mock</code><span class="sig-paren">(</span><em class="sig-param">Sim=None</em>, <em class="sig-param">TypeOfMock='HOD'</em>, <em class="sig-param">halo_vdisp=None</em>, <em class="sig-param">Mmin=316227766016.83795</em>, <em class="sig-param">sigmaLogM=0.5</em>, <em class="sig-param">M1=1000000000000.0</em>, <em class="sig-param">Mcut=316227766016.83795</em>, <em class="sig-param">alpha=1</em>, <em class="sig-param">alpha_c=0</em>, <em class="sig-param">alpha_s=0</em>, <em class="sig-param">sigma_Mstell=0.2</em>, <em class="sig-param">SHAM_Prop='vpeak'</em>, <em class="sig-param">StellarMassFunction=None</em>, <em class="sig-param">NoOrphans=False</em>, <em class="sig-param">mhalo='halo_m200c'</em>, <em class="sig-param">units_in_kpc=False</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">theory_mass_function=False</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that create mock galaxies from a simulation or a list of haloes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Sim</strong> (<em>class</em>) – Simulation class</p></li>
<li><p><strong>TypeOfMock</strong> (<em>string</em>) – HOD or SHAM</p></li>
<li><p><strong>halo_vdisp</strong> (<em>bool</em>) – Velocity dispersion of the haloes, in case the simulation does not provide it.</p></li>
<li><p><strong>Mmin</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>sigmaLogM</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>M1</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>alpha</strong> – 5-Parameter HOD</p></li>
<li><p><strong>alpha_c</strong> (<em>float</em>) – Velocity bias parameters. alpha_c = 0 means the velocity of the central
galaxy is the same as the center of potential of the halo. alpha_c = 1 means
the velocity of the central is the sum of the velocity of the halo + the velocity dispersion
of the halo</p></li>
<li><p><strong>alpha_s</strong> (<em>float</em>) – Velocity bias parameters. alpha_s = 0 means the velocity of the satellite
galaxy is the same as the center of potential of the halo. alpha_s = 1 means
the velocity of the satellite is the sum of the velocity of the halo + the velocity of                    a dark matter particle relative to the center of potential of the halo</p></li>
<li><p><strong>sigma_Mstell</strong> (<em>float</em>) – Scatter of the SHAM</p></li>
<li><p><strong>SHAM_Prop</strong> (<em>string</em>) – SHAM property (eg. vpeak, vmax, etc)</p></li>
<li><p><strong>StellarMassFunction</strong> (<em>array</em>) – For SHAMs, in a [2,NBin] format,  with Masses in log(M) and Nden in linear scale</p></li>
<li><p><strong>NoOrphans</strong> (<em>bool</em>) – No Orphans, use this for the moment</p></li>
<li><p><strong>mhalo</strong> (<em>string</em>) – Main halo mass type (eg. halo_mfof, halo_m200c)</p></li>
<li><p><strong>units_in_kpc</strong> (<em>bool</em>) – Units of the simulation in kpc</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – Number of threads, only for the HOD</p></li>
<li><p><strong>theory_mass_function</strong> (<em>bool</em>) – Force a halo mass to be universal</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – random seed</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – verbose, if None, use the config verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mock class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="method">
<dt id="bacco.Mock.Prop_n">
<code class="sig-name descname">Prop_n</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">prop='MStell'</em>, <em class="sig-param">Mask=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.Prop_n"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.Prop_n" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum value of a property for a given number density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>float</em>) – Number density</p></li>
<li><p><strong>prop</strong> (<em>string</em>) – Property of the mock class to aplay the number density</p></li>
<li><p><strong>Mask</strong> (<em>array</em>) – Subsample of galaxies to use</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Always usefull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cut in the property for the number density ‘n’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.compute_galaxy_power">
<code class="sig-name descname">compute_galaxy_power</code><span class="sig-paren">(</span><em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_galaxy_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.compute_galaxy_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the power spectrum of the galaxy sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>k and p(k)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.compute_wp">
<code class="sig-name descname">compute_wp</code><span class="sig-paren">(</span><em class="sig-param">pi_max=30</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">log_rmin=None</em>, <em class="sig-param">log_rmax=None</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">n=None</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">recheck_periodic_boundaries=True</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.compute_wp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute wp with halotools or Corrfunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi_max</strong> (<em>float</em>) – maximum value of pi. For Corrfunc it has to be &lt; box/3</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; wp - value of wp</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.compute_xi">
<code class="sig-name descname">compute_xi</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">recheck_periodic_boundaries=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.compute_xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 2PCF with halotools or Corrfunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi - value of 2PCF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.compute_xi_jackknife">
<code class="sig-name descname">compute_xi_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">n_jn3=5</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">recheck_periodic_boundaries=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.compute_xi_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 2PCF with halotools or Corrfunc with jackknife errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>jn3</strong> (<em>int</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi - value of 2PCF &amp; error of xi</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.compute_xi_multipoles">
<code class="sig-name descname">compute_xi_multipoles</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01, rmax=150, nbin=50, method='Corrfunc', nthreads=1, SHAM_Cut=-10, SHAM_GalProp='MStell', n=None, order=[0, 2, 4], rbins=None, zsd=False, recheck_periodic_boundaries=True, verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.compute_xi_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the multipoles of the 2PCF with halotools or Corrfunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>order</strong> (<em>array</em>) – Array of int, with the order to compute the multipoles (use for now [0,2,4] only, 
monopole, quadrupole and hexadecapole)</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi_ln - value of the multipoles 2PCF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.compute_xi_multipoles_jackknife">
<code class="sig-name descname">compute_xi_multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01, rmax=150, nbin=50, n_mubin=10, method='Corrfunc', nthreads=1, SHAM_Cut=-10, SHAM_GalProp='MStell', n=None, order=[0, 2, 4], rbins=None, n_jn3=5, zsd=False, recheck_periodic_boundaries=True, verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi_multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.compute_xi_multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the multipoles of the 2PCF with halotools or Corrfunc with jackknife errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>order</strong> (<em>array</em>) – Array of int, with the order to compute the multipoles (use for now [0,2,4] only, 
monopole, quadrupole and hexadecapole)</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>jn3</strong> (<em>int</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3.</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi - value of the multipoles of the 2PCF and jn errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.hod">
<code class="sig-name descname">hod</code><span class="sig-paren">(</span><em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">NBin=50</em>, <em class="sig-param">SHAM_Cut=None</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">HODfit=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.hod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.hod" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the HOD of a mock</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LogMmin</strong> (<em>float</em>) – log10 of the Minimum halo mass of the HOD</p></li>
<li><p><strong>LogMmax</strong> (<em>float</em>) – Log10 of the Maximum halo mass of the HOD</p></li>
<li><p><strong>NBin</strong> (<em>int</em>) – Number of bins of the HOD</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>string</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>HODfit</strong> (<em>array</em>) – Fit the HOD and get the fitting parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HOD - Halo mass and average halo occupation &amp; fit - (if HODfit == True) The HOD parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.hod_fit">
<code class="sig-name descname">hod_fit</code><span class="sig-paren">(</span><em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">NBin=50</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">HOD_mock=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.hod_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.hod_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a HOD to a mock class, or a hod funtion (see function above)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LogMmin</strong> (<em>float</em>) – log10 of the Minimum halo mass of the HOD</p></li>
<li><p><strong>LogMmax</strong> (<em>float</em>) – Log10 of the Maximum halo mass of the HOD</p></li>
<li><p><strong>NBin</strong> (<em>int</em>) – Number of bins of the HOD</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>string</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>HOD_mock</strong> (<em>dictionary</em>) – dictionary with the mass, number of centrals and number of satellite of a halo array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>5-Parameter fit and their errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.sat_fraction">
<code class="sig-name descname">sat_fraction</code><span class="sig-paren">(</span><em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.sat_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.sat_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the satellite fraction of a mock. For an HOD it will use the full sample and for a SHAM only a subsample</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SHAM_GalProp</strong> (<em>string</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Satellite Fraction</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Mock.vdisp">
<code class="sig-name descname">vdisp</code><span class="sig-paren">(</span><em class="sig-param">Sim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.vdisp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Mock.vdisp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the velocity dispersion of the haloes in case is not given</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Sim</strong> (<em>class</em>) – Simulation class</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="scaler-class">
<h2>Scaler Class<a class="headerlink" href="#scaler-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Scaler">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Scaler</code><span class="sig-paren">(</span><em class="sig-param">OriginalCosmology</em>, <em class="sig-param">MinRadius=0.3</em>, <em class="sig-param">MaxRadius=10.0</em>, <em class="sig-param">mode='backward'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>An Scaler object</p>
<p>:param original cosmology</p>
<dl class="method">
<dt id="bacco.Scaler.cost_function">
<code class="sig-name descname">cost_function</code><span class="sig-paren">(</span><em class="sig-param">pars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.cost_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler.cost_function" title="Permalink to this definition">¶</a></dt>
<dd><p>This defines the function to minimise to find the best scaling parameter
:param pars: The first and secdon elements are the length and time scaling factors, respectively.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Scaler.estimate_errors">
<code class="sig-name descname">estimate_errors</code><span class="sig-paren">(</span><em class="sig-param">run</em>, <em class="sig-param">pk=True</em>, <em class="sig-param">concentration=True</em>, <em class="sig-param">sigma=True</em>, <em class="sig-param">da=True</em>, <em class="sig-param">mf=True</em>, <em class="sig-param">lss_correction=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.estimate_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler.estimate_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>This function estimates the magnitude of the error of the rescaled
simulation for several quantities</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Scaler.pk_correction">
<code class="sig-name descname">pk_correction</code><span class="sig-paren">(</span><em class="sig-param">run</em>, <em class="sig-param">wavemode=None</em>, <em class="sig-param">correction_type='additive'</em>, <em class="sig-param">cold=False</em>, <em class="sig-param">nlin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.pk_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler.pk_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute large-scale correction to be applied to the rescaled
power spectrum.</p>
<dl class="simple">
<dt>if correction_type is additive:</dt><dd><p>returns pk_correction such that
pk_corrected = pk_target + pk_correction</p>
</dd>
<dt>if correction_type is multiplicative:</dt><dd><p>retruns pk_correction such that
pk_corrected = pk_target * pk_correction</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.Scaler.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">TargetCosmology</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Here we find the values of the transformation that minimise the function defined in cost_function()</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Scaler.runmin">
<code class="sig-name descname">runmin</code><span class="sig-paren">(</span><em class="sig-param">ctarget</em>, <em class="sig-param">use_growth=False</em>, <em class="sig-param">use_nlpk=False</em>, <em class="sig-param">limit_scaleLength=None</em>, <em class="sig-param">limit_scaleTime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.runmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler.runmin" title="Permalink to this definition">¶</a></dt>
<dd><p>#Here we should find the transformations that minimise the difference in the
variances.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Scaler.runmin_sigma8">
<code class="sig-name descname">runmin_sigma8</code><span class="sig-paren">(</span><em class="sig-param">ctarget</em>, <em class="sig-param">limit_scaleTime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.runmin_sigma8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Scaler.runmin_sigma8" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds scale time by just minimizing sigma8. Scale length is fixed (=1).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.statistics">
<span id="statistics-class"></span><h2>Statistics Class<a class="headerlink" href="#module-bacco.statistics" title="Permalink to this headline">¶</a></h2>
<p>A collection of miscelaneous functions</p>
<dl class="function">
<dt id="bacco.statistics.compute_halo_mass_function">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_halo_mass_function</code><span class="sig-paren">(</span><em class="sig-param">sim</em>, <em class="sig-param">Njk=4</em>, <em class="sig-param">convert_kpc_to_Mpc=False</em>, <em class="sig-param">show_plot=False</em>, <em class="sig-param">qty='dn_dlnM'</em>, <em class="sig-param">mdef='mfof'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_halo_mass_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_halo_mass_function" title="Permalink to this definition">¶</a></dt>
<dd><p>halo_mass_function(sim, convert_kpc_to_Mpc=True)</p>
<p>Compute and the halo mass function and its covariance matrix.
The units of the HMF are h^{4} Mpc^{-3} <a href="#id37"><span class="problematic" id="id38">M_</span></a>odot^{-1}. The covariance
matrix is computed with a jackknife, dividing each dimension into Njk
cells (default is 4). Note that an improved jackkinfe is implemented
here, following arXiv:1503.00313.</p>
<p>If convert_kpc_2o_Mpc=True halo positions are assumed to be in kpc/h
and are converted to Mpc/h. Otherwise, they are assumed to already be
in Mpc/h and no correction is applied.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_concentration">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_concentration</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">density</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an NFW profile to the input density profile.
Inputs: radii/r_200 and density in [h^2 Msun/Mpc^3]
Returns the scale radius (rs), the typical density (rhoc), and the best-fit profile evalutated at</p>
<blockquote>
<div><p>the input radii</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_multipoles">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_multipoles</code><span class="sig-paren">(</span><em class="sig-param">pos, box, order=[0, 2, 4], rmin=0.1, rmax=150, log_rmin=None, log_rmax=None, nbin=50, n_mubin=10, axis_zsd=2, method='halotools', random=None, seed=None, nthreads=None, logspace=False, rbins=None, zspace=False, cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the multipoles of xi with halotools.
more info:
-<a class="reference external" href="http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.s_mu_tpcf.html#halotools.mock_observables.s_mu_tpcf">http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.s_mu_tpcf.html#halotools.mock_observables.s_mu_tpcf</a>
-<a class="reference external" href="http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.tpcf_multipole.html#halotools.mock_observables.tpcf_multipole">http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.tpcf_multipole.html#halotools.mock_observables.tpcf_multipole</a>
If zspace is False, it assume the redshift space distortion effect
is already include in the position
TODO: Add a simulation implementation, improve this description</p>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_twopointcorr_jackknife">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_twopointcorr_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pos</em>, <em class="sig-param">box</em>, <em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">random=None</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_twopointcorr_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_twopointcorr_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute 2PCF and their jackknife errorsself.</dt><dd><p>The Jackknife samples are done removing cubic subsamples
from the primary (not secondary) galaxy sampleself.
The number of jackknife samples are equaly to n_jn3^3</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array</em>) – Position of the objects</p></li>
<li><p><strong>box</strong> (<em>float</em>) – Size of the periodic comoving box of the simulation</p></li>
<li><p><strong>rmin</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given, defaults to 0.01</p></li>
<li><p><strong>rmax</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3, defaults to 150</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘r’ array, defaults to 50</p></li>
<li><p><strong>random</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points used to compute the multipoles. None means all the points, defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Algorithm to compute the multipoles. Corrfunc is the only working right now. defaults to “Corrfunc”</p></li>
<li><p><strong>n_jn3</strong> (<em>int</em><em>, </em><em>optional</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3., defaults to 3</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of threads, defaults to None</p></li>
<li><p><strong>rbins</strong> (<em>list</em><em> , </em><em>optional</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins., defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The correlation function and their jn errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_wp_jackknife">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_wp_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pos</em>, <em class="sig-param">box</em>, <em class="sig-param">pi_max=20.0</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=50</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">random=None</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">NtimesRandom=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_wp_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_wp_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute wp jackknife.</dt><dd><p>For halotools check:
<a class="reference external" href="http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.wp_jackknife.html#halotools.mock_observables.wp_jackknife">http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.wp_jackknife.html#halotools.mock_observables.wp_jackknife</a>
For Corrfunc:
The Jackknife samples are done removing cubic subsamples
from the primary (not secondary) galaxy sampleself.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array</em>) – Position of the objects</p></li>
<li><p><strong>box</strong> (<em>float</em>) – Size of the periodic comoving box of the simulation</p></li>
<li><p><strong>pi_max</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum value of pi to integrate, defaults to 20.</p></li>
<li><p><strong>rmax</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3, defaults to 150</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘r’ array, defaults to 50</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Algorithm to compute the multipoles. Corrfunc and halotools are the only working right now. defaults to “Corrfunc”</p></li>
<li><p><strong>n_jn3</strong> (<em>int</em><em>, </em><em>optional</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3., defaults to 3</p></li>
<li><p><strong>random</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points used to compute the multipoles. None means all the points, defaults to None</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of threads, defaults to None</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – value of the random seed, defaults to None</p></li>
<li><p><strong>NtimesRandom</strong> (<em>int</em><em>, </em><em>optional</em>) – number of randoms relative to the original sample, defaults to 10</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>projected correlation function and covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_multipoles_jackknife">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pos, box, rmin=0.01, rmax=150, nbin=50, n_mubin=10, random=None, method='Corrfunc', n_jn3=3, nthreads=None, order=[0, 2, 4], rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute xi_l and their jackknife errorsself.</dt><dd><p>The Jackknife samples are done removing cubic subsamples
from the primary (not secondary) galaxy sample.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array</em>) – Position of the objects</p></li>
<li><p><strong>box</strong> (<em>float</em>) – Size of the periodic comoving box of the simulation</p></li>
<li><p><strong>rmin</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given, defaults to 0.01</p></li>
<li><p><strong>rmax</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3, defaults to 150</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘r’ array, defaults to 50</p></li>
<li><p><strong>n_mubin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘mu’ array, defaults to 10</p></li>
<li><p><strong>random</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points used to compute the multipoles. None means all the points, defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Algorithm to compute the multipoles. Corrfunc is the only working right now. defaults to “Corrfunc”</p></li>
<li><p><strong>n_jn3</strong> (<em>int</em><em>, </em><em>optional</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3., defaults to 3</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of threads, defaults to None</p></li>
<li><p><strong>order</strong> (<em>list</em><em>, </em><em>optional</em>) – Array of int, with the order to compute the multipoles (use for now [0,2,4] only, 
monopole, quadrupole and hexadecapole), defaults to [0, 2, 4]</p></li>
<li><p><strong>rbins</strong> (<em>list</em><em> , </em><em>optional</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins., defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The multipoles and their jn errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_theory_error_cov">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_theory_error_cov</code><span class="sig-paren">(</span><em class="sig-param">corr_scale</em>, <em class="sig-param">xx</em>, <em class="sig-param">comp_envelope=False</em>, <em class="sig-param">Env=None</em>, <em class="sig-param">physical_quantity=None</em>, <em class="sig-param">Env_amp=None</em>, <em class="sig-param">xx_amp=None</em>, <em class="sig-param">method='lin_interpol'</em>, <em class="sig-param">etype='gpy'</em>, <em class="sig-param">emul_points=50</em>, <em class="sig-param">variance_emul=1</em>, <em class="sig-param">corr_scale_emul=1</em>, <em class="sig-param">num_restarts=9</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">gaussian_error=None</em>, <em class="sig-param">fix_hyperparams=False</em>, <em class="sig-param">noise_stdev_emul=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_theory_error_cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_theory_error_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the covariance matrix for the theory errors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_scale</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>xx</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>comp_envelope</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description], defaults to False</p></li>
<li><p><strong>Env</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>physical_quantity</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>Env_amp</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>xx_amp</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – [description], defaults to “lin_interpol”</p></li>
<li><p><strong>etype</strong> (<em>str</em><em>, </em><em>optional</em>) – [description], defaults to ‘gpy’</p></li>
<li><p><strong>emul_points</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 50</p></li>
<li><p><strong>variance_emul</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 1</p></li>
<li><p><strong>corr_scale_emul</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 1</p></li>
<li><p><strong>num_restarts</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 9</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 1</p></li>
<li><p><strong>gaussian_error</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>fix_hyperparams</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description], defaults to False</p></li>
<li><p><strong>noise_stdev_emul</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_gaussian_error_multipoles_power">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_gaussian_error_multipoles_power</code><span class="sig-paren">(</span><em class="sig-param">l1</em>, <em class="sig-param">l2</em>, <em class="sig-param">mono</em>, <em class="sig-param">quad</em>, <em class="sig-param">hexa</em>, <em class="sig-param">Vol</em>, <em class="sig-param">nmean</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_gaussian_error_multipoles_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_gaussian_error_multipoles_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the gaussian error of the multipoles of the power spectrum
divided by the volume. The actual P(k) error is this times the volume,
divided by the number of modes in each wavemode bin.
Attention: Vol corresponds to the volume in real space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l1</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>l2</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>mono</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>quad</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>hexa</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>Vol</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>nmean</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="sampler-class">
<h2>Sampler Class<a class="headerlink" href="#sampler-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Sampler">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Sampler</code><span class="sig-paren">(</span><em class="sig-param">method='metropolis'</em>, <em class="sig-param">lnlike=None</em>, <em class="sig-param">lnlike_args=None</em>, <em class="sig-param">lnlike_scatter=None</em>, <em class="sig-param">lnlike_scatter_args=None</em>, <em class="sig-param">nchains=None</em>, <em class="sig-param">ndims=None</em>, <em class="sig-param">nwalkers=None</em>, <em class="sig-param">bounds=None</em>, <em class="sig-param">par_names=None</em>, <em class="sig-param">backup_fname=None</em>, <em class="sig-param">load_backup=False</em>, <em class="sig-param">convergence_crit=0.05</em>, <em class="sig-param">auto_stop=False</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">analysis_mode=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that defines some MCMC sampling utilities</p>
<dl class="method">
<dt id="bacco.Sampler.emulate_likelihood">
<code class="sig-name descname">emulate_likelihood</code><span class="sig-paren">(</span><em class="sig-param">emulator=None</em>, <em class="sig-param">file=None</em>, <em class="sig-param">hyperspace=None</em>, <em class="sig-param">space_rotation=False</em>, <em class="sig-param">space_rotation_points=None</em>, <em class="sig-param">divide_by_multvar_gaussian=False</em>, <em class="sig-param">add_points=None</em>, <em class="sig-param">add_likes=None</em>, <em class="sig-param">lhc_seed=5</em>, <em class="sig-param">lhc_spread=True</em>, <em class="sig-param">lhc_nbuild=150</em>, <em class="sig-param">gp='george'</em>, <em class="sig-param">gp_variance=1</em>, <em class="sig-param">gp_lengthscale=1</em>, <em class="sig-param">gp_num_restarts=9</em>, <em class="sig-param">gp_seed=1</em>, <em class="sig-param">gp_realisation=False</em>, <em class="sig-param">gp_fix_hyperparams=False</em>, <em class="sig-param">gp_noise_stdev=0.0</em>, <em class="sig-param">fix_noise=0.0</em>, <em class="sig-param">use_fitted=None</em>, <em class="sig-param">ln_ln=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.emulate_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Sampler.emulate_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>emulator: emulator object, if None it will be builded.
file: file containing coordinates and likelihood evaluations to build the emulator. If None</p>
<blockquote>
<div><p>a latin hypercube will be builded</p>
</div></blockquote>
<p>hyperspace: boundaries for the emulator latin hypercube, if None the sampler boundaries will be used
space rotation: if True the emulator space will be rotated and renormalised
add_points: points to be added to the latin hypercube
add_likes: likelihoods associated to add_points to be added to the latin hypercube, if None they will be computed
lhc_seed: seed fot the latin hypercube
lhc_spread: if True, the projected distances will be maximised
lhc_nbuild: number of points in the latin hypercube
gp: gaussian process to be used, between ‘george’ (default), ‘gpy’ and ‘sklearn’
gp_variance: gaussian process variance, default is 1
gp_lengthscale: gaussian process lenghtscale, default is 1
gp_num_restarts = gaussian process number of optimisation restarts, default is 9
gp_seed= gaussian process seed, default is 1
gp_realisation = if True, a random realisation of the emulator will be returned instead of the mean. Default is False</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Sampler.initialize_run">
<code class="sig-name descname">initialize_run</code><span class="sig-paren">(</span><em class="sig-param">method='latinhypercube'</em>, <em class="sig-param">fname=None</em>, <em class="sig-param">lh_seed=5</em>, <em class="sig-param">lh_spread=True</em>, <em class="sig-param">initguess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.initialize_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Sampler.initialize_run" title="Permalink to this definition">¶</a></dt>
<dd><p>fname: file with the initial positions of the chains.
initguess: array of initial positions of the chains. In case of emulated likelihoods,</p>
<blockquote>
<div><p>these points will be added on top of the latin hypercube ones.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.Sampler.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">nsteps=5000</em>, <em class="sig-param">maxrepetitions=1</em>, <em class="sig-param">nbackup=1</em>, <em class="sig-param">nconverge=1</em>, <em class="sig-param">nupdate=0</em>, <em class="sig-param">seeds=None</em>, <em class="sig-param">nsuperupdate=0</em>, <em class="sig-param">initial_step=0.05</em>, <em class="sig-param">use_ntry=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Sampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>nupdate=0 and nsuperupdate=0 to not update covariance matrix and jumping
factor, respectively.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.sampler.iterative_likelihood_emulator">
<code class="sig-prename descclassname">bacco.sampler.</code><code class="sig-name descname">iterative_likelihood_emulator</code><span class="sig-paren">(</span><em class="sig-param">lnlike=None</em>, <em class="sig-param">lnlike_true=None</em>, <em class="sig-param">lnlike_args=None</em>, <em class="sig-param">lnlike_true_args=None</em>, <em class="sig-param">lnlike_scatter=None</em>, <em class="sig-param">lnlike_scatter_args=None</em>, <em class="sig-param">ndims=None</em>, <em class="sig-param">par_names=None</em>, <em class="sig-param">ln_ln=False</em>, <em class="sig-param">nadd=1</em>, <em class="sig-param">add_points_method='mcmc'</em>, <em class="sig-param">convergence_crit=0.1</em>, <em class="sig-param">mcmc_convergence_crit=0.1</em>, <em class="sig-param">convergence_nmean=5</em>, <em class="sig-param">max_iter=100</em>, <em class="sig-param">alpha=0.0</em>, <em class="sig-param">mcmc_nwalkers=12</em>, <em class="sig-param">mcmc_nchains=1</em>, <em class="sig-param">mcmc_bounds=None</em>, <em class="sig-param">mcmc_method='emcee'</em>, <em class="sig-param">divide_by_multvar_gaussian=False</em>, <em class="sig-param">mcmc_nsteps=5000</em>, <em class="sig-param">emul_mcmc_nsteps=5000</em>, <em class="sig-param">mcmc_burnin=1000</em>, <em class="sig-param">mcmc_maxrepetitions=1</em>, <em class="sig-param">mcmc_seeds=None</em>, <em class="sig-param">file='emulator_data.hdf5'</em>, <em class="sig-param">hyperspace=None</em>, <em class="sig-param">space_rotation=False</em>, <em class="sig-param">add_points=None</em>, <em class="sig-param">add_likes=None</em>, <em class="sig-param">lhc_seed=5</em>, <em class="sig-param">lhc_spread=True</em>, <em class="sig-param">lhc_nbuild=30</em>, <em class="sig-param">gp='george'</em>, <em class="sig-param">gp_variance=1</em>, <em class="sig-param">gp_lengthscale=1</em>, <em class="sig-param">gp_num_restarts=9</em>, <em class="sig-param">gp_seed=1</em>, <em class="sig-param">gp_realisation=False</em>, <em class="sig-param">gp_fix_hyperparams=False</em>, <em class="sig-param">gp_fix_hyperparams_after_first_iter='none'</em>, <em class="sig-param">gp_noise_stdev=0.0</em>, <em class="sig-param">fix_noise=0.0</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">name_plots='_iteremulator_'</em>, <em class="sig-param">dir_plots='plots/'</em>, <em class="sig-param">plot_truth=False</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">**plot_args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#iterative_likelihood_emulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.iterative_likelihood_emulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Function emulating the likelihood with gaussian process and suggesting new points with bayesian optimization.</p>
<p>Summary: This function is the main function to produce the scientific results of arxiv.org/abs/1912.08806. This function accepts the likelihood function and generates a grid of Latin-Hypercube evaluations of it. Then, it interpolates and extrapolates a gaussian process to it. New pointswhere the likelihood function will be computed are then  suggested with a choice of acquisition function to make the gaussian process fit more accurate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lnlike</strong> (<em>function.</em>) – ln(Likelihood) to be emulated. Default None.</p></li>
<li><p><strong>lnlike_true</strong> (<em>function.</em>) – ln(likelihood) without scatter noise if known. Default None.</p></li>
<li><p><strong>lnlike_args</strong> (<em>function arguments.</em>) – Arguments of lnlike. Default None.</p></li>
<li><p><strong>lnlike_true_args</strong> (<em>function arguments.</em>) – function arguments. Arguments of lnlike_true.Default None.</p></li>
<li><p><strong>lnlike_scatter</strong> (<em>function.</em>) – Function to theoretically compute the scatter in the likelihood (if known). Default None.</p></li>
<li><p><strong>lnlike_scatter_args</strong> (<em>function arguments.</em>) – Arguments of lnlike_scatter. Default None.</p></li>
<li><p><strong>ndims</strong> (<em>integer.</em>) – Number of dimensions. Default None.</p></li>
<li><p><strong>par_names</strong> (<em>string array.</em>) – Parameters names, if None default values will be assigned.</p></li>
<li><p><strong>ln_ln</strong> (<em>Boolean.</em>) – If True, gaussian emulator uses log(values) for its predictions, else, nothing is changed. Default False.</p></li>
<li><p><strong>nadd</strong> (<em>integer.</em>) – Number of sampling points to be added at each iteration, default value is 1.</p></li>
<li><p><strong>add_points_method</strong> (<em>string.</em>) – string. Method used to find points to add, choose among mcmc (default) and rejsamp.</p></li>
<li><p><strong>divide_by_multvar_gaussian</strong> (<em>bool.</em>) – If True a multivariate function is fitted to the input and then, divided by it before emulation. Default False.</p></li>
<li><p><strong>convergence_crit</strong> (<em>float.</em>) – Convergence criterion for the iterative process, K-L-Divergence &lt; crit , default is 0.1.</p></li>
<li><p><strong>mcmc_convergence_crit</strong> (<em>float.</em>) – Convergence criterion for the emulated mcmc. Gelman-Rubin criteria by default.</p></li>
<li><p><strong>convergence_nmean</strong> (<em>integer.</em>) – Last N iteration where the mean for the convergence will be computed , default is 5.</p></li>
<li><p><strong>max_iter</strong> (<em>integer.</em>) – Maximum number of iterations, default is 100.</p></li>
<li><p><strong>alpha</strong> (<em>float.</em>) – The sampling points probability is given by L*(1+alpha*deltaL/L) with L being the likelihood, default is 0.</p></li>
<li><p><strong>mcmc_nwalkers</strong> (<em>integer.</em>) – Walkers for emcee, default is 12.</p></li>
<li><p><strong>mcmc_nchains</strong> (<em>integer.</em>) – Number of parallel chains , default is 1.</p></li>
<li><p><strong>mcmc_bounds</strong> (<em>float array.</em>) – Boundaries of mcmc, default is None.</p></li>
<li><p><strong>mcmc_method</strong> (<em>string.</em>) – MCMC method, default is ‘emcee’, ‘montecarlo’ and ‘metropolis’ are options</p></li>
<li><p><strong>mcmc_nsteps</strong> (<em>integer.</em>) – Number of steps of the heavy (with true likelihood) mcmc. Default is 5000.</p></li>
<li><p><strong>emul_mcmc_nsteps</strong> (<em>integer.</em>) – Number of steps of the emulated (with interpolated likelihood) mcmc. Default is 5000.</p></li>
<li><p><strong>mcmc_burnin</strong> (<em>integer.</em>) – MCMC burn-in. Default is 1000.</p></li>
<li><p><strong>mcmc_maxrepetitions</strong> (<em>integer.</em>) – If using emcee, amount of times to recover the computation if the convergence is not achieved. Default is 1.</p></li>
<li><p><strong>mcmc_seeds</strong> (<em>integer.</em>) – Seed of the MCMCs. Default is None.</p></li>
<li><p><strong>file</strong> (<em>string.</em>) – File to read/save the emulator latin-hypercube and subsequent iterations, default is ‘emulator_data.hdf5’.</p></li>
<li><p><strong>hyperspace</strong> (<em>float array.</em>) – float array. Boundaries for the emulator, default is mcmc_bounds.</p></li>
<li><p><strong>space_rotation</strong> (<em>boolean.</em>) – True for rotating and renormalising the emulator hyperspace, default is False.</p></li>
<li><p><strong>add_points</strong> (<em>integer.</em>) – Number of points to be added to the latin hypercube, default is None.</p></li>
<li><p><strong>add_likes</strong> (<em>float.</em>) – Likelihood values to be added to the latin hypercube, if none, they will be computed. Default is None.</p></li>
<li><p><strong>lhc_seed</strong> (<em>integer.</em>) – Latin hypercube seed, default is 5.</p></li>
<li><p><strong>lhc_spread</strong> (<em>boolean.</em>) – Latin hypercube projected distances between points maximised if True, default is True.</p></li>
<li><p><strong>lhc_nbuild</strong> (<em>integer.</em>) – Latin hypercube number of sammpling points, default is 30.</p></li>
<li><p><strong>gp</strong> (<em>string.</em>) – Gaussian process to be used, default is ‘george’, ‘sklearn’ and ‘gpy’ are options.</p></li>
<li><p><strong>gp_variance</strong> (<em>float.</em>) – Guess of kernel variance. Default is 1.</p></li>
<li><p><strong>gp_lengthscale</strong> (<em>float.</em>) – Guess of kernel correlation length. Default is 1.</p></li>
<li><p><strong>gp_num_restarts</strong> (<em>integer.</em>) – Number of restart of the optimisation of gp, default is 9.</p></li>
<li><p><strong>gp_seed</strong> (<em>integer.</em>) – Seed for the kernel minimization. Default is 1.</p></li>
<li><p><strong>gp_realisation</strong> (<em>boolean.</em>) – If True, not the mean but a random realisation of the emulator will be used, default is False.</p></li>
<li><p><strong>gp_fix_hyperparams_after_first_iter</strong> (<em>string.</em>) – Fit the hyperparams with the lh, then fix them; choose among none, all, lengthscale.</p></li>
<li><p><strong>plot</strong> (<em>boolean.</em>) – If True, it produces plots of each iteration. Default is False.</p></li>
<li><p><strong>name_plots</strong> (<em>string.</em>) – Name of the plots produced + number of iteration. Default is None.</p></li>
<li><p><strong>dir_plots</strong> (<em>string.</em>) – Plots directory, default is ‘plots/’.</p></li>
<li><p><strong>verbose</strong> (<em>boolean.</em>) – if True, more info is provided. Default is None -&gt; value in the config.</p></li>
<li><p><strong>**plot_args</strong> – <p>arguments for the contours plot</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary. ‘sampler’: iterative class, ‘means’: parameter values, ‘std’: standard deviations, ‘convergence’: convergence achieved, 
‘sampler_truth’: true mcmc class (if asked for), ‘Npoints’: number of points used.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lightcone-class">
<h2>Lightcone Class<a class="headerlink" href="#lightcone-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.Lightcone">
<em class="property">class </em><code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">Lightcone</code><span class="sig-paren">(</span><em class="sig-param">bdir=None, zmax=2.0, field=[5, 5], dm_file=None, halo_file=None, scaled_sim=False, verbose=None, **scaling_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/lightcone.html#Lightcone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Lightcone" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that build a lightcone starting from a N-body simulation.</p>
<p>The lightcone is built stacking different snapshots of a simuulation along a given
direction.</p>
<p>——input———
bdir: string, base directory of the Nbody simulation.
zmax: float,  maximum redshift up to which the lightcone is built.
field: tuple with two elements, field of view of the lightcone in degrees.
scaled_sim: bool, whether or not to scale the simulation.
scaling_kwargs: kwargs to pass to the class ScaledSimulation.</p>
<p>—–output——
a lightcone object</p>
<dl class="method">
<dt id="bacco.Lightcone.plot_lightcone">
<code class="sig-name descname">plot_lightcone</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">show=True</em>, <em class="sig-param">subsample=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/lightcone.html#Lightcone.plot_lightcone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Lightcone.plot_lightcone" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that produces an interactive 3D plot of the lightcone.
Parameters:
filename: string, path of the file in case you want to save the image.
show: bool, wheter or not to show the plot
subsample: float, fraction of object displayed, default 100%.
Warning: using lightcone with many particles can be very slow.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.Lightcone.vis_lightcone">
<code class="sig-name descname">vis_lightcone</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">npix=(256</em>, <em class="sig-param">256)</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/lightcone.html#Lightcone.vis_lightcone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.Lightcone.vis_lightcone" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that uses the Visualization Class to make an image of the lightcone.
Parameters:
filename: string, path of the file in case you want to save the image.
npix: tuple, resolution of the pictures in number of pixels
kwargs: other arguments to be passed to the function set_ortho_projection of the Class Visualization</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.utils">
<span id="utils"></span><h2>Utils<a class="headerlink" href="#module-bacco.utils" title="Permalink to this headline">¶</a></h2>
<p>A collection of miscelaneous functions</p>
<dl class="class">
<dt id="bacco.utils.cached_property">
<em class="property">class </em><code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">cached_property</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">name=None</em>, <em class="sig-param">doc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#cached_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.cached_property" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator that converts a function into a lazy property.  The
function wrapped is called the first time to retrieve the result
and then that calculated result is used the next time you access
the value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># calculate something important here</span>
        <span class="k">return</span> <span class="mi">42</span>
</pre></div>
</div>
<p>The class has to have a <cite>__dict__</cite> in order for this property to
work.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.pk2xi">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">pk2xi</code><span class="sig-paren">(</span><em class="sig-param">kk</em>, <em class="sig-param">pk</em>, <em class="sig-param">rr</em>, <em class="sig-param">jn=0</em>, <em class="sig-param">lbox=None</em>, <em class="sig-param">Log=True</em>, <em class="sig-param">FFTLog=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#pk2xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.pk2xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the correlation function from a tabulated power spectrum data
TODO: Rewrite variables to utilize the same Bessel function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kk</strong> – Wavevectors</p></li>
<li><p><strong>pk</strong> – Power spectrum</p></li>
<li><p><strong>rr</strong> – Values at which to compute the correlation function</p></li>
<li><p><strong>Log</strong> – Decide whether the interpolation is done in linear or logarithmic scales</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.create_dir">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">create_dir</code><span class="sig-paren">(</span><em class="sig-param">directory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#create_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.create_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>We try to create a directory. If it exists, we ignore the error. We catch any other error</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.read_parameter_file">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">read_parameter_file</code><span class="sig-paren">(</span><em class="sig-param">parameter_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#read_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.read_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the parameters file of a simulation</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.write_parameter_file">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">write_parameter_file</code><span class="sig-paren">(</span><em class="sig-param">parameter_file</em>, <em class="sig-param">pars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#write_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.write_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the parameters file of a simulation</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.remove_IDs_HDF5">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">remove_IDs_HDF5</code><span class="sig-paren">(</span><em class="sig-param">basedir=None</em>, <em class="sig-param">halo_file=None</em>, <em class="sig-param">snaplist=None</em>, <em class="sig-param">lastsnap=None</em>, <em class="sig-param">pair=False</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#remove_IDs_HDF5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.remove_IDs_HDF5" title="Permalink to this definition">¶</a></dt>
<dd><p>Delect IDs folder from the groups in the HDF5 files.</p>
<p>BETA! not elegant (not even close…) needs h5repack installed</p>
<p>basedir:   The directory of the simulation, eg. /scratch/user/LCDM_L04096N32768
halo_file: The name of the halofile of ANY snapshot (even if it is not in snaplist), eg.
groups_001/fof_subhalo_history_tab_orph_wweight_001
snaplist:  The list of snapshots to clean, eg. [7,14,21]
lastsnap:  The final snapshot to clean, eg. 100. Use snaplist OR lastsnap
pair:      If there are Pair simulations
verbose:   verbose</p>
<p>If snaplist is given, it will fix only a particular set of snapshots.
If lastsnap is given, it will fix all snapshot untill that snapshot (included)
if a snapshot is missing, the code will <em>not</em> stop
If neither snaplist or lastsnap is given, the code will run from group_000 until
there is no groups</p>
</dd></dl>

<p>This is something I want to say that is not in the docstring.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Several expamples of BACCO’s use" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Raul E. Angulo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>