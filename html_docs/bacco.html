

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>bacco package &mdash; bacco 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> bacco
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">QuickStart</a></li>
<li class="toctree-l1"><a class="reference internal" href="code.html">Code</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bacco</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>bacco package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/bacco.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bacco-package">
<h1>bacco package<a class="headerlink" href="#bacco-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="bacco.cengine.html">bacco.cengine package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bacco.cengine.html#module-bacco.cengine">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bacco.cyengine.html">bacco.cyengine package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bacco.cyengine.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="bacco.cyengine.html#module-bacco.cyengine.cymock">bacco.cyengine.cymock module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bacco.cyengine.html#module-bacco.cyengine">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bacco.lss_scaler.html">bacco.lss_scaler package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bacco.lss_scaler.html#module-bacco.lss_scaler">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bacco.powerspectrum.html">bacco.powerspectrum package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bacco.powerspectrum.html#module-bacco.powerspectrum">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bacco.qtets.html">bacco.qtets package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bacco.qtets.html#module-bacco.qtets">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bacco.reps.html">bacco.reps package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bacco.reps.html#module-bacco.reps">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-bacco.baryons">
<span id="bacco-baryons-module"></span><h2>bacco.baryons module<a class="headerlink" href="#module-bacco.baryons" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Baryons’ class and helper functions</p>
<dl class="class">
<dt id="bacco.baryons.Baryons">
<em class="property">class </em><code class="sig-prename descclassname">bacco.baryons.</code><code class="sig-name descname">Baryons</code><span class="sig-paren">(</span><em class="sig-param">Simulation</em>, <em class="sig-param">M_c=120000000000000.0</em>, <em class="sig-param">eta=0.5</em>, <em class="sig-param">beta=0.6</em>, <em class="sig-param">M1=152600000000.0</em>, <em class="sig-param">eject_model='A'</em>, <em class="sig-param">use_dm=False</em>, <em class="sig-param">use_sdm=True</em>, <em class="sig-param">component_subsample=False</em>, <em class="sig-param">single_component=None</em>, <em class="sig-param">mode='truncated'</em>, <em class="sig-param">ParticlesRadius=1.0</em>, <em class="sig-param">bin=(0.1</em>, <em class="sig-param">20.0</em>, <em class="sig-param">30)</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">tauv=8</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">min_halo_mass=100.0</em>, <em class="sig-param">max_halo_mass=1000000.0</em>, <em class="sig-param">mass_binning=False</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">halos=None</em>, <em class="sig-param">logpars=False</em>, <em class="sig-param">SMHM_z_evolution=True</em>, <em class="sig-param">thermodynamical_props=False</em>, <em class="sig-param">tag='standardAGN'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute baryonic effects on a N-body simulation.</p>
<p>This class implements a baryonic correction model to
modify the density field of a gravity-only simulation,
following Aricò et al. 2020.</p>
<p>——-inputs:</p>
<p>Simulation: simulation, the Simulation you want to use to compute the baryonic effects
M_c: float, characteristic halo mass for the hot-gas suppression (see Mohammed et al 2015 &lt;arXiv1410.6826&gt;)
eta: float, scaling factor of the ejected gas radius as a function of the escape radius, i.e. r_ej=eta*r_esc
beta: float, slope of the hot-gas suppression toward small halo masses
M1: float, parameter that control both the normalization and the slope of the mass fraction of central galaxy/halo
eject_model: str, ‘A’ for modeling the ejected radius proportionally to the halo escape radius e.g. ej_rad = eta * ej_esc;</p>
<blockquote>
<div><p>‘B’ for a more complex and phisical motivated model, obtained integrating the Maxwell-Boltzmann distribution</p>
</div></blockquote>
<p>use_dm: bool, whether to apply the baryon corrections to all the Simulation particles or not
use_sdm: bool, whether to apply the baryon corrections to the Simulation particles or not
component_subsample: bool, whether to assign the particle to a specific component or not
single_component: string, considering the effect of just one component (e.g. eject_gas’, ‘galaxy’, ‘bound_gas’, ‘relax_dark_matter’)
mode: string,</p>
<blockquote>
<div><p>‘truncated’ (default) to truncate the density profiles performing long-range displacements (e.g. Aricò et al. 2020);
‘all’ to displace all the particles (e.g. Schneider &amp; Teyssier et al. 2016);
‘fof’ to displace only the particles belonging to the fof halo (warning: this is not formally correct!);
‘outern’ to indicate the radius from the halo center in which displace the particles</p>
</div></blockquote>
<p>ParticlesRadius: float, maximum radius within you want to displace particles in outern mode (in r_200 units)
bin: Tuple, initial and final radii in r_200 units, and number of shells to compute the profiles
plot: bool,
tauv: double, truncation of NFW profile; tau = tauv*concentration
min_halo_mass: float, minimum halo mass to compute the baryon corrections, in unit of 10^10 solar masses
max_halo_mass: float, maximum halo mass to compute the baryon corrections, in unit of 10^10 solar masses
mass_binning: bool, wheter to apply the corrections binning the halos in mass or not.
halos: list of halos ids for computing the baryon corrections. If None, all the halos wil be considered.
thermodynamical_props: Bool, wheter to compute thermodynamical properties as Temperature and Pressure or not</p>
<p>—-outputs:</p>
<blockquote>
<div><p>Baryons object</p>
</div></blockquote>
<dl class="attribute">
<dt id="bacco.baryons.Baryons.ComponentsCorrel">
<code class="sig-name descname">ComponentsCorrel</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.ComponentsCorrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.ComponentsCorrel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.ComponentsPower">
<code class="sig-name descname">ComponentsPower</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.ComponentsPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.ComponentsPower" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns a dictionary with power spectrum of the different components</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.Correl">
<code class="sig-name descname">Correl</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.Correl" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass correlation function on the baryon simulation.</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.Fields">
<code class="sig-name descname">Fields</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.Fields" title="Permalink to this definition">¶</a></dt>
<dd><p>return a dictionary with the positions and the masses of the different components</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.FitPower">
<code class="sig-name descname">FitPower</code><span class="sig-paren">(</span><em class="sig-param">k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.FitPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.FitPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.Mfof_200">
<code class="sig-name descname">Mfof_200</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Mfof_200"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.Mfof_200" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the Mass of the particles belonging to the FOF halos inside r200</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.Power">
<code class="sig-name descname">Power</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.Power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.Power" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass power spectrum on the baryon simulation</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.SMHM_relation">
<code class="sig-name descname">SMHM_relation</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.SMHM_relation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.SMHM_relation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.approximate_baryon_simulation">
<code class="sig-name descname">approximate_baryon_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.approximate_baryon_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.approximate_baryon_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which compute and apply the displacement of particles in a simulation,
binning the halos by mass.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><em class="sig-param">attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.compute_profiles">
<code class="sig-name descname">compute_profiles</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">rshell</em>, <em class="sig-param">r_200</em>, <em class="sig-param">M_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">return_only_mass=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.compute_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.compute_profiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.create_baryon_simulation">
<code class="sig-name descname">create_baryon_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.create_baryon_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.create_baryon_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which compute and apply the displacement of particles in a simulation,
on halo-by-halo basis.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.diff_mass_profiles">
<code class="sig-name descname">diff_mass_profiles</code><span class="sig-paren">(</span><em class="sig-param">mass_profiles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.diff_mass_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.diff_mass_profiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.displace_halo_centers">
<code class="sig-name descname">displace_halo_centers</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">spline</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.displace_halo_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.displace_halo_centers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.displacement">
<code class="sig-name descname">displacement</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">Mass_profiles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.displacement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.displacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.fraction_bound_gas">
<code class="sig-name descname">fraction_bound_gas</code><span class="sig-paren">(</span><em class="sig-param">M_200</em>, <em class="sig-param">f_cg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.fraction_bound_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.fraction_bound_gas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.fraction_dark_matter">
<code class="sig-name descname">fraction_dark_matter</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.fraction_dark_matter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.fraction_dark_matter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.fraction_eject_gas">
<code class="sig-name descname">fraction_eject_gas</code><span class="sig-paren">(</span><em class="sig-param">M_200</em>, <em class="sig-param">f_bg=None</em>, <em class="sig-param">f_cg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.fraction_eject_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.fraction_eject_gas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.fraction_galaxy">
<code class="sig-name descname">fraction_galaxy</code><span class="sig-paren">(</span><em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.fraction_galaxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.fraction_galaxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.fractions">
<code class="sig-name descname">fractions</code><span class="sig-paren">(</span><em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.fractions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.fractions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.get_component_particles">
<code class="sig-name descname">get_component_particles</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">type=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.get_component_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.get_component_particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.get_particles">
<code class="sig-name descname">get_particles</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">key='pos'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.get_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.get_particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.integrate_density_profile">
<code class="sig-name descname">integrate_density_profile</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">rho</em>, <em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.integrate_density_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.integrate_density_profile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.make_plots">
<code class="sig-name descname">make_plots</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">scatter=False</em>, <em class="sig-param">logarithmic=True</em>, <em class="sig-param">show=True</em>, <em class="sig-param">save_file=None</em>, <em class="sig-param">use_sdm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.make_plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.make_plots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_background_r">
<code class="sig-name descname">mass_background_r</code><span class="sig-paren">(</span><em class="sig-param">r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_background_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_background_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_baryon_correction_r">
<code class="sig-name descname">mass_baryon_correction_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_baryon_correction_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_baryon_correction_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_bound_gas_r">
<code class="sig-name descname">mass_bound_gas_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">y1</em>, <em class="sig-param">norm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_bound_gas_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_bound_gas_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_ejected_gas_r">
<code class="sig-name descname">mass_ejected_gas_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">frac</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_ejected_gas_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_ejected_gas_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_galaxy_r">
<code class="sig-name descname">mass_galaxy_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">frac</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_galaxy_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_galaxy_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_nfw_plus_constant">
<code class="sig-name descname">mass_nfw_plus_constant</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">M_200</em>, <em class="sig-param">y1</em>, <em class="sig-param">norm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_nfw_plus_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_nfw_plus_constant" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_nfw_r">
<code class="sig-name descname">mass_nfw_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_nfw_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_nfw_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_only_baryon_r">
<code class="sig-name descname">mass_only_baryon_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_only_baryon_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_only_baryon_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_only_gravity_r">
<code class="sig-name descname">mass_only_gravity_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_only_gravity_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_only_gravity_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.mass_relax_dark_matter_r">
<code class="sig-name descname">mass_relax_dark_matter_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">M_nfw</em>, <em class="sig-param">M_bar</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.mass_relax_dark_matter_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.mass_relax_dark_matter_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.measure_profiles">
<code class="sig-name descname">measure_profiles</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">min_pts_in_bin=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.measure_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.measure_profiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.minimise_rho_r">
<code class="sig-name descname">minimise_rho_r</code><span class="sig-paren">(</span><em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">frac</em>, <em class="sig-param">rhob200</em>, <em class="sig-param">M_200</em>, <em class="sig-param">rho_og_r200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.minimise_rho_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.minimise_rho_r" title="Permalink to this definition">¶</a></dt>
<dd><p>A function wich find a rho’ and r’ such that a nfw profile + costant is normalised
at r200</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.norm_bound_gas">
<code class="sig-name descname">norm_bound_gas</code><span class="sig-paren">(</span><em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">tau</em>, <em class="sig-param">M_halo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.norm_bound_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.norm_bound_gas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.particles_around_halos">
<code class="sig-name descname">particles_around_halos</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.particles_around_halos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.particles_around_halos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.particles_not_in_halos">
<code class="sig-name descname">particles_not_in_halos</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.particles_not_in_halos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.particles_not_in_halos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.pressure_bound_gas">
<code class="sig-name descname">pressure_bound_gas</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">norm</em>, <em class="sig-param">rho_s</em>, <em class="sig-param">gammaf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.pressure_bound_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.pressure_bound_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which return a ploytropic density profile, in erg/cm^3
following  Martizzi et al. 2013</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.put_particles">
<code class="sig-name descname">put_particles</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">key</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.put_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.put_particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.r_eject">
<code class="sig-name descname">r_eject</code><span class="sig-paren">(</span><em class="sig-param">r_200</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">eta</em>, <em class="sig-param">model='A'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.r_eject"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.r_eject" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.rho_background">
<code class="sig-name descname">rho_background</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_background" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_background_r">
<code class="sig-name descname">rho_background_r</code><span class="sig-paren">(</span><em class="sig-param">r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_background_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_background_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_baryon_correction_r">
<code class="sig-name descname">rho_baryon_correction_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_baryon_correction_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_baryon_correction_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_bound_gas_r">
<code class="sig-name descname">rho_bound_gas_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">y1</em>, <em class="sig-param">norm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_bound_gas_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_bound_gas_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_eject_gas_r">
<code class="sig-name descname">rho_eject_gas_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">frac</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_eject_gas_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_eject_gas_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_galaxy_r">
<code class="sig-name descname">rho_galaxy_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">frac</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_galaxy_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_galaxy_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_nfw_plus_constant">
<code class="sig-name descname">rho_nfw_plus_constant</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em>, <em class="sig-param">y1</em>, <em class="sig-param">norm</em>, <em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_nfw_plus_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_nfw_plus_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>A NFW profile + constant, used to make sure that the density is continous in
the truncation mode</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_only_baryon_r">
<code class="sig-name descname">rho_only_baryon_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_halo</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">frac</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_only_baryon_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_only_baryon_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_only_gravity_r">
<code class="sig-name descname">rho_only_gravity_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_only_gravity_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_only_gravity_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_relax_dark_matter_r">
<code class="sig-name descname">rho_relax_dark_matter_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">M_rdm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_relax_dark_matter_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_relax_dark_matter_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.rho_trunc_nfw_r">
<code class="sig-name descname">rho_trunc_nfw_r</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.rho_trunc_nfw_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.rho_trunc_nfw_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.sdmCorrel">
<code class="sig-name descname">sdmCorrel</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.sdmCorrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.sdmCorrel" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass correlation function on the baryon simulation, using
a subsampled catalogue of particles.</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.baryons.Baryons.sdmPower">
<code class="sig-name descname">sdmPower</code><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.sdmPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.sdmPower" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the mass power spectrum on the baryon simulation, using
a subsampled catalogue of particles.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.temperature_bound_gas">
<code class="sig-name descname">temperature_bound_gas</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">rho_s</em>, <em class="sig-param">gammaf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.temperature_bound_gas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.temperature_bound_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bound gas Temperature profiles in K</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.universal_pressure_profile">
<code class="sig-name descname">universal_pressure_profile</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.universal_pressure_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.universal_pressure_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>A function which return the universal density profile of a cluster, in erg/cm^3
following  Nagai, Kravtsov &amp; Vikhlinin 2007; Arnaud et al 2010.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.baryons.Baryons.xi_relax_dark_matter">
<code class="sig-name descname">xi_relax_dark_matter</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">M_nfw</em>, <em class="sig-param">M_bar</em>, <em class="sig-param">frac</em>, <em class="sig-param">r_200</em>, <em class="sig-param">r_s</em>, <em class="sig-param">log_rho_0</em>, <em class="sig-param">tau</em>, <em class="sig-param">a=0.68</em>, <em class="sig-param">n=1.0</em>, <em class="sig-param">exact=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/baryons.html#Baryons.xi_relax_dark_matter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.baryons.Baryons.xi_relax_dark_matter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.cls">
<span id="bacco-cls-module"></span><h2>bacco.cls module<a class="headerlink" href="#module-bacco.cls" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.cls.Cl">
<em class="property">class </em><code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">Cl</code><span class="sig-paren">(</span><em class="sig-param">zobs=0.5</em>, <em class="sig-param">sigma_z=0.05</em>, <em class="sig-param">cosmo=None</em>, <em class="sig-param">probes=None</em>, <em class="sig-param">dndz=None</em>, <em class="sig-param">lmin=20</em>, <em class="sig-param">lmax=2000</em>, <em class="sig-param">bias=1.0</em>, <em class="sig-param">nside=128</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">master=False</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">z_kg=1.0</em>, <em class="sig-param">z_m=0.9</em>, <em class="sig-param">nl=30</em>, <em class="sig-param">do_tomography=False</em>, <em class="sig-param">z_tomo=array([0.9</em>, <em class="sig-param">1.1])</em>, <em class="sig-param">sigz_tomo=0.01</em>, <em class="sig-param">xx=None</em>, <em class="sig-param">jl=None</em>, <em class="sig-param">xx_d=None</em>, <em class="sig-param">djl_dx=None</em>, <em class="sig-param">k=None</em>, <em class="sig-param">pk=None</em>, <em class="sig-param">int_mode=None</em>, <em class="sig-param">exact_bessel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that implements different kind of angular power spectra</p>
<dl class="method">
<dt id="bacco.cls.Cl.Hubble">
<code class="sig-name descname">Hubble</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.Hubble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.Hubble" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.cls.Cl.M_ll">
<code class="sig-name descname">M_ll</code><a class="reference internal" href="_modules/bacco/cls.html#Cl.M_ll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.M_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to compute the mode-mode coupling kernel, e.g. Hivon et al. 2001
Way faster with respect to compute_Mll</p>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.R_z">
<code class="sig-name descname">R_z</code><span class="sig-paren">(</span><em class="sig-param">redshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.R_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.R_z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.bias_z">
<code class="sig-name descname">bias_z</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.bias_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.bias_z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.compute_cl">
<code class="sig-name descname">compute_cl</code><span class="sig-paren">(</span><em class="sig-param">probe1</em>, <em class="sig-param">probe2</em>, <em class="sig-param">key1='tot'</em>, <em class="sig-param">key2='tot'</em>, <em class="sig-param">tomo1=None</em>, <em class="sig-param">tomo2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.compute_cl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.compute_cl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the power spectrum between probe1 and probe2.
See self.get_cl() function for docstring.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.compute_density">
<code class="sig-name descname">compute_density</code><span class="sig-paren">(</span><em class="sig-param">dndz</em>, <em class="sig-param">z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.compute_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.compute_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the density of galaxies as a function of z in [h/Mpc]^3</p>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.compute_master">
<code class="sig-name descname">compute_master</code><span class="sig-paren">(</span><em class="sig-param">f_a</em>, <em class="sig-param">f_b</em>, <em class="sig-param">wsp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.compute_master"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.compute_master" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.covariance">
<code class="sig-name descname">covariance</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">gaussian=False</em>, <em class="sig-param">master=False</em>, <em class="sig-param">nmaps=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.covariance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.get_argdg">
<code class="sig-name descname">get_argdg</code><span class="sig-paren">(</span><em class="sig-param">zobs=None</em>, <em class="sig-param">sigmaz=None</em>, <em class="sig-param">idxbin=None</em>, <em class="sig-param">bins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.get_argdg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.get_argdg" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the argument for the galaxy overdensity delta_g, as in get_argdz.
if bins = None, tehn it uses zobs and sigmaz as the gaussian bin for the tomography.
if bins = euclidphot, then it uses idxbin to compute the n_i(z) as in the IST paper,</p>
<blockquote>
<div><p>with a binning derived from the photometric uncertainties.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.get_argdz">
<code class="sig-name descname">get_argdz</code><span class="sig-paren">(</span><em class="sig-param">zobs</em>, <em class="sig-param">sigmaz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.get_argdz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.get_argdz" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute the argument for integrating the deltaz to have the window function for the</dt><dd><p>power spectrum computation.</p>
</dd>
</dl>
<p>arguments:
zobs : central redshift of the gaussian window function
sigmaz : standard deviation of the gaussian window function.</p>
<p>returns:
argdz: dictionary containing the density term [‘dens’] and the line of</p>
<blockquote>
<div><p>sight velocity term [‘vlos’]</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.get_cl">
<code class="sig-name descname">get_cl</code><span class="sig-paren">(</span><em class="sig-param">probe1</em>, <em class="sig-param">probe2</em>, <em class="sig-param">key1='tot'</em>, <em class="sig-param">key2='tot'</em>, <em class="sig-param">tomo1=None</em>, <em class="sig-param">tomo2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.get_cl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.get_cl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the power spectrum between probe1 and probe2.
If the Cl is already computed then it returns the one stored in teh dictionary.</p>
<dl>
<dt>probe1, probe2<span class="classifier"><cite>string</cite> in ‘dg’, ‘dz’, ‘kcmb’ or ‘kg’</span></dt><dd><p>must be defined in the array probes during initialization of the Cl class
in order to compute the corresponding window functions (delta dictionary).</p>
</dd>
<dt>key1, key2: <cite>string</cite> in ‘dens’, ‘vlos’ and ‘tot’</dt><dd><p>say if we want only the part coming from the density or velocities in case
of the dz or dg probes. Default ‘tot’ corresponds to sum of ‘dens’ and ‘vlos’</p>
</dd>
<dt>tomo1, tomo2: floats in the array z_tomo, used to compute the power spetrum between</dt><dd><p>the tomographic redshift bin centered in tomo1 and tomo2, or the power spectrum
between one tomographic bin and another probe. Default is None meaning that we
take the the large redshift bin of the probe.</p>
</dd>
</dl>
<dl class="simple">
<dt>cl_array<span class="classifier">np.array containing the corresponding C(l)</span></dt><dd><p>the array is saved in the self.Cl_dict dictionnary to access it later</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.get_cl_name">
<code class="sig-name descname">get_cl_name</code><span class="sig-paren">(</span><em class="sig-param">probe1</em>, <em class="sig-param">probe2</em>, <em class="sig-param">key1='tot'</em>, <em class="sig-param">key2='tot'</em>, <em class="sig-param">tomo1=None</em>, <em class="sig-param">tomo2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.get_cl_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.get_cl_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of the Cl with two probes and keys according to my convention,
in alphabetical order.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.get_sample_field">
<code class="sig-name descname">get_sample_field</code><span class="sig-paren">(</span><em class="sig-param">Cl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.get_sample_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.get_sample_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.growth_rate">
<code class="sig-name descname">growth_rate</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">growth</em>, <em class="sig-param">k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.growth_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.growth_rate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cls.Cl.growthfactor">
<code class="sig-name descname">growthfactor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Cl.growthfactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Cl.growthfactor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.cls.Delta_fixedquad">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">Delta_fixedquad</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">k_array</em>, <em class="sig-param">l_array</em>, <em class="sig-param">arg</em>, <em class="sig-param">term='density'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Delta_fixedquad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Delta_fixedquad" title="Permalink to this definition">¶</a></dt>
<dd><p>Use scipy.integrate.fixed_quad to perofrm integrations of the wndow functions.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.cls.Delta_nw">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">Delta_nw</code><span class="sig-paren">(</span><em class="sig-param">dr</em>, <em class="sig-param">r</em>, <em class="sig-param">arg</em>, <em class="sig-param">l</em>, <em class="sig-param">k</em>, <em class="sig-param">exact_bessel=False</em>, <em class="sig-param">xx=None</em>, <em class="sig-param">jl=None</em>, <em class="sig-param">derivative=False</em>, <em class="sig-param">rk=None</em>, <em class="sig-param">jrk=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Delta_nw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Delta_nw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.cls.Delta_ww">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">Delta_ww</code><span class="sig-paren">(</span><em class="sig-param">term</em>, <em class="sig-param">r</em>, <em class="sig-param">arg1</em>, <em class="sig-param">rc1</em>, <em class="sig-param">Deltalog</em>, <em class="sig-param">nx</em>, <em class="sig-param">q</em>, <em class="sig-param">kropt</em>, <em class="sig-param">nozero</em>, <em class="sig-param">k</em>, <em class="sig-param">l</em>, <em class="sig-param">nl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Delta_ww"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Delta_ww" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.cls.FFTLOG">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">FFTLOG</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">fx</em>, <em class="sig-param">xc</em>, <em class="sig-param">deltalog</em>, <em class="sig-param">n</em>, <em class="sig-param">l</em>, <em class="sig-param">q</em>, <em class="sig-param">kropt</em>, <em class="sig-param">direction</em>, <em class="sig-param">nozero</em>, <em class="sig-param">k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#FFTLOG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.FFTLOG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.cls.Poisson_term">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">Poisson_term</code><span class="sig-paren">(</span><em class="sig-param">ngal_per_pixel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#Poisson_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.Poisson_term" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.cls.compute_Mll">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">compute_Mll</code><span class="sig-paren">(</span><em class="sig-param">lmax</em>, <em class="sig-param">Cl_mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#compute_Mll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.compute_Mll" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to compute the mode-mode coupling kernel, e.g. Hivon et al. 2001</p>
</dd></dl>

<dl class="function">
<dt id="bacco.cls.normalised_galaxy_distribution">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">normalised_galaxy_distribution</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">z_m</em>, <em class="sig-param">alpha=None</em>, <em class="sig-param">gamma=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#normalised_galaxy_distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.normalised_galaxy_distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.cls.spherical_Bessel">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">spherical_Bessel</code><span class="sig-paren">(</span><em class="sig-param">l</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#spherical_Bessel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.spherical_Bessel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.cls.spherical_Bessel_derivative">
<code class="sig-prename descclassname">bacco.cls.</code><code class="sig-name descname">spherical_Bessel_derivative</code><span class="sig-paren">(</span><em class="sig-param">l</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cls.html#spherical_Bessel_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cls.spherical_Bessel_derivative" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-bacco.configuration">
<span id="bacco-configuration-module"></span><h2>bacco.configuration module<a class="headerlink" href="#module-bacco.configuration" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bacco.configuration.set_default">
<code class="sig-prename descclassname">bacco.configuration.</code><code class="sig-name descname">set_default</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/configuration.html#set_default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.configuration.set_default" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.configuration.update">
<code class="sig-prename descclassname">bacco.configuration.</code><code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/configuration.html#update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.configuration.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-bacco.cosmo_parameters">
<span id="bacco-cosmo-parameters-module"></span><h2>bacco.cosmo_parameters module<a class="headerlink" href="#module-bacco.cosmo_parameters" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-bacco.cosmology">
<span id="bacco-cosmology-module"></span><h2>bacco.cosmology module<a class="headerlink" href="#module-bacco.cosmology" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Cosmology’ class and helper functions</p>
<dl class="class">
<dt id="bacco.cosmology.Cosmology">
<em class="property">class </em><code class="sig-prename descclassname">bacco.cosmology.</code><code class="sig-name descname">Cosmology</code><span class="sig-paren">(</span><em class="sig-param">hubble=0.73</em>, <em class="sig-param">omega_cdm=0.205</em>, <em class="sig-param">omega_baryon=0.045</em>, <em class="sig-param">omega_de=None</em>, <em class="sig-param">omega_k=None</em>, <em class="sig-param">geometry='flat'</em>, <em class="sig-param">use_radiation=False</em>, <em class="sig-param">neutrino_mass=0.0</em>, <em class="sig-param">sigma8=0.9</em>, <em class="sig-param">ns=0.9611</em>, <em class="sig-param">tau=0.0952</em>, <em class="sig-param">de_model='LCDM'</em>, <em class="sig-param">w0=-1</em>, <em class="sig-param">wa=0</em>, <em class="sig-param">A_s=None</em>, <em class="sig-param">DeltaNeff=3.046</em>, <em class="sig-param">approx_nu=False</em>, <em class="sig-param">expfactor=1.0</em>, <em class="sig-param">ReNormalizeInputSpectrum=True</em>, <em class="sig-param">pkfile_expfactor=1.0</em>, <em class="sig-param">pkfile=None</em>, <em class="sig-param">initial_growth_expfac=0.01</em>, <em class="sig-param">mDM=None</em>, <em class="sig-param">tag=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that implements a cosmological model</p>
<p>It stores the cosmological parameters and gives the user access to a number of
functions to compute predictions of many quantities. If not otherwise specified
all quantities are in units of <span class="math notranslate nohighlight">\(h\)</span>. Cosmological distances are in
<span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span>, masses in <span class="math notranslate nohighlight">\(10^{10} h^{-1} \mathrm{M}_\odot\)</span>.
In bacco the preferred  time variable is neither cosmic time nor redshift,
but the expansion factor <span class="math notranslate nohighlight">\(a = 1 / (1+z)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hubble</strong> (<em>float</em><em>, </em><em>optional</em>) – Hubble parameter, H0 / 100, defaults to 0.73</p></li>
<li><p><strong>omega_cdm</strong> (<em>float</em><em>, </em><em>optional</em>) – Cold dark matter density parameter, defaults to 0.205</p></li>
<li><p><strong>omega_baryon</strong> (<em>float</em><em>, </em><em>optional</em>) – Baryon density parameter, defaults to 0.045</p></li>
<li><p><strong>omega_de</strong> (<em>float</em><em>, </em><em>optional</em>) – Dark energy density parameter, defaults to None</p></li>
<li><p><strong>omega_k</strong> (<em>float</em><em>, </em><em>optional</em>) – Curvature density parameter, defaults to None</p></li>
<li><p><strong>geometry</strong> (<em>string</em><em>, </em><em>optional</em>) – Geometry model, defaults to ‘flat’</p></li>
<li><p><strong>use_radiation</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to include radiation in the background, requires that
config[‘growth’][‘method’] be set to ‘reps’, defaults to False</p></li>
<li><p><strong>neutrino_mass</strong> (<em>float</em><em>, </em><em>optional</em>) – The total mass of neutrinos (sum of all mass eigenstates)
expressed in eV, defaults to 0</p></li>
<li><p><strong>sigma8</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear amplitude of fluctuations smoothed on the scale
<span class="math notranslate nohighlight">\(R=8 h^{-1} Mpc\)</span> at redshift <span class="math notranslate nohighlight">\(z=0\)</span>. If None, A_s should
be specified instead, defaults to 0.9</p></li>
<li><p><strong>ns</strong> (<em>float</em><em>, </em><em>optional</em>) – The spectral index of scalar primordial fluctuations, defaults to 0.9611</p></li>
<li><p><strong>tau</strong> (<em>float</em><em>, </em><em>optional</em>) – The optical depth at recombination, defaults to 0.0952</p></li>
<li><p><strong>de_model</strong> (<em>string</em>) – Dark energy model, it can be ‘LCDM’, ‘w0wa’ or ‘w0wa_steigerwald’
or the path to a valid file containing a 2 column table [z, w(z)],
defaults to ‘LCDM’</p></li>
<li><p><strong>w0</strong> (<em>float</em><em>, </em><em>optional</em>) – Present time value of the dark energy equation of state, defaults to -1</p></li>
<li><p><strong>wa</strong> (<em>float</em><em>, </em><em>optional</em>) – Time dependent parameter of the dark energy equation of state according to
LC parametrization, <span class="math notranslate nohighlight">\(w = w_0 + (1-a) w_a\)</span>, defaults to 0</p></li>
<li><p><strong>A_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the spectrum of scalar perturbations at recombination at pivot
scale <span class="math notranslate nohighlight">\(k = 0.05 \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>DeltaNeff</strong> (<em>float</em><em>, </em><em>optional</em>) – Residual number of relativistic species in the early universe (normally
considered to be 3.046), defaults to 3.046</p></li>
<li><p><strong>approx_nu</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether neutrinos should be treated as nonrelativistic matter at all times,
defaults to False</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The expansion factor <span class="math notranslate nohighlight">\(a = 1/(1+z)\)</span> at which this cosmology is defined.
All evaluation that will not include an explicit expfactor, will correspond
to this time, defaults to 1</p></li>
<li><p><strong>ReNormalizeInputSpectrum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the present time power spectrum of this cosmology should be
renormalized in order to match the given sigma_8 or A_s, defaults to True</p></li>
<li><p><strong>pkfile_expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – If pkfile is not None, this is the expfansion factor corresponding to the
time of the power spectrum contained in pkfile, defaults to 1</p></li>
<li><p><strong>pkfile</strong> (<em>string</em>) – Origin of the present time power spectrum used to build the cosmology class. If
‘CAMB’ or ‘CLASS’ are selected, the corresponding Boltzmann code will be internally
called. If the path to a file is provided, the power spectrum will be read from
such file (change pkfile_expfactor is this file is not at z=0). If None,
‘CLASS’ will be assumed, defaults to None</p></li>
<li><p><strong>initial_growth_expfac</strong> (<em>float</em><em>, </em><em>optional</em>) – If config[‘growth’][‘method’] is ‘reps’, this is the expfactor at which the
boundary conditions for the ODE solution are computed, defaults to 0.01</p></li>
<li><p><strong>mDM</strong> (<em>float</em>) – If None, standard cold dark matter is assumed; otherwise mDM is the mass of the
dark matter particle in the warm dark matter context, defaults to None</p></li>
<li><p><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em>) – The name of this cosmology, defaults to None</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to get verbose outputs, defaults to None</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bacco</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="bacco.cosmology.Cosmology.As">
<code class="sig-name descname">As</code><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.As"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.As" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the amplitude of the linear perturbations at <span class="math notranslate nohighlight">\(k=0.05 \mathrm{Mpc}^{-1}\)</span> (chached)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="n">A_s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sigma8</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">As</span><span class="p">)</span>
<span class="gp">... </span><span class="mf">2.2367731302095207e-09</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.DE_EoS">
<code class="sig-name descname">DE_EoS</code><span class="sig-paren">(</span><em class="sig-param">redshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.DE_EoS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.DE_EoS" title="Permalink to this definition">¶</a></dt>
<dd><p>The time dependent equation of state <span class="math notranslate nohighlight">\(w_{\rm de}\)</span> of the dark energy component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>redshift</strong> (<em>array_like</em>) – The desired redshift(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.Ez_function">
<code class="sig-name descname">Ez_function</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Ez_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.Ez_function" title="Permalink to this definition">¶</a></dt>
<dd><p>The renormalized Hubble function H/H0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The normalized Hubble function E(a) = H(a) / H0</p>
</dd>
<dt class="field-odd">Array_like</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.Ez_function_norad">
<code class="sig-name descname">Ez_function_norad</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Ez_function_norad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.Ez_function_norad" title="Permalink to this definition">¶</a></dt>
<dd><p>The renormalized Hubble function H/H0 without radiation</p>
<p>Even if the cosmology was created with radiation, this function
return the renormalized Hubble function E(a) = H(a) / H0 computed
without including radiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The normalized radiationless Hubble function E(a) = H(a) / H0</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="bacco.cosmology.Cosmology.Gammas">
<code class="sig-name descname">Gammas</code><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Gammas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.Gammas" title="Permalink to this definition">¶</a></dt>
<dd><p>The parameters of the expansion of <span class="math notranslate nohighlight">\(\Omega_{m}^\gamma\)</span></p>
<p>This is referred to the log expansion presented in <a class="reference external" href="https://arxiv.org/pdf/1403.0898.pdf">https://arxiv.org/pdf/1403.0898.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary of ‘gamma0’, ‘gamma1’, ‘gamma2’</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.Kaiser_boost">
<code class="sig-name descname">Kaiser_boost</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Kaiser_boost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.Kaiser_boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Kaiser boost at a given expfactor and for a given bias
parameter (default = 1), for different multipole expansion orders:</p>
<p>l = 0, monopole
l = 2, quadrupole
l = 4, hexadecapole</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factors</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavenumbers in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – Multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.Kaiser_moments">
<code class="sig-name descname">Kaiser_moments</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.Kaiser_moments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.Kaiser_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mutliplicative factors for the redshift space
moments of the power spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The moment, defaults to 0</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – Linear bias, defaults to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><em class="sig-param">attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.comoving_radial_distance">
<code class="sig-name descname">comoving_radial_distance</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.comoving_radial_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.comoving_radial_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the comoving radial distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – Expansion factor at which the comoving radial distance is computed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Comoving radial distance in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.comoving_volume">
<code class="sig-name descname">comoving_volume</code><span class="sig-paren">(</span><em class="sig-param">z1</em>, <em class="sig-param">z2</em>, <em class="sig-param">area</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.comoving_volume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.comoving_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the comoving volume</p>
<p>It correspondes to the volume (in comoving coordinates) of
a redshift bin going from the initial redshift z1 out to
the final redshift z2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z1</strong> (<em>float</em>) – Initial redshift of the redshift bin</p></li>
<li><p><strong>z2</strong> – Final redshift of the redshift bin</p></li>
<li><p><strong>area</strong> (<em>float</em>) – Sky area in deg^2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The comoving volume in <span class="math notranslate nohighlight">\((h^{-1} \mathrm{Mpc})^3\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_biasfunction">
<code class="sig-name descname">compute_biasfunction</code><span class="sig-paren">(</span><em class="sig-param">nu=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">model=None</em>, <em class="sig-param">Delta=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_biasfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_biasfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear bias according to a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The peak-height, required if mass is not passed, defaults to None</p></li>
<li><p><strong>mass</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The mass in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{M}_\odot\)</span>, required if nu is not pass, defaults to None</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, if None the one of the cosmology class is used, defaults to None</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – The bias model to choose among ‘mowhite96’, ‘sheth01’, ‘tinker10’, defaults to None</p></li>
<li><p><strong>Delta</strong> (<em>float</em><em>, </em><em>optional</em>) – The overdensity threshold, defaults to 200</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_bihalofit">
<code class="sig-name descname">compute_bihalofit</code><span class="sig-paren">(</span><em class="sig-param">k1</em>, <em class="sig-param">k2</em>, <em class="sig-param">theta</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_bihalofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_bihalofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nonlinear bispectrum through halofit.</p>
<p>This implementation of Halofit follows Takahashi et al 2019: 1911.07886</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>array_like</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h\mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>k2</strong> (<em>array_like</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h\mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Angles between <span class="math notranslate nohighlight">\(k_1\)</span> and <span class="math notranslate nohighlight">\(k_2\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, in None the one of the cosmology
class is used, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply halofit to the cold or total matter
bispectrum, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarry</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_bispectrum_k3">
<code class="sig-name descname">compute_bispectrum_k3</code><span class="sig-paren">(</span><em class="sig-param">k1</em>, <em class="sig-param">k2</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_bispectrum_k3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_bispectrum_k3" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the length of the third leg of a triangle given the other two legs
and the angle between them.</p>
<p><span class="math notranslate nohighlight">\(k_3 = \sqrt{k_1^2 + k_2^2 - 2 k_1 k_2 \cos \vartheta}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>float</em>) – First leg of the triangle</p></li>
<li><p><strong>k2</strong> (<em>float</em>) – Second leg of the triangle</p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Angle(s) between the two legs</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_concentration">
<code class="sig-name descname">compute_concentration</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">Einasto=False</em>, <em class="sig-param">model=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the halo concentration c(M) in a given model</p>
<p>Possible models are:
‘prada12’,
‘ludlow16’,
‘ludlow16_approx’,
‘diemer15’,
‘diemer18’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – The mass in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{M}_\odot\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to None</p></li>
<li><p><strong>Einasto</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use Einasto profiles, defaults to False</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – The concentratio-mass model among ‘prada12’, ‘ludlow16’,
‘ludlow16_approx’, ‘diemer15’, ‘diemer18’, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_halofit">
<code class="sig-name descname">compute_halofit</code><span class="sig-paren">(</span><em class="sig-param">expfactor=None</em>, <em class="sig-param">boltzmann_solver=False</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_halofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_halofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halofit corrected power spectrum.</p>
<p>This implementation of Halofit follows Takahashi et al 2013: <a class="reference external" href="http://arxiv.org/pdf/1208.2701v2.pdf">http://arxiv.org/pdf/1208.2701v2.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to None</p></li>
<li><p><strong>boltzmann_solver</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the native halofit power spectrum from class/camb, defaults to False</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply halofit to the cold of total matter power spectrum, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_halomodel">
<code class="sig-name descname">compute_halomodel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_halomodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_halomodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nonlinear power spectrum with the halo model Cooray &amp; Sheth (2012)</p>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_massfunction">
<code class="sig-name descname">compute_massfunction</code><span class="sig-paren">(</span><em class="sig-param">nu=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">qty='nufnu'</em>, <em class="sig-param">model=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_massfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_massfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo mass function for a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The peak-height, required if mass is not passed, defaults to None</p></li>
<li><p><strong>mass</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The mass in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{M}_\odot\)</span>, required if nu is not pass, defaults to None</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, if None the one of the cosmology class is used, defaults to None</p></li>
<li><p><strong>qty</strong> (<em>str</em><em>, </em><em>optional</em>) – The form of the returned mass function to be chosen among ‘nufnu’,
‘dn_dlnM’, ‘dn_dlnM_sub’, ‘nufnu_sub’, and ‘fnu’, defaults to ‘nufnu’</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – The mass function model, to be chosen among ‘despali16’, ‘angulo12’, ‘musso12’,
‘jenkins01’, ‘PS74’, if None the one in the config.ini is used, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_sigmaR_z0">
<code class="sig-name descname">compute_sigmaR_z0</code><span class="sig-paren">(</span><em class="sig-param">rr</em>, <em class="sig-param">kmin=None</em>, <em class="sig-param">kk=None</em>, <em class="sig-param">pk=None</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">pk_interpolated=True</em>, <em class="sig-param">nthreads=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_sigmaR_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_sigmaR_z0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Computes the square root of the mass variance, <span class="math notranslate nohighlight">\(\sigma(R)\)</span>, for a given power spectrum and cosmology</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rr</strong> (<em>array_like</em>) – The smoothing radius in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>kmin</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum wavenumber used in the integration, defaults to None</p></li>
<li><p><strong>kk</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The wavemodes over which the power spectrum is required, defaults to None</p></li>
<li><p><strong>pk</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The linear power spectrum, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use the cold or total matter spectrum, defaults to True</p></li>
<li><p><strong>pk_interpolated</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to allow a resampling of the spectrum, defaults to True</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of threads for openMP (if None, all available threads
are used), defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – kk and pk should be provided</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.compute_tree_level_bispectrum">
<code class="sig-name descname">compute_tree_level_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">k1</em>, <em class="sig-param">k2</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.compute_tree_level_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.compute_tree_level_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute tree level bispectrum, see the review by Bernardeau et al (2002)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>float</em>) – First leg of the triangle</p></li>
<li><p><strong>k2</strong> (<em>float</em>) – Second leg of the triangle</p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Angle(s) between the two legs</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.dHubble_dz">
<code class="sig-name descname">dHubble_dz</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.dHubble_dz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.dHubble_dz" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of the Hubble function with respect to redshift</p>
<p>Please note that the expfactor is passed, but dH(a) / dz(a) is
the quantity computed by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The derivative of the Hubble function wrt redshift</p>
</dd>
<dt class="field-odd">Rtype array_like</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.delta_c">
<code class="sig-name descname">delta_c</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">correction='mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.delta_c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.delta_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Critical overdensity for collapse.
We use the redshift-dependence of Kitayama &amp; Suto (1996)
– as used in Despali et al 2016 – alternatively, we can use the
value derived in S5.1 of the Mo, van den Bosch and White’s book.
If the correction is None, then the uncorrected value from the
spherical collapse model is returned.</p>
<p>Note on the neutrino case: works such as Castorina et el 2015 found that
the critical overdensity for collapse in cosmologies that include massive
neutrinos is still well approximated by the usual 1.6865 (default value
here if no correction is specified). No study to my knowledge assessed
this issue for the kitayama or mo correction. TODO: it should be in
principle easy to check if omega_matter or omega_cold should be used in
this case (I would bet on omega_cold).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
<li><p><strong>correction</strong> (<em>string</em><em>, </em><em>optional</em>) – The correction to apply for the calculation of the threshold collapse
overdensity, among none, ‘mo’ and ‘kitayama’</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.dgrowthfactor_dz">
<code class="sig-name descname">dgrowthfactor_dz</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">growthfactor=None</em>, <em class="sig-param">k=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.dgrowthfactor_dz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.dgrowthfactor_dz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the derivative <span class="math notranslate nohighlight">\(\mathrm{d}D / \mathrm{d}a\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p></li>
<li><p><strong>growthfactor</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Value of the current grwoth factor, if None computed internally, defaults to None</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavemodes in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, used if growth method is ‘reps’, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.fsigma8_z">
<code class="sig-name descname">fsigma8_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.fsigma8_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.fsigma8_z" title="Permalink to this definition">¶</a></dt>
<dd><p>The product <span class="math notranslate nohighlight">\(f(a) \sigma_8(a)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.gamma_z">
<code class="sig-name descname">gamma_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.gamma_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.gamma_z" title="Permalink to this definition">¶</a></dt>
<dd><p>The time dependent power low index <span class="math notranslate nohighlight">\(\gamma\)</span> of <span class="math notranslate nohighlight">\(\Omega_{\mathrm{m}}^\gamma\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_alpha_eff">
<code class="sig-name descname">get_alpha_eff</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_alpha_eff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_alpha_eff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the logarithmic derivative of the growth factor <span class="math notranslate nohighlight">\(\mathrm{d} \ln D / \mathrm{d} \ln a\)</span></p>
<p>This corresponds to <span class="math notranslate nohighlight">\(\alpha_{\rm eff}\)</span> in Diemer &amp; Joyce (2018)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes if growth method is ‘reps’, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold (True, default)
or total (False) dark matter is desired, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_concentration">
<code class="sig-name descname">get_concentration</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo concentration at cosmology expansion factor</p>
<p>Note that the model specified in config[‘nonlinear’][‘concentration’] is
used. The default is ‘ludlow16’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Halo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The halo concentration</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_concentration_z0">
<code class="sig-name descname">get_concentration_z0</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_concentration_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_concentration_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo concentration at present time</p>
<p>Note that the model specified in config[‘nonlinear’][‘concentration’] is
used. The default is ‘ludlow16’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Halo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The halo concentration</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_correlationfunction">
<code class="sig-name descname">get_correlationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_correlationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_correlationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear 2-point correlation function at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_correlationfunction_z">
<code class="sig-name descname">get_correlationfunction_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_correlationfunction_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_correlationfunction_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear 2-point correlation function at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_dlnP_dlnk">
<code class="sig-name descname">get_dlnP_dlnk</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_dlnP_dlnk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_dlnP_dlnk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the logarithmic derivative <span class="math notranslate nohighlight">\(\mathrm{d}\ln P / \mathrm{d}\ln k\)</span> for the z=0 spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_dlnS_dlnR">
<code class="sig-name descname">get_dlnS_dlnR</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">kappa=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_dlnS_dlnR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_dlnS_dlnR" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the logaritmic derivative <span class="math notranslate nohighlight">\(\mathrm{d}\ln \sigma / \mathrm{d} \ln R\)</span> at the cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>kappa</strong> (<em>float</em>) – TODO: what is kappa?</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_growth_z">
<code class="sig-name descname">get_growth_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_growth_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_growth_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the growth factor <span class="math notranslate nohighlight">\(D(a) = \sqrt{P(a) / P(a=1)}\)</span></p>
<p>If the growth method is ‘reps’, the growth rate is computed as a
scale depndent quantity and the wavemode at which it is requested
must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes if growth method is ‘reps’,
defauts to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired,
defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_halomassfunction">
<code class="sig-name descname">get_halomassfunction</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">qty='dn_dlnM'</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_halomassfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_halomassfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo mass function at the cosmology expansion factor</p>
<p>Note that the model specified in config[‘nonlinear’][‘mass_function’] is
used. The default is ‘despali16’.</p>
<p>The mass function can be returned in different forms. If qty is ‘dn_dlnM’
then it will be returned as <span class="math notranslate nohighlight">\(\mathrm{d}n / \mathrm{d}\ln M\)</span>, in units
of <span class="math notranslate nohighlight">\(h^2 \mathrm{M}_\odot^{-1} \mathrm{Mpc}^{-3}\)</span> per unit log mass.
If qty is ‘nufnu’, then the universal mass function
<span class="math notranslate nohighlight">\(\nu f(\nu)\)</span> is returned instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Halo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>qty</strong> (<em>str</em><em>, </em><em>optional</em>) – the form of the returned mass function, defaults to ‘dn_dlnM’</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_loggrowth_z">
<code class="sig-name descname">get_loggrowth_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">derivative=0</em>, <em class="sig-param">k=None</em>, <em class="sig-param">cold=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_loggrowth_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_loggrowth_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the natural logarithm of the growth factor <span class="math notranslate nohighlight">\(\ln D(a)\)</span></p>
<p>For the actual growth factor see <a class="reference internal" href="code.html#bacco.Cosmology.get_growth_z" title="bacco.Cosmology.get_growth_z"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bacco.Cosmology.get_growth_z()</span></code></a></p>
<p>If the growth method is ‘reps’, the growth rate is computed as a
scale depndent quantity and the wavemode at which it is requested
must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>derivative</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, return <span class="math notranslate nohighlight">\(\mathrm{d} \ln D / \mathrm{d} \ln a\)</span>,
defaults to 0</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes if growth method is ‘reps’, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_logvariance_z">
<code class="sig-name descname">get_logvariance_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">invert=False</em>, <em class="sig-param">derivative=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_logvariance_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_logvariance_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute logarithm of the linear density amplitude <span class="math notranslate nohighlight">\(\ln \sigma_R(a)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span>. If invert is
True, this is sigma and the radius is returned instead</p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>invert</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the radius corresponding to the given sigma,
defaults to False</p></li>
<li><p><strong>derivative</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, the logaritmic derivative
<span class="math notranslate nohighlight">\(\mathrm{d}\sigma / \mathrm{d} R\)</span> is returned,
defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired,
defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlcorrelationfunction">
<code class="sig-name descname">get_nlcorrelationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlcorrelationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlcorrelationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear 2-point correlation function at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlcorrelationfunction_z">
<code class="sig-name descname">get_nlcorrelationfunction_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlcorrelationfunction_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlcorrelationfunction_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear 2-point correlation function at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlcorrelationfunction_z0">
<code class="sig-name descname">get_nlcorrelationfunction_z0</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlcorrelationfunction_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlcorrelationfunction_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear 2-point correlation function at present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlpowerspec">
<code class="sig-name descname">get_nlpowerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlpowerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlpowerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlpowerspec_z">
<code class="sig-name descname">get_nlpowerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlpowerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlpowerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlpowerspec_z0">
<code class="sig-name descname">get_nlpowerspec_z0</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlpowerspec_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlpowerspec_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear power spectrum at present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlzcorrelationfunction">
<code class="sig-name descname">get_nlzcorrelationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlzcorrelationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlzcorrelationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear redshift space 2-point correlation function at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlzpowerspec">
<code class="sig-name descname">get_nlzpowerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlzpowerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlzpowerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear redshift space power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nlzpowerspec_z">
<code class="sig-name descname">get_nlzpowerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nlzpowerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nlzpowerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the nonlinear redshift space power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nonlinear_scale">
<code class="sig-name descname">get_nonlinear_scale</code><span class="sig-paren">(</span><em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nonlinear_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nonlinear_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavemode where nonlinearities become important</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the cosmology rescaling parameters,
defaults to True</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The nonlinear scale in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_nu_from_mass">
<code class="sig-name descname">get_nu_from_mass</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">expfactor=None</em>, <em class="sig-param">correction='mo'</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_nu_from_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_nu_from_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the peak-height correspondening to teh given mass at the given redshift</p>
<p>The peak-height <span class="math notranslate nohighlight">\(\nu = \delta_{\rm collapse} / \sigma(M)\)</span> depends
on the model assumed to compute the collapse threshold. If correction is None,
the spherical collapse value 1.686 is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor (if None, the comsology expansion
factor is used), defaults to None</p></li>
<li><p><strong>correction</strong> (<em>str</em><em>, </em><em>optional</em>) – The correction for the collapse density threshold (None,
‘mo’ or ‘kitayama), defaults to ‘mo’</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_powerspec">
<code class="sig-name descname">get_powerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_powerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_powerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_powerspec_z">
<code class="sig-name descname">get_powerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_powerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_powerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_powerspec_z0">
<code class="sig-name descname">get_powerspec_z0</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_powerspec_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_powerspec_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear power spectrum at present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_subhalomassfunction">
<code class="sig-name descname">get_subhalomassfunction</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">qty='dn_dlnM'</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_subhalomassfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_subhalomassfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the subhalo mass function at the cosmology expansion factor</p>
<p>Note that this is defined only if the model specified
in config[‘nonlinear’][‘mass_function’] is ‘angulo12’.</p>
<p>The mass function can be returned in different forms. If qty is ‘dn_dlnM’
then it will be returned as <span class="math notranslate nohighlight">\(\mathrm{d}n / \mathrm{d}\ln M\)</span>, in units
of <span class="math notranslate nohighlight">\(h^2 \mathrm{M}_\odot^{-1} \mathrm{Mpc}^{-3}\)</span> per unit log mass.
If qty is ‘nufnu’, then the universal mass function
<a href="#id1"><span class="problematic" id="id2">:mathrm:`\nu f(\nu)`</span></a> is returned instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Subhalo mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>qty</strong> (<em>str</em><em>, </em><em>optional</em>) – the form of the returned mass function, defaults to ‘dn_dlnM’</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_variance">
<code class="sig-name descname">get_variance</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear density amplitude <span class="math notranslate nohighlight">\(\sigma_R(a)\)</span> at the cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_variance_z">
<code class="sig-name descname">get_variance_z</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_variance_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_variance_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear density amplitude <span class="math notranslate nohighlight">\(\sigma_R(a)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_variance_z0">
<code class="sig-name descname">get_variance_z0</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_variance_z0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_variance_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear density amplitude <span class="math notranslate nohighlight">\(\sigma_R(a)\)</span> at the present time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius of the smoothing spheres in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the growth factor of the cold
or total (False) dark matter is desired, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_zcorrelationfunction">
<code class="sig-name descname">get_zcorrelationfunction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">l=0</em>, <em class="sig-param">bias=1</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zcorrelationfunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_zcorrelationfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the redshift space 2-point correlation function at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>array_like</em>) – The separation in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias, defaults to 1</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_zpowerspec">
<code class="sig-name descname">get_zpowerspec</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zpowerspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_zpowerspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear redshift space power spectrum at cosmology expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>l</strong> (<em>float</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_zpowerspec_moments">
<code class="sig-name descname">get_zpowerspec_moments</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zpowerspec_moments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_zpowerspec_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the momenta of teh redshift space power spectrum</p>
<p>This corresponds to <span class="math notranslate nohighlight">\(P_\ell(k) = \int \mathrm{d}\mu P(k) \mu^\ell\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>l</strong> (<em>float</em><em>, </em><em>optional</em>) – The moment <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.get_zpowerspec_z">
<code class="sig-name descname">get_zpowerspec_z</code><span class="sig-paren">(</span><em class="sig-param">wavemode</em>, <em class="sig-param">expfactor</em>, <em class="sig-param">l=0</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">bias=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.get_zpowerspec_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.get_zpowerspec_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear redshift space power spectrum at given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavemode</strong> (<em>array_like</em>) – The wavemode in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>l</strong> (<em>float</em><em>, </em><em>optional</em>) – The multipole <span class="math notranslate nohighlight">\(\ell\)</span>, defaults to 0</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter component, defaults to True</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled cosmology parameters, defaults to True</p></li>
<li><p><strong>bias</strong> (<em>float</em><em>, </em><em>optional</em>) – The linear bias</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.growthfactor">
<code class="sig-name descname">growthfactor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">exact=True</em>, <em class="sig-param">derivative=False</em>, <em class="sig-param">wavemode=None</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">nthreads=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.growthfactor" title="Permalink to this definition">¶</a></dt>
<dd><p>The linear growth factor</p>
<p>Function that computes the growth factor at high redshift (i.e. matter-radiation regime) analytically,
using Equation 5 in Gnedin et al. 2011 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJS..194...46G">http://adsabs.harvard.edu/abs/2011ApJS..194…46G</a>), while
at low redshift (i.e. matter-dark energy regime) through integration. The two regimes are linearly
interpoleted following e.g.  Benedikt Diemer 2017 (<a class="reference external" href="https://arxiv.org/pdf/1712.04512.pdf">https://arxiv.org/pdf/1712.04512.pdf</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p></li>
<li><p><strong>exact</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether if the exact solution is required TODO: what does this mean?, defaults to True</p></li>
<li><p><strong>derivative</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the derivative <span class="math notranslate nohighlight">\(\mathrm{d} \ln D / \mathrm{d} \ln a\)</span> should be
returned instead, defaults to False</p></li>
<li><p><strong>wavemode</strong> (<em>array_like</em><em>, </em><em>optional</em>) – If the growth method is ‘reps’, the wavemodes at which the growth factor
is required, defaults to None</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to get the cold or total matter growth factor, defaults to True</p></li>
<li><p><strong>nthreads</strong> (<em>bool</em><em>, </em><em>optional</em>) – The number of threads used for ompenMP (if None, all available threads
are used), defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>arra_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.growthfactorD2">
<code class="sig-name descname">growthfactorD2</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactorD2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.growthfactorD2" title="Permalink to this definition">¶</a></dt>
<dd><p>The second order growth factor for LPT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(a)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.growthfactorD3a">
<code class="sig-name descname">growthfactorD3a</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactorD3a"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.growthfactorD3a" title="Permalink to this definition">¶</a></dt>
<dd><p>First part of the 3rd order growth factor in LPT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.growthfactorD3b">
<code class="sig-name descname">growthfactorD3b</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthfactorD3b"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.growthfactorD3b" title="Permalink to this definition">¶</a></dt>
<dd><p>Second part of the 3rd order growth factor in LPT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.growthrate">
<code class="sig-name descname">growthrate</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">cold=True</em>, <em class="sig-param">k=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.growthrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.growthrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the growth rate at the given expansion factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p></li>
<li><p><strong>cold</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the cold or total matter growth rate, defaults to True</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Wavenumbers in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.hubble_z">
<code class="sig-name descname">hubble_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.hubble_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.hubble_z" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hubble function H</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Hubble function H(a) in <span class="math notranslate nohighlight">\(\mathrm{km} \, \mathrm{s}^{-1} \, \mathrm{Mpc}^{-1}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.lookback_time">
<code class="sig-name descname">lookback_time</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.lookback_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.lookback_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute lookback time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lookback time in Gyrs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.luminosity_distance">
<code class="sig-name descname">luminosity_distance</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.luminosity_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.luminosity_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the luminosity distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – Expfactor of the required luminosity distance</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Luminosity distance in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.mass_to_eulerian_radius">
<code class="sig-name descname">mass_to_eulerian_radius</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">overdensity=200.0</em>, <em class="sig-param">scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_eulerian_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.mass_to_eulerian_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the radius <span class="math notranslate nohighlight">\(R_{200, \mathrm{crit}}\)</span> enclosing a given mass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Mass in a sphere expressed in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p></li>
<li><p><strong>overdensity</strong> (<em>float</em><em>, </em><em>optional</em>) – Overdensity threshold, defaults to 200</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the scaled simulation parameters, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radius <cite>R_{200, mathrm{crit}}</cite> in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.mass_to_nu">
<code class="sig-name descname">mass_to_nu</code><span class="sig-paren">(</span><em class="sig-param">mass</em>, <em class="sig-param">expfactor=1</em>, <em class="sig-param">correction='mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_nu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.mass_to_nu" title="Permalink to this definition">¶</a></dt>
<dd><p>Peak height nu given a mass M, at time given by expfact.</p>
<p>Note that this is always computed for the cold matter component (which
is different from the total matter fraction when neutrinos are considered)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>array_like</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
<li><p><strong>correction</strong> (<em>string</em><em>, </em><em>optional</em>) – The correction to apply for the calculation of the threshold collapse
overdensity, among none, ‘mo’ and ‘kitayama’</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.mass_to_overdensity">
<code class="sig-name descname">mass_to_overdensity</code><span class="sig-paren">(</span><em class="sig-param">enclosed_mass</em>, <em class="sig-param">radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_overdensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.mass_to_overdensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the enclosed overdensity relative to the critical density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encolsed_mass</strong> – The mass enclosed in a sphere of given radius, in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p></li>
<li><p><strong>radius</strong> (<em>array_like</em>) – The radius enclosing the given mass, in <span class="math notranslate nohighlight">\(h^{-1}\mathrm{Mpc}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.mass_to_radius">
<code class="sig-name descname">mass_to_radius</code><span class="sig-paren">(</span><em class="sig-param">mass</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.mass_to_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.mass_to_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the radius enclosing a given cold (cdm + baryons) mass</p>
<p>Note that this is always computed for the cold matter component (baryons
and cdm), which is different from the total matter fraction when
neutrinos are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mass</strong> (<em>array_like</em>) – Mass in a sphere expressed in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radius in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.neutrino_eos">
<code class="sig-name descname">neutrino_eos</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_eos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.neutrino_eos" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent neutrino pressure parameter, <span class="math notranslate nohighlight">\(w_\nu(a)\)</span>.</p>
<p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.neutrino_fluid_free_streaming_scale">
<code class="sig-name descname">neutrino_fluid_free_streaming_scale</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_fluid_free_streaming_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.neutrino_fluid_free_streaming_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent neutrino free streaming scale <span class="math notranslate nohighlight">\(h\)</span> / Mpc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.neutrino_fluid_speed_of_sound">
<code class="sig-name descname">neutrino_fluid_speed_of_sound</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_fluid_speed_of_sound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.neutrino_fluid_speed_of_sound" title="Permalink to this definition">¶</a></dt>
<dd><p>Time dependent neutrino sound speed in km / s</p>
<p>See Blas et al (2014) for details</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.neutrino_nonrel_transition">
<code class="sig-name descname">neutrino_nonrel_transition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.neutrino_nonrel_transition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.neutrino_nonrel_transition" title="Permalink to this definition">¶</a></dt>
<dd><p>Expansion factor at the time on non-rel transition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.nu_to_mass">
<code class="sig-name descname">nu_to_mass</code><span class="sig-paren">(</span><em class="sig-param">nu</em>, <em class="sig-param">expfactor=1</em>, <em class="sig-param">correction='mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.nu_to_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.nu_to_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Mass M given the Peak height nu, at time given by expfact.</p>
<p>Note that this is always computed for the cold matter component (which
is different from the total matter fraction when neutrinos are considered)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em>) – peak height</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
<li><p><strong>correction</strong> (<em>string</em><em>, </em><em>optional</em>) – The correction to apply for the calculation of the threshold collapse
overdensity, among none, ‘mo’ and ‘kitayama’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding mass in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{M}_\odot\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.nu_to_radius">
<code class="sig-name descname">nu_to_radius</code><span class="sig-paren">(</span><em class="sig-param">nu</em>, <em class="sig-param">expfactor=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.nu_to_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.nu_to_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Radius R given the Peak height nu, at time given by expfact.</p>
<p>Note that this is always computed for the cold matter component (which
is different from the total matter fraction when neutrinos are considered)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nu</strong> (<em>array_like</em>) – peak height</p></li>
<li><p><strong>expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired expansion factor, defaults to 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding radius in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_baryons_z">
<code class="sig-name descname">omega_baryons_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_baryons_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_baryons_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the baryon density parameter :math:<a href="#id3"><span class="problematic" id="id4">`</span></a>Omega_{</p>
</div></blockquote>
<p>m b}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_cdm_z">
<code class="sig-name descname">omega_cdm_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_cdm_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_cdm_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the cold dark matter density parameter :math:<a href="#id5"><span class="problematic" id="id6">`</span></a>Omega_{</p>
</div></blockquote>
<p>m cdm}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_cold_z">
<code class="sig-name descname">omega_cold_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_cold_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_cold_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the cold matter (cdm+baryon) density parameter :math:<a href="#id7"><span class="problematic" id="id8">`</span></a>Omega_{</p>
</div></blockquote>
<p>m cold}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_de_z">
<code class="sig-name descname">omega_de_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_de_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_de_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the dark energy density parameter :math:<a href="#id9"><span class="problematic" id="id10">`</span></a>Omega_{</p>
</div></blockquote>
<p>m de}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_matter_z">
<code class="sig-name descname">omega_matter_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_matter_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_matter_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the total matter density parameter :math:<a href="#id11"><span class="problematic" id="id12">`</span></a>Omega_{</p>
</div></blockquote>
<p>m m}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_neutrino_nonrel">
<code class="sig-name descname">omega_neutrino_nonrel</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_neutrino_nonrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_neutrino_nonrel" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Time dependent non-relativistic neutrino fraction, :math:<a href="#id13"><span class="problematic" id="id14">`</span></a>[1 - 3 <a href="#id31"><span class="problematic" id="id32">w_</span></a></p>
</div></blockquote>
<p>u(a)]Omega_
u(a)`</p>
<blockquote>
<div><p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_neutrino_rel">
<code class="sig-name descname">omega_neutrino_rel</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_neutrino_rel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_neutrino_rel" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Time dependent relativistic neutrino fraction, :math:<a href="#id15"><span class="problematic" id="id16">`</span></a>3 <a href="#id33"><span class="problematic" id="id34">w_</span></a></p>
</div></blockquote>
<p>u(a) Omega_
u(a)`</p>
<blockquote>
<div><p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_neutrino_z">
<code class="sig-name descname">omega_neutrino_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_neutrino_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_neutrino_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the neutrino density parameter :math:<a href="#id17"><span class="problematic" id="id18">`</span></a>Omega_</p>
</div></blockquote>
<p>u(a)`</p>
<blockquote>
<div><p>Note that if pars[‘approx_nu’] is True, neutrinos are treated as
nonrelativistic at all times.</p>
<dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.omega_rad_z">
<code class="sig-name descname">omega_rad_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.omega_rad_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.omega_rad_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the radiation density parameter :math:<a href="#id19"><span class="problematic" id="id20">`</span></a>Omega_{</p>
</div></blockquote>
<p>m cdm}(a)`</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.plots">
<code class="sig-name descname">plots</code><span class="sig-paren">(</span><em class="sig-param">block=False</em>, <em class="sig-param">test=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.plots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.radius_to_eulerian_mass">
<code class="sig-name descname">radius_to_eulerian_mass</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">overdensity=200.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.radius_to_eulerian_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.radius_to_eulerian_mass" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compute the mass related to the given critical overdensity threshold within a given radius</p>
<p>This is the mass enclosed in a sphere of radius R, such that the overdensity
in this sphere is :math:<a href="#id21"><span class="problematic" id="id22">`</span></a></p>
</div></blockquote>
<dl class="simple">
<dt>arepsilon` times the critical density, where</dt><dd><p>:math:<a href="#id23"><span class="problematic" id="id24">`</span></a></p>
</dd>
</dl>
<p>arepsilon` is given by the parameter overdensity</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param radius</dt>
<dd class="field-odd"><p>Radius of a sphere in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-even">type radius</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">param overdensity</dt>
<dd class="field-odd"><p>Overdensity threshold, defaults to 200</p>
</dd>
<dt class="field-even">type overdensity</dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">returns</dt>
<dd class="field-odd"><p>Enclosed <span class="math notranslate nohighlight">\(M_{200, \mathrm{crit}}\)</span> in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p>
</dd>
<dt class="field-even">rtype</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.radius_to_mass">
<code class="sig-name descname">radius_to_mass</code><span class="sig-paren">(</span><em class="sig-param">radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.radius_to_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.radius_to_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mass M enclosed in a given radius</p>
<p>Note that this is always computed for the cold matter component (baryons
and cdm), which is different from the total matter fraction when
neutrinos are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>radius</strong> (<em>array_like</em>) – Radius of a sphere in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Enclosed mass in <span class="math notranslate nohighlight">\(\mathrm{M}_\odot/h\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.redshift_to_comoving_distance">
<code class="sig-name descname">redshift_to_comoving_distance</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.redshift_to_comoving_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.redshift_to_comoving_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the redshift corresponding to a given radial comoving distance.</p>
<p>:param d : Comoving radial distance in <span class="math notranslate nohighlight">\(h^{-1} \mathrm{Mpc}\)</span>
:type d: array_like</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Redshift corresponding to d</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.reps_boundary_conditions">
<code class="sig-name descname">reps_boundary_conditions</code><span class="sig-paren">(</span><em class="sig-param">boundary_expfactor</em>, <em class="sig-param">kmax=10.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.reps_boundary_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.reps_boundary_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and store the boundary conditions used by reps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boundary_expfactor</strong> (<em>float</em>) – The desired expansion factor</p></li>
<li><p><strong>kmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavelength considered, defaults to config[‘pk’][‘ktransition’]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.reps_growth">
<code class="sig-name descname">reps_growth</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">k=None</em>, <em class="sig-param">betab=None</em>, <em class="sig-param">betan=None</em>, <em class="sig-param">fzib=None</em>, <em class="sig-param">fzic=None</em>, <em class="sig-param">fzin=None</em>, <em class="sig-param">boundary_expfactor=0.02</em>, <em class="sig-param">kmax=10.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.reps_growth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.reps_growth" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to call reps.</p>
<p>This function calls reps to create a table of scal dependent growth factors
and growth rates at a number of expansion factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factors</p></li>
<li><p><strong>k</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The desired wavemodes in <span class="math notranslate nohighlight">\(h \mathrm{Mpc}^{-1}\)</span>, defaults to None</p></li>
<li><p><strong>betab</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The baryon to cdm fraction, defaults to None</p></li>
<li><p><strong>betan</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The neutrino to cdm fraction, defaults to None</p></li>
<li><p><strong>fzib</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The baryon growth rate at the time corresponding to the
boundary conditions, defaults to None</p></li>
<li><p><strong>fzic</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The cdm growth rate at the time corresponding to the
boundary conditions, defaults to None, defaults to None</p></li>
<li><p><strong>fzin</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The neutrino growth rate at the time corresponding to the
boundary conditions, defaults to None</p></li>
<li><p><strong>boundary_expfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – The expansion factor of the boundary
conditions, defaults to 0.02</p></li>
<li><p><strong>kmax</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The maximum wavemode considered, defaults to config[‘pk’][‘ktransition’]</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.rho_de">
<code class="sig-name descname">rho_de</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em>, <em class="sig-param">derivative=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.rho_de"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.rho_de" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Time dependent dark energy density normalized :math:<a href="#id25"><span class="problematic" id="id26">`</span></a>Omega_{</p>
</div></blockquote>
<p>m de}(a) / Omega_{
m de,0}`.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param expfactor</dt>
<dd class="field-odd"><p>The desired expfactor(s)</p>
</dd>
<dt class="field-even">type expfactor</dt>
<dd class="field-even"><p>array_like</p>
</dd>
<dt class="field-odd">param derivative</dt>
<dd class="field-odd"><p>By default (False) returns density, otherwise returns the
derivative :math:<a href="#id27"><span class="problematic" id="id28">`</span></a>mathrm{d}Omega_{</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>m de} / mathrm{d} a`,</dt><dd><blockquote>
<div><p>defaults to False</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">type derivative</dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
<dt class="field-even">returns</dt>
<dd class="field-even"><p>Either the normalized dark energy density or its derivative</p>
</dd>
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.rhoback_z">
<code class="sig-name descname">rhoback_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.rhoback_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.rhoback_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the background density in units of <span class="math notranslate nohighlight">\(10^{10} M_\odot \mathrm{Mpc}^{-3} h^{-2}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The background density in units of <span class="math notranslate nohighlight">\(10^{10} M_\odot \mathrm{Mpc}^{-3} h^{-2}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.rhocrit_z">
<code class="sig-name descname">rhocrit_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.rhocrit_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.rhocrit_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the critical density in units of <span class="math notranslate nohighlight">\(\mathrm{M}_\odot /\mathrm{Mpc}^3 h^2\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The critical density in units of <span class="math notranslate nohighlight">\(\mathrm{M}_\odot /\mathrm{Mpc}^3 h^2\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.set_expfactor">
<code class="sig-name descname">set_expfactor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_expfactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.set_expfactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the expansion factor of this cosmology.</p>
<p>All quantities not explicitly requiring a expansion factor will be evaluated
at the one specified here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>float</em>) – The required expansion factor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.set_initial_growth_expfac">
<code class="sig-name descname">set_initial_growth_expfac</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_initial_growth_expfac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.set_initial_growth_expfac" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the expansion factor used to compute the boundary conditions for reps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>float</em>) – The required expansion factor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.set_par">
<code class="sig-name descname">set_par</code><span class="sig-paren">(</span><em class="sig-param">par=None</em>, <em class="sig-param">value=None</em>, <em class="sig-param">fixed_omega_matter=True</em>, <em class="sig-param">geometry='flat'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_par"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.set_par" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Set a parameter of the cosmology class.</p>
<p>Please note this is the recommended way of changing parameters of a existing cosmology.
Trying to directly access the stored parameters may result in inconsistencies. This
function instead performs all the needed checks, and updates the relevant variables.</p>
<dl class="field-list simple">
<dt class="field-odd">param par</dt>
<dd class="field-odd"><p>The name of the cosmology parameter to update, defaults to None</p>
</dd>
<dt class="field-even">type par</dt>
<dd class="field-even"><p>string, optional</p>
</dd>
<dt class="field-odd">param value</dt>
<dd class="field-odd"><p>The new value for the parameter ‘par’, defaults to None</p>
</dd>
<dt class="field-even">type value</dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">param fixed_omega_matter</dt>
<dd class="field-odd"><p>Whether to keep the value of
:math:<a href="#id29"><span class="problematic" id="id30">`</span></a>Omega_{</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>m m}` unchanged, defaults to True</dt><dd><dl class="field-list simple">
<dt class="field-odd">type fixed_omega_matter</dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
<dt class="field-even">param geometry</dt>
<dd class="field-even"><p>If ‘flat’, ensures that after changes to the values of the density
parameters, they still sum to 1, defaults to ‘flat’</p>
</dd>
<dt class="field-odd">type geometry</dt>
<dd class="field-odd"><p>string, optional</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="o">**</span><span class="n">bacco</span><span class="o">.</span><span class="n">cosmo_parameters</span><span class="o">.</span><span class="n">nenya</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">omega_cdm_z</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">... </span><span class="mf">0.265</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;omega_cdm&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">omega_cdm_z</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">... </span><span class="mf">0.8</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.set_rescaling">
<code class="sig-name descname">set_rescaling</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.set_rescaling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.set_rescaling" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the rescaling parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> – The dictionary of the rescaling parameters as returned
by <a class="reference internal" href="code.html#bacco.Scaler.runmin" title="bacco.Scaler.runmin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bacco.Scaler.runmin()</span></code></a>.</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="o">**</span><span class="n">bacco</span><span class="o">.</span><span class="n">cosmo_parameters</span><span class="o">.</span><span class="n">nenya</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="o">**</span><span class="n">bacco</span><span class="o">.</span><span class="n">cosmo_parameters</span><span class="o">.</span><span class="n">narya</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Scaler</span><span class="p">(</span><span class="n">original_cosmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">runmin</span><span class="p">(</span><span class="n">target_cosmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">original_cosmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_cosmo</span><span class="o">.</span><span class="n">set_rescaling</span><span class="p">(</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">])</span> <span class="c1"># now it should look like target</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="bacco.cosmology.Cosmology.sigma8">
<code class="sig-name descname">sigma8</code><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.sigma8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.sigma8" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(sigma_8(z=0)\)</span> (cached)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">bacco</span><span class="o">.</span><span class="n">Cosmology</span><span class="p">(</span><span class="n">A_s</span><span class="o">=</span><span class="mf">2.23677e-9</span><span class="p">,</span> <span class="n">sigma8</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cosmo</span><span class="o">.</span><span class="n">sigma8</span><span class="p">)</span>
<span class="gp">... </span><span class="mf">0.8</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.sigma8_z">
<code class="sig-name descname">sigma8_z</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.sigma8_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.sigma8_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear amplitude of fluctuations smoothed on a scale <span class="math notranslate nohighlight">\(R=8 h^{-1} \mathrm{Mpc}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.time_to_present">
<code class="sig-name descname">time_to_present</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.time_to_present"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.time_to_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute time from elapsed from goven expansion factor present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expfactor(s)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Elapsed time in internal units</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.cosmology.Cosmology.vel_factor">
<code class="sig-name descname">vel_factor</code><span class="sig-paren">(</span><em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/cosmology.html#Cosmology.vel_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.cosmology.Cosmology.vel_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the multiplicative factor <span class="math notranslate nohighlight">\(D_v: v(q) = D_v \Psi(q)\)</span>, where
<span class="math notranslate nohighlight">\(\Psi\)</span> is the displacemnt field</p>
<p>In case of scaling with massive neutrinos:
growthrate will be taken by default at <span class="math notranslate nohighlight">\(k = 0.5 h/\mathrm{Mpc}\)</span>. This is fine
as long as this correction is applied to scales below the free streaming scale,
while for larger scales the matching of velocities is taken care of by the
large scale correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expfactor</strong> (<em>array_like</em>) – The desired expansion factor(s)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array_like</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.decorators">
<span id="bacco-decorators-module"></span><h2>bacco.decorators module<a class="headerlink" href="#module-bacco.decorators" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bacco.decorators.h5cache">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5cache</code><span class="sig-paren">(</span><em class="sig-param">_func=None</em>, <em class="sig-param">file=None</em>, <em class="sig-param">ignoreargs=()</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5cache" title="Permalink to this definition">¶</a></dt>
<dd><p>This a decorator, use it as &#64;h5cache or &#64;h5cache(file=…, …)
It stores in file the output from the calls of the decorated function
in an hdf5 file. If a call has the same input arguments as a current one
it will return the previous output (so make sure to delete the cache file
if you change the function)</p>
</dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_get_type">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_get_type</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_get_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_get_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_print_file_structure">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_print_file_structure</code><span class="sig-paren">(</span><em class="sig-param">file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_print_file_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_print_file_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_read_any">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_read_any</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_read_any"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_read_any" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_read_dict">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_read_dict</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">datadict=None</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_read_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_read_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>This function can read recursive dicts from hdf5 files</p>
</dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_read_list">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_read_list</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_read_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_read_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_write_any">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_write_any</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">path</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_write_any"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_write_any" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_write_dict">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_write_dict</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">datadict</em>, <em class="sig-param">overwrite=False</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_write_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_write_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>This function can write recursive dicts as hdf5 file</p>
</dd></dl>

<dl class="function">
<dt id="bacco.decorators.h5py_write_list">
<code class="sig-prename descclassname">bacco.decorators.</code><code class="sig-name descname">h5py_write_list</code><span class="sig-paren">(</span><em class="sig-param">file</em>, <em class="sig-param">path</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/decorators.html#h5py_write_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.decorators.h5py_write_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="bacco-deltaz-shotnoise-module">
<h2>bacco.deltaz_shotnoise module<a class="headerlink" href="#bacco-deltaz-shotnoise-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-bacco.fisher">
<span id="bacco-fisher-module"></span><h2>bacco.fisher module<a class="headerlink" href="#module-bacco.fisher" title="Permalink to this headline">¶</a></h2>
<p>A collection of functions to compute fisher matrices for multiple probes
Started by Louis Legrand on December 3rd 2018.</p>
<dl class="function">
<dt id="bacco.fisher.complete_formatter">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">complete_formatter</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#complete_formatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.complete_formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Format more similar to the default one</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.compute_fisher">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">compute_fisher</code><span class="sig-paren">(</span><em class="sig-param">pars=None</em>, <em class="sig-param">h_pars=None</em>, <em class="sig-param">cosmo_pars=None</em>, <em class="sig-param">baryon_pars={}</em>, <em class="sig-param">basedir=None</em>, <em class="sig-param">paired=True</em>, <em class="sig-param">invcovmat=None</em>, <em class="sig-param">sim_dm_file=None</em>, <em class="sig-param">sim_halo_file=None</em>, <em class="sig-param">A_s=None</em>, <em class="sig-param">theory='sim'</em>, <em class="sig-param">theory_att='pk'</em>, <em class="sig-param">stat='sdmPower'</em>, <em class="sig-param">x=None</em>, <em class="sig-param">xmax=100</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">bias=1.0</em>, <em class="sig-param">multipole_l=0</em>, <em class="sig-param">derive_pmulti=False</em>, <em class="sig-param">derivs=None</em>, <em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#compute_fisher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.compute_fisher" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that compute the Fisher Matrix of a simulation given statistics.
pars: a list of the parameters to be included in the fisher.
h_pars: finite increments (if None it uses the default values of sim/cosmo_derivatives)
cosmo_pars: dictionary with the fiducial cosmological parameters
baryon_pars: dictionary with the fiducial baryons parameters
basedir: basedir of the simulation
paired: whether the simulation is paired or not
incovmat: inverse of the covariance matrix
sim_dm_file: path of the simulation dm_file
sim_halo_file: path of the simulation halo_file
A_s: A_s of the simulation.
theory: ‘prediction’, ‘sim’
theory_att: if theory is ‘sim’:</p>
<blockquote>
<div><p>‘’pk’,’pk_theory_lin’, ‘pk_theory_nl’</p>
</div></blockquote>
<dl class="simple">
<dt>stat:</dt><dd><dl class="simple">
<dt>if theory is ‘prediction’:</dt><dd><p>‘powerspec’, ‘nlpowerspec’, ‘zpowerspec’, ‘correlationfunction’,
‘nlcorrelationfunction’, ‘zcorrelationfunction’, ‘halomassfunction’</p>
</dd>
<dt>if theory is ‘sim’:</dt><dd><p>any simulation class attribute (like Power, sdmPower, etc…)</p>
</dd>
</dl>
</dd>
</dl>
<p>x: the x axis used if theory is ‘sim’ (must correspond to cov matrix bins)
xmax: maximum scale considered in the fisher analysis
derivs: dictionary contatining derivatives. If None, they are calculated from scratch.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.compute_shotnoise_Ndzdz">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">compute_shotnoise_Ndzdz</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">z_obs</em>, <em class="sig-param">sigma_z</em>, <em class="sig-param">parfid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#compute_shotnoise_Ndzdz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.compute_shotnoise_Ndzdz" title="Permalink to this definition">¶</a></dt>
<dd><p>Test to compute the shot noise analitically with error propagation formulae.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.create_dir">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">create_dir</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#create_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.create_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.fisher.figure_of_merit">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">figure_of_merit</code><span class="sig-paren">(</span><em class="sig-param">fishermat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#figure_of_merit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.figure_of_merit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Figure of Merit, which is defined as the inverse area of the
95% confidence limit of the ellipsis. It is given as the (detF)^(1/2).
See Amendola notes (Statistical methods) on fisher matrix p.42
<a class="reference external" href="http://www.thphys.uni-heidelberg.de/~amendola/teaching.html">http://www.thphys.uni-heidelberg.de/~amendola/teaching.html</a>
fihsermat: 2x2 numpy array, must have been marginalized if you have more than two parameters</p>
<blockquote>
<div><p>varied.</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.fishermatrix">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">fishermatrix</code><span class="sig-paren">(</span><em class="sig-param">parfid</em>, <em class="sig-param">varying_params</em>, <em class="sig-param">invcovmat</em>, <em class="sig-param">cl_keys</em>, <em class="sig-param">xx</em>, <em class="sig-param">jl</em>, <em class="sig-param">xx_d</em>, <em class="sig-param">djl_dx</em>, <em class="sig-param">eps=0.01</em>, <em class="sig-param">do_parallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#fishermatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.fishermatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Fisher matrix for a given cosmology,
varying several cosmological parameters.</p>
<p>parfid = dictionary of fiducial values for parameters
varying_params = list of cosmological parameters to vary
incovmat = covariance matrix</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.get_all_cl">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">get_all_cl</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">probes</em>, <em class="sig-param">do_tomography</em>, <em class="sig-param">z_tomo</em>, <em class="sig-param">probe_key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#get_all_cl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.get_all_cl" title="Permalink to this definition">¶</a></dt>
<dd><p>Load all Cl, auto and cross, from the objet of class Cl,
using all the probes and all the tomographic bins.
I do not compute spectra for dz and dg restricted to density or velocity.</p>
<p>Cl: object of class Cl which has been initialised
probes: from the parfid dictionnary
do_tomography: boolean from the parfid
z_tomo: list of tomo central redshift from parfid
probe_key: ‘tot’, ‘dens’ or ‘vlos’ if you want to restrict to only one contribution of the Cl</p>
<p>probelist: list of probes including the tomographic ones.
cl_keys: sorted list of the Cl computed
The Cl auto and cross between all bins are saved in the Cl.Cls dictionary and
can be acces with the key probe1+’-‘+probe2.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.get_survey">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">get_survey</code><span class="sig-paren">(</span><em class="sig-param">gal_survey</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#get_survey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.get_survey" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the specifications of the galaxy survey.
For now it only defines the euclid_wide survey.
Returns a dictionnary containing the area, fsky and ngal in astropy units.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.incov_tot">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">incov_tot</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">probelist</em>, <em class="sig-param">cosmo_fid</em>, <em class="sig-param">survey_param</em>, <em class="sig-param">parfid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#incov_tot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.incov_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total inverse covariance matrix depending on the Cl asked in probelist.</p>
<dl class="simple">
<dt>invcovmat: The covariance matrix between all Cls, in alphabetical order.</dt><dd><p>the matrix is of shape (ncl*nl, ncl*nl), with ncl the number of Cls and nl the number of
multipole l where the Cls are evaluated.</p>
</dd>
</dl>
<p>Warning: Operations done here on the Cl object will modify the object passed in argument,
for instance it will add noises. This is because python does not create an intern copy of the
object inside the function, it uses it as a kind of ‘global’ variable.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.load_N0_kk">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">load_N0_kk</code><span class="sig-paren">(</span><em class="sig-param">parfid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#load_N0_kk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.load_N0_kk" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the previously computed convergence fiels N0 bias, depending on the experiment
computed with the script CMBLensingN0bias.py.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.load_Ndzdz">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">load_Ndzdz</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">Ndzdz_estimator</em>, <em class="sig-param">z_obs</em>, <em class="sig-param">sigma_z</em>, <em class="sig-param">parfid</em>, <em class="sig-param">cosmo_fid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#load_Ndzdz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.load_Ndzdz" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose between estimators from cola mocks or from the scripts/deltaz_shotnoise.py script</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.load_cola_Ndzdz">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">load_cola_Ndzdz</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">z_obs</em>, <em class="sig-param">sigma_z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#load_cola_Ndzdz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.load_cola_Ndzdz" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the Ndzdz taken from the 100 COLA simulations.
It is obtained as a uniform random displacement of the angular position of galaxies in the
lightcone, keeping theri redshift and velocities.</p>
<p>Ndzdz is proportional to sigmaz^2 / ar{n}_{ang}, so we correct for this dependence.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.load_shotnoise_Ndzdz">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">load_shotnoise_Ndzdz</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">z_obs</em>, <em class="sig-param">sigma_z</em>, <em class="sig-param">parfid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#load_shotnoise_Ndzdz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.load_shotnoise_Ndzdz" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the shot nosie from the scripts/deltaz_shotnoise.py script.</p>
</dd></dl>

<dl class="data">
<dt id="bacco.fisher.logger">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">logger</code><em class="property"> = &lt;Logger bacco.fisher (INFO)&gt;</em><a class="headerlink" href="#bacco.fisher.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>General functions</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.my_formatter">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">my_formatter</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#my_formatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.my_formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Format 1 as 1, 0 as 0, and all values whose absolute values is between
0 and 1 without the leading “0.” (e.g., 0.7 is formatted as .7 and -0.4 is
formatted as -.4).</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.numerical_deriv">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">numerical_deriv</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">parfid</em>, <em class="sig-param">param_key</em>, <em class="sig-param">cl_keys</em>, <em class="sig-param">xx</em>, <em class="sig-param">jl</em>, <em class="sig-param">xx_d</em>, <em class="sig-param">djl_dx</em>, <em class="sig-param">eps=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#numerical_deriv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.numerical_deriv" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerical derivation of the Cl data vector around fiducial value.</p>
<p>parfid : dictionnary with fiducail parameter values
param_key : parameter key on which we want to compute the derivative
cl_keys: contain the names of the power spectra used for the fisher analysis,</p>
<blockquote>
<div><p>it is the ouput of the get_all_cl()</p>
</div></blockquote>
<p>eps : displacement (in percent) to compute the numerical derivatives</p>
<p>deriv: 1D vector of size nl * ncl which contains the derivatives of all the Cl put together.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.plot_confidence">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">plot_confidence</code><span class="sig-paren">(</span><em class="sig-param">fishermat</em>, <em class="sig-param">varying_params</em>, <em class="sig-param">parfid</em>, <em class="sig-param">cl_keys</em>, <em class="sig-param">probelist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#plot_confidence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.plot_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the ellipsis of the confidence levels of each 2x2 variations of the fishermatrix.
Perform the marginalization if there is more than two parameters.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.plot_correlation_matrix">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">plot_correlation_matrix</code><span class="sig-paren">(</span><em class="sig-param">covmat</em>, <em class="sig-param">Cl_fid</em>, <em class="sig-param">parfid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#plot_correlation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.plot_correlation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the correlation matrix from the covariance matrix.
Correlation is the diagonal normalized version of the covariance matrix.
Corr((xi, xj) = Cov(xi, xj) / sqrt(Cov(xi, xi) * Cov(xj, xj))</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.plot_ellipse">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">plot_ellipse</code><span class="sig-paren">(</span><em class="sig-param">semimaj=1</em>, <em class="sig-param">semimin=1</em>, <em class="sig-param">phi=0</em>, <em class="sig-param">x_cent=0</em>, <em class="sig-param">y_cent=0</em>, <em class="sig-param">theta_num=1000.0</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">plot_kwargs=None</em>, <em class="sig-param">fill=False</em>, <em class="sig-param">fill_kwargs=None</em>, <em class="sig-param">data_out=False</em>, <em class="sig-param">cov=None</em>, <em class="sig-param">mass_level=0.68</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#plot_ellipse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.plot_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>An easy to use function for plotting ellipses in Python 2.7!
Taken from <a class="reference external" href="https://casper.ssl.berkeley.edu/astrobaki/index.php/Plotting_Ellipses_in_Python">https://casper.ssl.berkeley.edu/astrobaki/index.php/Plotting_Ellipses_in_Python</a>
The function creates a 2D ellipse in polar coordinates then transforms to cartesian coordinates.
It can take a covariance matrix and plot contours from it.
semimaj : float</p>
<blockquote>
<div><p>length of semimajor axis (always taken to be some phi (-90&lt;phi&lt;90 deg) from positive x-axis!)</p>
</div></blockquote>
<dl class="simple">
<dt>semimin<span class="classifier">float</span></dt><dd><p>length of semiminor axis</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>angle in radians of semimajor axis above positive x axis</p>
</dd>
<dt>x_cent<span class="classifier">float</span></dt><dd><p>X coordinate center</p>
</dd>
<dt>y_cent<span class="classifier">float</span></dt><dd><p>Y coordinate center</p>
</dd>
<dt>theta_num<span class="classifier">int</span></dt><dd><p>Number of points to sample along ellipse from 0-2pi</p>
</dd>
<dt>ax<span class="classifier">matplotlib axis property</span></dt><dd><p>A pre-created matplotlib axis</p>
</dd>
<dt>plot_kwargs<span class="classifier">dictionary</span></dt><dd><p>matplotlib.plot() keyword arguments</p>
</dd>
<dt>fill<span class="classifier">bool</span></dt><dd><p>A flag to fill the inside of the ellipse</p>
</dd>
<dt>fill_kwargs<span class="classifier">dictionary</span></dt><dd><p>Keyword arguments for matplotlib.fill()</p>
</dd>
<dt>data_out<span class="classifier">bool</span></dt><dd><p>A flag to return the ellipse samples without plotting</p>
</dd>
<dt>cov<span class="classifier">ndarray of shape (2,2)</span></dt><dd><p>A 2x2 covariance matrix, if given this will overwrite semimaj, semimin and phi</p>
</dd>
<dt>mass_level<span class="classifier">float</span></dt><dd><p>if supplied cov, mass_level is the contour defining fractional probability mass enclosed
for example: mass_level = 0.68 is the standard 68% mass</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.plot_fisher">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">plot_fisher</code><span class="sig-paren">(</span><em class="sig-param">invfishermat, pars, fiducial_params, params_names, params_bounds=None, ax=None, init_ax=True, tick_formatter=None, plot_kwargs=None, mass_levels=[0.997, 0.954, 0.683], plot_log=None, normalise={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#plot_fisher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.plot_fisher" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the ellipsis of the confidence levels of each 2x2 variations of the fishermatrix.
Perform the marginalization if there is more than two parameters.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.plot_several_fisher">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">plot_several_fisher</code><span class="sig-paren">(</span><em class="sig-param">fishers</em>, <em class="sig-param">varying_params</em>, <em class="sig-param">parfids</em>, <em class="sig-param">probelists</em>, <em class="sig-param">partest_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#plot_several_fisher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.plot_several_fisher" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot sevral fisher matrices on the same plot.
By default it gives the 68,3% confidence limits, you can change that in the argument
mass_level of the function plot_ellipse.</p>
<dl class="simple">
<dt>fishers: array of shape (nfish, nparam, nparam), with nfish the number of fisher matrices</dt><dd><p>and nparam the number of params varied.</p>
</dd>
</dl>
<p>parfid: list of fiducial parameters
probelists: lists of probes for each fishermatrix.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.plot_windows">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">plot_windows</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">Cl</em>, <em class="sig-param">parfid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#plot_windows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.plot_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the dndz and the gaussian windows</p>
</dd></dl>

<dl class="function">
<dt id="bacco.fisher.shotnoise_from_pk">
<code class="sig-prename descclassname">bacco.fisher.</code><code class="sig-name descname">shotnoise_from_pk</code><span class="sig-paren">(</span><em class="sig-param">Cl</em>, <em class="sig-param">z_obs</em>, <em class="sig-param">sigma_z</em>, <em class="sig-param">parfid</em>, <em class="sig-param">cosmo_fid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/fisher.html#shotnoise_from_pk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.fisher.shotnoise_from_pk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the shot noise of the probes by replacing the P(k) by  1/ngal</p>
</dd></dl>

</div>
<div class="section" id="module-bacco.halo">
<span id="bacco-halo-module"></span><h2>bacco.halo module<a class="headerlink" href="#module-bacco.halo" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Halo’ class and helper functions</p>
<dl class="class">
<dt id="bacco.halo.Halo">
<em class="property">class </em><code class="sig-prename descclassname">bacco.halo.</code><code class="sig-name descname">Halo</code><span class="sig-paren">(</span><em class="sig-param">r_200=None</em>, <em class="sig-param">M_200=None</em>, <em class="sig-param">concentration=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/halo.html#Halo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.halo.Halo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that implements the dark matter halo object and its attributes and helping functions.</p>
<dl class="method">
<dt id="bacco.halo.Halo.set_M200">
<code class="sig-name descname">set_M200</code><span class="sig-paren">(</span><em class="sig-param">M_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/halo.html#Halo.set_M200"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.halo.Halo.set_M200" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.halo.Halo.set_r200">
<code class="sig-name descname">set_r200</code><span class="sig-paren">(</span><em class="sig-param">r_200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/halo.html#Halo.set_r200"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.halo.Halo.set_r200" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.lightcone">
<span id="bacco-lightcone-module"></span><h2>bacco.lightcone module<a class="headerlink" href="#module-bacco.lightcone" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Lightcone’ class and helper functions</p>
<dl class="class">
<dt id="bacco.lightcone.Lightcone">
<em class="property">class </em><code class="sig-prename descclassname">bacco.lightcone.</code><code class="sig-name descname">Lightcone</code><span class="sig-paren">(</span><em class="sig-param">bdir=None, zmax=2.0, field=[5, 5], dm_file=None, halo_file=None, scaled_sim=False, verbose=None, **scaling_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/lightcone.html#Lightcone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.lightcone.Lightcone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that build a lightcone starting from a N-body simulation.</p>
<p>The lightcone is built stacking different snapshots of a simuulation along a given
direction.</p>
<p>——input———
bdir: string, base directory of the Nbody simulation.
zmax: float,  maximum redshift up to which the lightcone is built.
field: tuple with two elements, field of view of the lightcone in degrees.
scaled_sim: bool, whether or not to scale the simulation.
scaling_kwargs: kwargs to pass to the class ScaledSimulation.</p>
<p>—–output——
a lightcone object</p>
<dl class="method">
<dt id="bacco.lightcone.Lightcone.plot_lightcone">
<code class="sig-name descname">plot_lightcone</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">show=True</em>, <em class="sig-param">subsample=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/lightcone.html#Lightcone.plot_lightcone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.lightcone.Lightcone.plot_lightcone" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that produces an interactive 3D plot of the lightcone.
Parameters:
filename: string, path of the file in case you want to save the image.
show: bool, wheter or not to show the plot
subsample: float, fraction of object displayed, default 100%.
Warning: using lightcone with many particles can be very slow.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.lightcone.Lightcone.vis_lightcone">
<code class="sig-name descname">vis_lightcone</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">npix=(256</em>, <em class="sig-param">256)</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/lightcone.html#Lightcone.vis_lightcone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.lightcone.Lightcone.vis_lightcone" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that uses the Visualization Class to make an image of the lightcone.
Parameters:
filename: string, path of the file in case you want to save the image.
npix: tuple, resolution of the pictures in number of pixels
kwargs: other arguments to be passed to the function set_ortho_projection of the Class Visualization</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.mock">
<span id="bacco-mock-module"></span><h2>bacco.mock module<a class="headerlink" href="#module-bacco.mock" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Mocks’ class and helper functions</p>
<dl class="function">
<dt id="bacco.mock.Fitting_Centrals">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">Fitting_Centrals</code><span class="sig-paren">(</span><em class="sig-param">Xt</em>, <em class="sig-param">Yt</em>, <em class="sig-param">NHalo</em>, <em class="sig-param">NHalo_Lim=10</em>, <em class="sig-param">Ngal_Lim=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Fitting_Centrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Fitting_Centrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a HOD profile using the 5-parameter form of the HOD (Central part, Zheng+2005, Contreras+2013)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xt</strong> (<em>array</em>) – Halo mass, in unites of log10(Mh/Msun/h)</p></li>
<li><p><strong>Yt</strong> (<em>array</em>) – Average abundance of satellites per halo &lt;Ncen&gt;</p></li>
<li><p><strong>NHalo</strong> (<em>array</em>) – Minimum halo mass, in units of log(M/Msun}) #TODO CHECK h FACTOR</p></li>
<li><p><strong>NHalo_Lim</strong> (<em>float</em>) – Limit in NHalo for the fitting</p></li>
<li><p><strong>Ngal_Lim</strong> (<em>float</em>) – Limit of Ngal for the fitting</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[log_Mmin, sigmaLogM], [log_M1_err, log_Mcut_err, alpha_err</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.Fitting_Satellites">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">Fitting_Satellites</code><span class="sig-paren">(</span><em class="sig-param">Xt</em>, <em class="sig-param">Yt</em>, <em class="sig-param">NHalo</em>, <em class="sig-param">NHalo_Lim=10</em>, <em class="sig-param">Ngal_Lim=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Fitting_Satellites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Fitting_Satellites" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a HOD profile using the 5-parameter form of the HOD (Satellite part, Zheng+2005, Contreras+2013)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xt</strong> (<em>array</em>) – Halo mass, in unites of log10(Mh/Msun/h)</p></li>
<li><p><strong>Yt</strong> (<em>array</em>) – Average abundance of satellites per halo &lt;Nsat&gt;</p></li>
<li><p><strong>NHalo</strong> (<em>array</em>) – Minimum halo mass, in units of log(M/Msun}) #TODO CHECK h FACTOR</p></li>
<li><p><strong>NHalo_Lim</strong> (<em>float</em>) – Limit in NHalo for the fitting</p></li>
<li><p><strong>Ngal_Lim</strong> (<em>float</em>) – Limit of Ngal for the fitting</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[log_M1, log_Mcut, alpha], [log_M1_err, log_Mcut_err, alpha_err]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.HOD_Calculate_CenSat">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">HOD_Calculate_CenSat</code><span class="sig-paren">(</span><em class="sig-param">Mh</em>, <em class="sig-param">Mmin</em>, <em class="sig-param">sigmaLogM</em>, <em class="sig-param">M1</em>, <em class="sig-param">Mcut</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#HOD_Calculate_CenSat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.HOD_Calculate_CenSat" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, its return the number of centrals and satelite galaxies
per halo for the 5-parameter form of the HOD (Zheng+2005, Contreras+2013)
Its asume a poissonian distribution for the satellite galaxies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mh</strong> (<em>array</em>) – Halo masses, in units of Msun/h</p></li>
<li><p><strong>Mmin</strong> (<em>floats</em>) – HOD 5-Parameter, masses in Msun/h</p></li>
<li><p><strong>sigmaLogM</strong> (<em>floats</em>) – HOD 5-Parameter</p></li>
<li><p><strong>M1</strong> (<em>floats</em>) – HOD 5-Parameter, masses Msun/h</p></li>
<li><p><strong>Mcut</strong> (<em>floats</em>) – HOD 5-Parameter, masses in Msun/h</p></li>
<li><p><strong>alpha</strong> (<em>floats</em>) – HOD 5-Parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of Centrals per halo, Array of Satellites per halo</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.HOD_NCen">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">HOD_NCen</code><span class="sig-paren">(</span><em class="sig-param">Mh</em>, <em class="sig-param">Mmin</em>, <em class="sig-param">sigmaLogM</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#HOD_NCen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.HOD_NCen" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of central galaxies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mh</strong> (<em>array</em>) – Halo masses, in units of Msun/h</p></li>
<li><p><strong>Mmin</strong> (<em>floats</em>) – HOD 5-Parameter, masses in Msun/h</p></li>
<li><p><strong>sigmaLogM</strong> (<em>floats</em>) – HOD 5-Parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of probabilities of having a Centrals per halo</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.HOD_NCen_log">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">HOD_NCen_log</code><span class="sig-paren">(</span><em class="sig-param">log_Mh</em>, <em class="sig-param">log_Mmin</em>, <em class="sig-param">sigmaLogM</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#HOD_NCen_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.HOD_NCen_log" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of central galaxies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mh</strong> (<em>array</em>) – Halo masses, in units of Msun/h</p></li>
<li><p><strong>log_Mmin</strong> (<em>floats</em>) – HOD 5-Parameter, masses in log10(Msun/h)</p></li>
<li><p><strong>sigmaLogM</strong> (<em>floats</em>) – HOD 5-Parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of log probabilities of having a Centrals per halo</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.HOD_NSat">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">HOD_NSat</code><span class="sig-paren">(</span><em class="sig-param">Mh</em>, <em class="sig-param">M1</em>, <em class="sig-param">Mcut</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#HOD_NSat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.HOD_NSat" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of satellite galaxies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mh</strong> (<em>array</em>) – Halo masses, in units of Msun/h</p></li>
<li><p><strong>M1</strong> (<em>floats</em>) – HOD 5-Parameter, masses Msun/h</p></li>
<li><p><strong>Mcut</strong> (<em>floats</em>) – HOD 5-Parameter, masses in Msun/h</p></li>
<li><p><strong>alpha</strong> (<em>floats</em>) – HOD 5-Parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of probabilities of having a Satellites per halo</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.HOD_NSat_log">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">HOD_NSat_log</code><span class="sig-paren">(</span><em class="sig-param">log_Mh</em>, <em class="sig-param">log_M1</em>, <em class="sig-param">log_Mcut</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#HOD_NSat_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.HOD_NSat_log" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of satellite galaxies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mh</strong> (<em>array</em>) – Halo masses, in units of Msun/h</p></li>
<li><p><strong>log_M1</strong> (<em>floats</em>) – HOD 5-Parameter, masses log10(Msun/h)</p></li>
<li><p><strong>log_Mcut</strong> (<em>floats</em>) – HOD 5-Parameter, masses in log10(Msun/h)</p></li>
<li><p><strong>alpha</strong> (<em>floats</em>) – HOD 5-Parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of log probabilities of having a Satellites per halo</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.MF2CMF">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">MF2CMF</code><span class="sig-paren">(</span><em class="sig-param">MF_x</em>, <em class="sig-param">MF_y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#MF2CMF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.MF2CMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from a Mass (luminocity) function format  to a cummulative Mass (luminocity) Function</p>
<p>:param MF_x:x-axis of the mass/lum function
:type MF_x: array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>MF_y</strong> (<em>array</em>) – y-axis of the mass/lum function</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>y-axis of the cummulative mass/lum function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.MassFunction">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">MassFunction</code><span class="sig-paren">(</span><em class="sig-param">log_Ms=10.66</em>, <em class="sig-param">phi1=0.00396</em>, <em class="sig-param">alpha1=-0.35</em>, <em class="sig-param">phi2=0.00079</em>, <em class="sig-param">alpha2=-1.47</em>, <em class="sig-param">h=0.7</em>, <em class="sig-param">logMmin=6</em>, <em class="sig-param">logMmax=14</em>, <em class="sig-param">NBin=161</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#MassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.MassFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the Mass Function (or luminocity function) using a a double Schechter fit.
Default values from Baldry et al. 2012, Fig. 13, converted to be with the h factor
CAREFULL: X-axis is in LogScale log(M/M_{h^{-1}odot})</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_Ms</strong> (<em>float</em>) – double Schechter fit parameters</p></li>
<li><p><strong>phi1</strong> (<em>float</em>) – double Schechter fit parameters</p></li>
<li><p><strong>alpha1</strong> (<em>float</em>) – double Schechter fit parameters</p></li>
<li><p><strong>phi2</strong> (<em>float</em>) – double Schechter fit parameters</p></li>
<li><p><strong>alpha2</strong> (<em>float</em>) – double Schechter fit parameters</p></li>
<li><p><strong>h</strong> (<em>float</em>) – hubble parameter</p></li>
<li><p><strong>logMmin</strong> (<em>float</em>) – Minimum halo mass, in units of log(M/Msun}) #TODO CHECK h FACTOR</p></li>
<li><p><strong>logMmax</strong> (<em>float</em>) – Maximum halo mass, in units of log(M/Msun}) #TODO CHECK h FACTOR</p></li>
<li><p><strong>NBin</strong> (<em>int</em>) – Number of bins</p></li>
</ul>
</dd>
</dl>
<p>:returns:array of halo mass &amp;  array of abundances
:rtype: array</p>
</dd></dl>

<dl class="class">
<dt id="bacco.mock.Mock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">Mock</code><span class="sig-paren">(</span><em class="sig-param">Sim=None</em>, <em class="sig-param">TypeOfMock='HOD'</em>, <em class="sig-param">halo_vdisp=None</em>, <em class="sig-param">Mmin=316227766016.83795</em>, <em class="sig-param">sigmaLogM=0.5</em>, <em class="sig-param">M1=1000000000000.0</em>, <em class="sig-param">Mcut=316227766016.83795</em>, <em class="sig-param">alpha=1</em>, <em class="sig-param">alpha_c=0</em>, <em class="sig-param">alpha_s=0</em>, <em class="sig-param">sigma_Mstell=0.2</em>, <em class="sig-param">SHAM_Prop='vpeak'</em>, <em class="sig-param">StellarMassFunction=None</em>, <em class="sig-param">NoOrphans=False</em>, <em class="sig-param">mhalo='halo_m200c'</em>, <em class="sig-param">units_in_kpc=False</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">theory_mass_function=False</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that create mock galaxies from a simulation or a list of haloes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Sim</strong> (<em>class</em>) – Simulation class</p></li>
<li><p><strong>TypeOfMock</strong> (<em>string</em>) – HOD or SHAM</p></li>
<li><p><strong>halo_vdisp</strong> (<em>bool</em>) – Velocity dispersion of the haloes, in case the simulation does not provide it.</p></li>
<li><p><strong>Mmin</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>sigmaLogM</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>M1</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – 5-Parameter HOD</p></li>
<li><p><strong>alpha</strong> – 5-Parameter HOD</p></li>
<li><p><strong>alpha_c</strong> (<em>float</em>) – Velocity bias parameters. alpha_c = 0 means the velocity of the central
galaxy is the same as the center of potential of the halo. alpha_c = 1 means
the velocity of the central is the sum of the velocity of the halo + the velocity dispersion
of the halo</p></li>
<li><p><strong>alpha_s</strong> (<em>float</em>) – Velocity bias parameters. alpha_s = 0 means the velocity of the satellite
galaxy is the same as the center of potential of the halo. alpha_s = 1 means
the velocity of the satellite is the sum of the velocity of the halo + the velocity of                    a dark matter particle relative to the center of potential of the halo</p></li>
<li><p><strong>sigma_Mstell</strong> (<em>float</em>) – Scatter of the SHAM</p></li>
<li><p><strong>SHAM_Prop</strong> (<em>string</em>) – SHAM property (eg. vpeak, vmax, etc)</p></li>
<li><p><strong>StellarMassFunction</strong> (<em>array</em>) – For SHAMs, in a [2,NBin] format,  with Masses in log(M) and Nden in linear scale</p></li>
<li><p><strong>NoOrphans</strong> (<em>bool</em>) – No Orphans, use this for the moment</p></li>
<li><p><strong>mhalo</strong> (<em>string</em>) – Main halo mass type (eg. halo_mfof, halo_m200c)</p></li>
<li><p><strong>units_in_kpc</strong> (<em>bool</em>) – Units of the simulation in kpc</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – Number of threads, only for the HOD</p></li>
<li><p><strong>theory_mass_function</strong> (<em>bool</em>) – Force a halo mass to be universal</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – random seed</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – verbose, if None, use the config verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mock class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="method">
<dt id="bacco.mock.Mock.Prop_n">
<code class="sig-name descname">Prop_n</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">prop='MStell'</em>, <em class="sig-param">Mask=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.Prop_n"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.Prop_n" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum value of a property for a given number density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>float</em>) – Number density</p></li>
<li><p><strong>prop</strong> (<em>string</em>) – Property of the mock class to aplay the number density</p></li>
<li><p><strong>Mask</strong> (<em>array</em>) – Subsample of galaxies to use</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Always usefull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cut in the property for the number density ‘n’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.compute_galaxy_power">
<code class="sig-name descname">compute_galaxy_power</code><span class="sig-paren">(</span><em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_galaxy_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.compute_galaxy_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the power spectrum of the galaxy sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>k and p(k)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.compute_wp">
<code class="sig-name descname">compute_wp</code><span class="sig-paren">(</span><em class="sig-param">pi_max=30</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">log_rmin=None</em>, <em class="sig-param">log_rmax=None</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">n=None</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">recheck_periodic_boundaries=True</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.compute_wp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute wp with halotools or Corrfunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pi_max</strong> (<em>float</em>) – maximum value of pi. For Corrfunc it has to be &lt; box/3</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; wp - value of wp</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.compute_xi">
<code class="sig-name descname">compute_xi</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">recheck_periodic_boundaries=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.compute_xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 2PCF with halotools or Corrfunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi - value of 2PCF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.compute_xi_jackknife">
<code class="sig-name descname">compute_xi_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">n_jn3=5</em>, <em class="sig-param">zsd=False</em>, <em class="sig-param">recheck_periodic_boundaries=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.compute_xi_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 2PCF with halotools or Corrfunc with jackknife errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>jn3</strong> (<em>int</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi - value of 2PCF &amp; error of xi</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.compute_xi_multipoles">
<code class="sig-name descname">compute_xi_multipoles</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01, rmax=150, nbin=50, method='Corrfunc', nthreads=1, SHAM_Cut=-10, SHAM_GalProp='MStell', n=None, order=[0, 2, 4], rbins=None, zsd=False, recheck_periodic_boundaries=True, verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.compute_xi_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the multipoles of the 2PCF with halotools or Corrfunc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>order</strong> (<em>array</em>) – Array of int, with the order to compute the multipoles (use for now [0,2,4] only, 
monopole, quadrupole and hexadecapole)</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi_ln - value of the multipoles 2PCF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.compute_xi_multipoles_jackknife">
<code class="sig-name descname">compute_xi_multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.01, rmax=150, nbin=50, n_mubin=10, method='Corrfunc', nthreads=1, SHAM_Cut=-10, SHAM_GalProp='MStell', n=None, order=[0, 2, 4], rbins=None, n_jn3=5, zsd=False, recheck_periodic_boundaries=True, verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.compute_xi_multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.compute_xi_multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the multipoles of the 2PCF with halotools or Corrfunc with jackknife errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins of ‘r’ array</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to compute wp (eg. halotools, Corrfunc)</p></li>
<li><p><strong>nthreads</strong> (<em>int</em>) – number of threads</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>float</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>order</strong> (<em>array</em>) – Array of int, with the order to compute the multipoles (use for now [0,2,4] only, 
monopole, quadrupole and hexadecapole)</p></li>
<li><p><strong>rbins</strong> (<em>array</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins.</p></li>
<li><p><strong>jn3</strong> (<em>int</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3.</p></li>
<li><p><strong>recheck_periodic_boundaries</strong> (<em>bool</em>) – force check periodic boundaries, usefull when working with Corrfunc</p></li>
<li><p><strong>zsd</strong> (<em>bool</em>) – If redshift space distortion effect need to be added to the positions</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – old powerfull verbose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rbins_mid - middle points of the ‘r’ bins &amp; xi - value of the multipoles of the 2PCF and jn errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.hod">
<code class="sig-name descname">hod</code><span class="sig-paren">(</span><em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">NBin=50</em>, <em class="sig-param">SHAM_Cut=None</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em>, <em class="sig-param">HODfit=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.hod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.hod" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the HOD of a mock</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LogMmin</strong> (<em>float</em>) – log10 of the Minimum halo mass of the HOD</p></li>
<li><p><strong>LogMmax</strong> (<em>float</em>) – Log10 of the Maximum halo mass of the HOD</p></li>
<li><p><strong>NBin</strong> (<em>int</em>) – Number of bins of the HOD</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>string</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>HODfit</strong> (<em>array</em>) – Fit the HOD and get the fitting parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HOD - Halo mass and average halo occupation &amp; fit - (if HODfit == True) The HOD parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.hod_fit">
<code class="sig-name descname">hod_fit</code><span class="sig-paren">(</span><em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">NBin=50</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">HOD_mock=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.hod_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.hod_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a HOD to a mock class, or a hod funtion (see function above)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LogMmin</strong> (<em>float</em>) – log10 of the Minimum halo mass of the HOD</p></li>
<li><p><strong>LogMmax</strong> (<em>float</em>) – Log10 of the Maximum halo mass of the HOD</p></li>
<li><p><strong>NBin</strong> (<em>int</em>) – Number of bins of the HOD</p></li>
<li><p><strong>SHAM_GalProp</strong> (<em>string</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
<li><p><strong>HOD_mock</strong> (<em>dictionary</em>) – dictionary with the mass, number of centrals and number of satellite of a halo array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>5-Parameter fit and their errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.sat_fraction">
<code class="sig-name descname">sat_fraction</code><span class="sig-paren">(</span><em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.sat_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.sat_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the satellite fraction of a mock. For an HOD it will use the full sample and for a SHAM only a subsample</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SHAM_GalProp</strong> (<em>string</em>) – SHAM propery (eg. Stellar mass) to select the galaxies</p></li>
<li><p><strong>SHAM_Cut</strong> (<em>float</em>) – cut in the SHAM propery, not value if ‘n’ is given</p></li>
<li><p><strong>n</strong> (<em>float</em>) – cut in number density based on the SHAM_GalProp</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Satellite Fraction</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.mock.Mock.vdisp">
<code class="sig-name descname">vdisp</code><span class="sig-paren">(</span><em class="sig-param">Sim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#Mock.vdisp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.Mock.vdisp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the velocity dispersion of the haloes in case is not given</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Sim</strong> (<em>class</em>) – Simulation class</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.mock.No_Assembly_Bias_Mock">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">No_Assembly_Bias_Mock</code><span class="sig-paren">(</span><em class="sig-param">Mock</em>, <em class="sig-param">dx=0.1</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">pair=False</em>, <em class="sig-param">scaled=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#No_Assembly_Bias_Mock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.No_Assembly_Bias_Mock" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a full mock sample without GALAXY assembly bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mock</strong> (<em>class</em>) – Mock class object</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – bin lenght in dex of the halomass</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – random seed</p></li>
<li><p><strong>pair</strong> (<em>bool</em>) – True if the mock is pair.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mock class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="bacco.mock.PairedMock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">PairedMock</code><span class="sig-paren">(</span><em class="sig-param">PairedSim=None</em>, <em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that create two mock galaxies from a Pair simulation. For detailles on the input parameter and the functions, check &lt;Mock&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>PairedSim</strong> (<em>class</em>) – Paired Simulation class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PairedMock class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="method">
<dt id="bacco.mock.PairedMock.compute_galaxy_power">
<code class="sig-name descname">compute_galaxy_power</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.compute_galaxy_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.compute_galaxy_power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.compute_wp">
<code class="sig-name descname">compute_wp</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.compute_wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.compute_wp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.compute_xi">
<code class="sig-name descname">compute_xi</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.compute_xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.compute_xi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.compute_xi_jackknife">
<code class="sig-name descname">compute_xi_jackknife</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.compute_xi_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.compute_xi_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.compute_xi_multipoles">
<code class="sig-name descname">compute_xi_multipoles</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.compute_xi_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.compute_xi_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.compute_xi_multipoles_jackknife">
<code class="sig-name descname">compute_xi_multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.compute_xi_multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.compute_xi_multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.hod">
<code class="sig-name descname">hod</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.hod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.hod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.PairedMock.sat_fraction">
<code class="sig-name descname">sat_fraction</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#PairedMock.sat_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.PairedMock.sat_fraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.mock.SHAM_monotonic">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">SHAM_monotonic</code><span class="sig-paren">(</span><em class="sig-param">Psh</em>, <em class="sig-param">SMF_x</em>, <em class="sig-param">SMF_y</em>, <em class="sig-param">Lbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#SHAM_monotonic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.SHAM_monotonic" title="Permalink to this definition">¶</a></dt>
<dd><p>A monotonic SHAM, assumin a 1-1 relation with Psh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Psh</strong> (<em>array</em>) – infall SH mass, infall Vmax, etc</p></li>
<li><p><strong>SMF_x</strong> (<em>array</em>) – x-axis of the stellar mass function, in units of log(M/h^-1 Msun)</p></li>
<li><p><strong>SMF_y</strong> (<em>array</em>) – y-axis of the stellar mass function, in units of Ngal/h^3Mpc^-3/dex</p></li>
<li><p><strong>Lbox</strong> (<em>float</em>) – lenght of the peridic box of the simulation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stellar mass of the mock galaxies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.mock.SHAM_scatter">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">SHAM_scatter</code><span class="sig-paren">(</span><em class="sig-param">Psh</em>, <em class="sig-param">SMF_x</em>, <em class="sig-param">SMF_y</em>, <em class="sig-param">Lbox</em>, <em class="sig-param">sigma=0.2</em>, <em class="sig-param">seed=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#SHAM_scatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.SHAM_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>A SHAM with Scatter, assumin a scatter of sigma over SHAM_monotonic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Psh</strong> (<em>array</em>) – infall SH mass, infall Vmax, etc</p></li>
<li><p><strong>SMF_x</strong> (<em>array</em>) – x-axis of the stellar mass function, in units of log(M/h^-1 Msun)</p></li>
<li><p><strong>SMF_y</strong> (<em>array</em>) – y-axis of the stellar mass function, in units of Ngal/h^3Mpc^-3/dex</p></li>
<li><p><strong>Lbox</strong> (<em>float</em>) – lenght of the peridic box of the simulation</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Scatter of the stellar mass</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stellar mass of the mock galaxies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="bacco.mock.ScaledMock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">ScaledMock</code><span class="sig-paren">(</span><em class="sig-param">ScaledSim=None</em>, <em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that create one or two scale mock galaxies from a Pair or single simulation. For detailles on the input parameter and the functions, check &lt;Mock&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ScaledSim</strong> (<em>class</em>) – Scaled Simulation class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ScaledMock class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="method">
<dt id="bacco.mock.ScaledMock.compute_galaxy_power">
<code class="sig-name descname">compute_galaxy_power</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.compute_galaxy_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.compute_galaxy_power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.compute_wp">
<code class="sig-name descname">compute_wp</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.compute_wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.compute_wp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.compute_xi">
<code class="sig-name descname">compute_xi</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.compute_xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.compute_xi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.compute_xi_jackknife">
<code class="sig-name descname">compute_xi_jackknife</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.compute_xi_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.compute_xi_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.compute_xi_multipoles">
<code class="sig-name descname">compute_xi_multipoles</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.compute_xi_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.compute_xi_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.compute_xi_multipoles_jackknife">
<code class="sig-name descname">compute_xi_multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.compute_xi_multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.compute_xi_multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.hod">
<code class="sig-name descname">hod</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.hod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.hod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock.ScaledMock.sat_fraction">
<code class="sig-name descname">sat_fraction</code><span class="sig-paren">(</span><em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#ScaledMock.sat_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.ScaledMock.sat_fraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.mock.line">
<code class="sig-prename descclassname">bacco.mock.</code><code class="sig-name descname">line</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">x1</em>, <em class="sig-param">x2</em>, <em class="sig-param">y1</em>, <em class="sig-param">y2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock.html#line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock.line" title="Permalink to this definition">¶</a></dt>
<dd><p>Old fashion always usefull, the powerful “Line equation”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – evaluation point</p></li>
<li><p><strong>x1</strong> (<em>float</em>) – x-cordinate of point “1”</p></li>
<li><p><strong>x2</strong> (<em>float</em>) – x-cordinate of point “2”</p></li>
<li><p><strong>y1</strong> (<em>float</em>) – y-cordinate of point “1”</p></li>
<li><p><strong>y2</strong> (<em>float</em>) – y-cordinate of point “2”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>f(x)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-bacco.mock_backup">
<span id="bacco-mock-backup-module"></span><h2>bacco.mock_backup module<a class="headerlink" href="#module-bacco.mock_backup" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Mocks’ class and helper functions</p>
<dl class="function">
<dt id="bacco.mock_backup.EMERGE_parameters2">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">EMERGE_parameters2</code><span class="sig-paren">(</span><em class="sig-param">z=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#EMERGE_parameters2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.EMERGE_parameters2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.Fitting_Centrals">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">Fitting_Centrals</code><span class="sig-paren">(</span><em class="sig-param">Xt</em>, <em class="sig-param">Yt</em>, <em class="sig-param">NHalo</em>, <em class="sig-param">NHalo_Lim=10</em>, <em class="sig-param">Ngal_Lim=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Fitting_Centrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Fitting_Centrals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.Fitting_Satellites">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">Fitting_Satellites</code><span class="sig-paren">(</span><em class="sig-param">Xt</em>, <em class="sig-param">Yt</em>, <em class="sig-param">NHalo</em>, <em class="sig-param">NHalo_Lim=10</em>, <em class="sig-param">Ngal_Lim=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Fitting_Satellites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Fitting_Satellites" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.HOD_Calculate_CenSat">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">HOD_Calculate_CenSat</code><span class="sig-paren">(</span><em class="sig-param">Mh</em>, <em class="sig-param">Mmin</em>, <em class="sig-param">sigmaLogM</em>, <em class="sig-param">M1</em>, <em class="sig-param">Mcut</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#HOD_Calculate_CenSat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.HOD_Calculate_CenSat" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, its return the number of centrals and satelite galaxies
per halo for the 5-parameter form of the HOD (Zheng+2005, Contreras+2013)
Its asume a poissonian distribution for the satellite galaxies</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.HOD_NCen">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">HOD_NCen</code><span class="sig-paren">(</span><em class="sig-param">Mh</em>, <em class="sig-param">Mmin</em>, <em class="sig-param">sigmaLogM</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#HOD_NCen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.HOD_NCen" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of central galaxies</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.HOD_NCen_log">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">HOD_NCen_log</code><span class="sig-paren">(</span><em class="sig-param">log_Mh</em>, <em class="sig-param">log_Mmin</em>, <em class="sig-param">sigmaLogM</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#HOD_NCen_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.HOD_NCen_log" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of central galaxies</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.HOD_NSat">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">HOD_NSat</code><span class="sig-paren">(</span><em class="sig-param">Mh</em>, <em class="sig-param">M1</em>, <em class="sig-param">Mcut</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#HOD_NSat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.HOD_NSat" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of satellites galaxies</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.HOD_NSat_log">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">HOD_NSat_log</code><span class="sig-paren">(</span><em class="sig-param">log_Mh</em>, <em class="sig-param">log_M1</em>, <em class="sig-param">log_Mcut</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#HOD_NSat_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.HOD_NSat_log" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array of halo masses, Mh, its give the mean occupation of satellites galaxies</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.MF2CMF">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">MF2CMF</code><span class="sig-paren">(</span><em class="sig-param">MF_x</em>, <em class="sig-param">MF_y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#MF2CMF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.MF2CMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from a Mass (luminocity) function format (with the X-Axis in Log scale) the an cummulative Mass (luminocity) Function</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.MassFunction">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">MassFunction</code><span class="sig-paren">(</span><em class="sig-param">log_Ms=10.66</em>, <em class="sig-param">phi1=0.00396</em>, <em class="sig-param">alpha1=-0.35</em>, <em class="sig-param">phi2=0.00079</em>, <em class="sig-param">alpha2=-1.47</em>, <em class="sig-param">h=0.7</em>, <em class="sig-param">logMmin=6</em>, <em class="sig-param">logMmax=14</em>, <em class="sig-param">NBin=161</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#MassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.MassFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the Mass Function (or luminocity function) using a a double Schechter fit.
Default values from Baldry et al. 2012, Fig. 13, converted to be with the h factor
CAREFULL: X-axis is in LogScale log(M/M_{h^{-1}odot})</p>
</dd></dl>

<dl class="class">
<dt id="bacco.mock_backup.Mock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">Mock</code><span class="sig-paren">(</span><em class="sig-param">Sim=None</em>, <em class="sig-param">TypeOfMock='HOD'</em>, <em class="sig-param">zsd=True</em>, <em class="sig-param">axis_zsd=2</em>, <em class="sig-param">halo_vdisp=None</em>, <em class="sig-param">Mmin=316227766016.83795</em>, <em class="sig-param">sigmaLogM=0.5</em>, <em class="sig-param">M1=1000000000000.0</em>, <em class="sig-param">Mcut=316227766016.83795</em>, <em class="sig-param">alpha=1</em>, <em class="sig-param">alpha_c=0</em>, <em class="sig-param">alpha_s=0</em>, <em class="sig-param">sigma_Mstell=0.2</em>, <em class="sig-param">SHAM_Prop='vpeak'</em>, <em class="sig-param">StellarMassFunction=None</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">theory_mass_function=False</em>, <em class="sig-param">NoOrphans=False</em>, <em class="sig-param">New_Orphans_a=None</em>, <em class="sig-param">New_Orphans_b=None</em>, <em class="sig-param">units_in_kpc=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that create mock galaxies from a simulation or a list of haloes</p>
<dl class="method">
<dt id="bacco.mock_backup.Mock.Age_Matching">
<code class="sig-name descname">Age_Matching</code><span class="sig-paren">(</span><em class="sig-param">sfr_model='guo2010a'</em>, <em class="sig-param">useType=False</em>, <em class="sig-param">nwin=101</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.Age_Matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.Age_Matching" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.Age_Matching_original">
<code class="sig-name descname">Age_Matching_original</code><span class="sig-paren">(</span><em class="sig-param">sfr_model='guo2010a'</em>, <em class="sig-param">useType=False</em>, <em class="sig-param">nwin=101</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.Age_Matching_original"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.Age_Matching_original" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.CF">
<code class="sig-name descname">CF</code><span class="sig-paren">(</span><em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">rmin=0.01</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">a=None</em>, <em class="sig-param">b=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.CF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.CF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.CF_jackknife">
<code class="sig-name descname">CF_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.CF_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.CF_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.Compute_SFR_EMERGE">
<code class="sig-name descname">Compute_SFR_EMERGE</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.Compute_SFR_EMERGE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.Compute_SFR_EMERGE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.Prop_n">
<code class="sig-name descname">Prop_n</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">prop='MStell'</em>, <em class="sig-param">Mask=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.Prop_n"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.Prop_n" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.SFR_quenching_EMERGE">
<code class="sig-name descname">SFR_quenching_EMERGE</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.SFR_quenching_EMERGE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.SFR_quenching_EMERGE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.galaxy_qdata">
<code class="sig-name descname">galaxy_qdata</code><span class="sig-paren">(</span><em class="sig-param">sim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.galaxy_qdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.galaxy_qdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.get_galaxies_alive">
<code class="sig-name descname">get_galaxies_alive</code><span class="sig-paren">(</span><em class="sig-param">a=1.0</em>, <em class="sig-param">b=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.get_galaxies_alive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.get_galaxies_alive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.hod">
<code class="sig-name descname">hod</code><span class="sig-paren">(</span><em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">NBin=50</em>, <em class="sig-param">SHAM_Cut=None</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">HODfit=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.hod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.hod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.hod_fit">
<code class="sig-name descname">hod_fit</code><span class="sig-paren">(</span><em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">NBin=50</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">HOD_mock=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.hod_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.hod_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.multipoles">
<code class="sig-name descname">multipoles</code><span class="sig-paren">(</span><em class="sig-param">order=[0, 2, 4], rmin=0.1, rmax=150, log_rmin=None, log_rmax=None, nbin=50, method='Corrfunc', random=None, SHAM_Cut=-10, SHAM_GalProp='MStell', n_den=None, seed=None, nthreads=1, rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.multipoles_jackknife">
<code class="sig-name descname">multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.001, rmax=150, nbin=50, n_mubin=10, random=None, method='Corrfunc', n_jn3=3, nthreads=None, order=[0, 2, 4], SHAM_Cut=-10, SHAM_GalProp='MStell', n_den=None, logspace=False, rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.power">
<code class="sig-name descname">power</code><span class="sig-paren">(</span><em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.sat_fraction">
<code class="sig-name descname">sat_fraction</code><span class="sig-paren">(</span><em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.sat_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.sat_fraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.wp">
<code class="sig-name descname">wp</code><span class="sig-paren">(</span><em class="sig-param">pi_max=30</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">log_rmin=None</em>, <em class="sig-param">log_rmax=None</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.wp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.Mock.wp_jackknife">
<code class="sig-name descname">wp_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pi_max=20</em>, <em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock.wp_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock.wp_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.Mock_Cv">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">Mock_Cv</code><span class="sig-paren">(</span><em class="sig-param">Sim</em>, <em class="sig-param">Target_HOD=None</em>, <em class="sig-param">Target_SHAM=None</em>, <em class="sig-param">Nruns=1000</em>, <em class="sig-param">wp_min=-1.0</em>, <em class="sig-param">wp_max=1.0</em>, <em class="sig-param">xi_min=-0.5</em>, <em class="sig-param">xi_max=1.0</em>, <em class="sig-param">xil2_min=1</em>, <em class="sig-param">xil2_max=10</em>, <em class="sig-param">pi_max=10</em>, <em class="sig-param">N_wp=21</em>, <em class="sig-param">N_xi=16</em>, <em class="sig-param">use_wp=True</em>, <em class="sig-param">use_xi_l0=True</em>, <em class="sig-param">use_xi_l2=True</em>, <em class="sig-param">use_xi_l4=False</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">sigma_ng=0.05</em>, <em class="sig-param">zsd=True</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">paired=False</em>, <em class="sig-param">theory_mass_function=False</em>, <em class="sig-param">NoOrphans=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock_Cv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock_Cv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.Mock_Cv_JN">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">Mock_Cv_JN</code><span class="sig-paren">(</span><em class="sig-param">Sim</em>, <em class="sig-param">Target_HOD=None</em>, <em class="sig-param">Target_SHAM=None</em>, <em class="sig-param">wp_min=0.1</em>, <em class="sig-param">wp_max=10.0</em>, <em class="sig-param">xi_min=0.316</em>, <em class="sig-param">xi_max=10</em>, <em class="sig-param">pi_max=10</em>, <em class="sig-param">N_wp=21</em>, <em class="sig-param">N_xi=16</em>, <em class="sig-param">use_wp=True</em>, <em class="sig-param">use_xi_l0=True</em>, <em class="sig-param">use_xi_l2=True</em>, <em class="sig-param">use_xi_l4=False</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">zsd=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#Mock_Cv_JN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.Mock_Cv_JN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.No_Assembly_Bias_Mock">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">No_Assembly_Bias_Mock</code><span class="sig-paren">(</span><em class="sig-param">Mock</em>, <em class="sig-param">dx=0.1</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#No_Assembly_Bias_Mock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.No_Assembly_Bias_Mock" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a full mock sample without GALAXY assembly bias.
dx: the bin size in dex to do the shuffling 
seed: the random seed</p>
</dd></dl>

<dl class="class">
<dt id="bacco.mock_backup.PairMock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">PairMock</code><span class="sig-paren">(</span><em class="sig-param">PairSim=None</em>, <em class="sig-param">TypeOfMock='HOD'</em>, <em class="sig-param">zsd=True</em>, <em class="sig-param">axis_zsd=2</em>, <em class="sig-param">halo_vdisp=None</em>, <em class="sig-param">Mmin=316227766016.83795</em>, <em class="sig-param">sigmaLogM=0.5</em>, <em class="sig-param">M1=1000000000000.0</em>, <em class="sig-param">Mcut=316227766016.83795</em>, <em class="sig-param">alpha=1</em>, <em class="sig-param">alpha_c=0</em>, <em class="sig-param">alpha_s=0</em>, <em class="sig-param">sigma_Mstell=0.2</em>, <em class="sig-param">SHAM_Prop='vpeak'</em>, <em class="sig-param">StellarMassFunction=None</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">theory_mass_function=False</em>, <em class="sig-param">NoOrphans=False</em>, <em class="sig-param">units_in_kpc=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#PairMock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.PairMock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="bacco.mock_backup.PairMock.CF">
<code class="sig-name descname">CF</code><span class="sig-paren">(</span><em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">a=None</em>, <em class="sig-param">b=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#PairMock.CF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.PairMock.CF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.PairMock.CF_jackknife">
<code class="sig-name descname">CF_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#PairMock.CF_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.PairMock.CF_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.PairMock.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#PairMock.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.PairMock.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.PairMock.multipoles">
<code class="sig-name descname">multipoles</code><span class="sig-paren">(</span><em class="sig-param">order=[0, 2, 4], rmin=0.1, rmax=150, log_rmin=None, log_rmax=None, nbin=50, method='Corrfunc', random=None, SHAM_Cut=-10, SHAM_GalProp='MStell', n_den=None, seed=None, nthreads=1, rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#PairMock.multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.PairMock.multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.PairMock.wp">
<code class="sig-name descname">wp</code><span class="sig-paren">(</span><em class="sig-param">pi_max=30</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">log_rmin=None</em>, <em class="sig-param">log_rmax=None</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#PairMock.wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.PairMock.wp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.SHAM_monotonic">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">SHAM_monotonic</code><span class="sig-paren">(</span><em class="sig-param">Psh</em>, <em class="sig-param">SMF_x</em>, <em class="sig-param">SMF_y</em>, <em class="sig-param">Lbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#SHAM_monotonic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.SHAM_monotonic" title="Permalink to this definition">¶</a></dt>
<dd><p>A monotonic SHAM, assumin a 1-1 relation with Psh
Psh -&gt; infall SH mass, infall Vmax, etc</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.SHAM_scatter">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">SHAM_scatter</code><span class="sig-paren">(</span><em class="sig-param">Psh</em>, <em class="sig-param">SMF_x</em>, <em class="sig-param">SMF_y</em>, <em class="sig-param">Lbox</em>, <em class="sig-param">sigma=0.2</em>, <em class="sig-param">seed=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#SHAM_scatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.SHAM_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>A SHAM with Scatter, assumin a scatter of sigma over SHAM_monotonic
Psh -&gt; infall SH mass, infall Vmax, etc</p>
</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.SMF2ASMF">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">SMF2ASMF</code><span class="sig-paren">(</span><em class="sig-param">SMF_x</em>, <em class="sig-param">SMF_y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#SMF2ASMF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.SMF2ASMF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="bacco.mock_backup.ScaledMock">
<em class="property">class </em><code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">ScaledMock</code><span class="sig-paren">(</span><em class="sig-param">ScaledSim=None</em>, <em class="sig-param">TypeOfMock='HOD'</em>, <em class="sig-param">zsd=True</em>, <em class="sig-param">axis_zsd=2</em>, <em class="sig-param">halo_vdisp=None</em>, <em class="sig-param">Mmin=316227766016.83795</em>, <em class="sig-param">sigmaLogM=0.5</em>, <em class="sig-param">M1=1000000000000.0</em>, <em class="sig-param">Mcut=316227766016.83795</em>, <em class="sig-param">alpha=1</em>, <em class="sig-param">alpha_c=0</em>, <em class="sig-param">alpha_s=0</em>, <em class="sig-param">sigma_Mstell=0.2</em>, <em class="sig-param">SHAM_Prop='vpeak'</em>, <em class="sig-param">StellarMassFunction=None</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">paired=True</em>, <em class="sig-param">theory_mass_function=False</em>, <em class="sig-param">NoOrphans=False</em>, <em class="sig-param">units_in_kpc=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#ScaledMock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.ScaledMock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="bacco.mock_backup.ScaledMock.CF">
<code class="sig-name descname">CF</code><span class="sig-paren">(</span><em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">a=None</em>, <em class="sig-param">b=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#ScaledMock.CF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.ScaledMock.CF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.ScaledMock.CF_jackknife">
<code class="sig-name descname">CF_jackknife</code><span class="sig-paren">(</span><em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#ScaledMock.CF_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.ScaledMock.CF_jackknife" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.ScaledMock.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#ScaledMock.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.ScaledMock.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.ScaledMock.multipoles">
<code class="sig-name descname">multipoles</code><span class="sig-paren">(</span><em class="sig-param">order=[0, 2, 4], rmin=0.1, rmax=150, log_rmin=None, log_rmax=None, nbin=50, method='Corrfunc', random=None, SHAM_Cut=-10, SHAM_GalProp='MStell', n_den=None, seed=None, nthreads=1, rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#ScaledMock.multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.ScaledMock.multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.mock_backup.ScaledMock.wp">
<code class="sig-name descname">wp</code><span class="sig-paren">(</span><em class="sig-param">pi_max=30</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">log_rmin=None</em>, <em class="sig-param">log_rmax=None</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">SHAM_Cut=-10</em>, <em class="sig-param">SHAM_GalProp='MStell'</em>, <em class="sig-param">n_den=None</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#ScaledMock.wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.ScaledMock.wp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.epsilonMz">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">epsilonMz</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">z=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#epsilonMz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.epsilonMz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.epsilonMz2">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">epsilonMz2</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">z=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#epsilonMz2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.epsilonMz2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.mock_backup.line">
<code class="sig-prename descclassname">bacco.mock_backup.</code><code class="sig-name descname">line</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">x1</em>, <em class="sig-param">x2</em>, <em class="sig-param">y1</em>, <em class="sig-param">y2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/mock_backup.html#line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.mock_backup.line" title="Permalink to this definition">¶</a></dt>
<dd><p>Line equation</p>
</dd></dl>

</div>
<div class="section" id="module-bacco.plotting">
<span id="bacco-plotting-module"></span><h2>bacco.plotting module<a class="headerlink" href="#module-bacco.plotting" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bacco.plotting.log_lims">
<code class="sig-prename descclassname">bacco.plotting.</code><code class="sig-name descname">log_lims</code><span class="sig-paren">(</span><em class="sig-param">xmin</em>, <em class="sig-param">xmax</em>, <em class="sig-param">mag=1.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/plotting.html#log_lims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.plotting.log_lims" title="Permalink to this definition">¶</a></dt>
<dd><p>It returns limits that are padded with respect to the data by the
magnification factor mag. The padding is equispaced in log scale
at the two ends of the interval.</p>
<p>Input:
xmin: the minimum value of the data
xmax: the maximum value of the data
mag: the magnification of the interval in logsace</p>
<p>Returns: a 2 value list with the new limits</p>
</dd></dl>

<dl class="function">
<dt id="bacco.plotting.plot_diff">
<code class="sig-prename descclassname">bacco.plotting.</code><code class="sig-name descname">plot_diff</code><span class="sig-paren">(</span><em class="sig-param">xdata</em>, <em class="sig-param">ydata</em>, <em class="sig-param">color=None</em>, <em class="sig-param">ls=None</em>, <em class="sig-param">lw=None</em>, <em class="sig-param">labels=None</em>, <em class="sig-param">xlabel=None</em>, <em class="sig-param">ylabel=None</em>, <em class="sig-param">title=None</em>, <em class="sig-param">xlog=False</em>, <em class="sig-param">ylog=False</em>, <em class="sig-param">xlim=None</em>, <em class="sig-param">ylim=None</em>, <em class="sig-param">ylim2=None</em>, <em class="sig-param">interp=False</em>, <em class="sig-param">figsize=None</em>, <em class="sig-param">fig=None</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">use_logticks=False</em>, <em class="sig-param">show_ref=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/plotting.html#plot_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.plotting.plot_diff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.plotting.set_defaults">
<code class="sig-prename descclassname">bacco.plotting.</code><code class="sig-name descname">set_defaults</code><span class="sig-paren">(</span><em class="sig-param">useTex=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/plotting.html#set_defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.plotting.set_defaults" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.plotting.set_logticks">
<code class="sig-prename descclassname">bacco.plotting.</code><code class="sig-name descname">set_logticks</code><span class="sig-paren">(</span><em class="sig-param">AX</em>, <em class="sig-param">axis='xy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/plotting.html#set_logticks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.plotting.set_logticks" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an axes instance (in which at least one of the axes is logarithmic)
and changes its ticklabels so that small powers of 10 are displayed as
floating point numbers.</p>
</dd></dl>

</div>
<div class="section" id="module-bacco.pyfftlog">
<span id="bacco-pyfftlog-module"></span><h2>bacco.pyfftlog module<a class="headerlink" href="#module-bacco.pyfftlog" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pyfftlog-python-version-of-fftlog">
<h3><cite>pyfftlog</cite> – Python version of FFTLog<a class="headerlink" href="#pyfftlog-python-version-of-fftlog" title="Permalink to this headline">¶</a></h3>
<p>This is a Python version of the FFTLog Fortran code by Andrew Hamilton:</p>
<p>Hamilton, A. J. S., 2000, Uncorrelated modes of the non-linear power spectrum:
Monthly Notices of the Royal Astronomical Society, 312, pages 257-284; DOI:
10.1046/j.1365-8711.2000.03071.x; Website of FFTLog:
<a class="reference external" href="http://casa.colorado.edu/~ajsh/FFTLog">http://casa.colorado.edu/~ajsh/FFTLog</a>.</p>
<p>The function <cite>scipy.special.loggamma</cite> replaces the file <cite>cdgamma.f</cite> in the
original code, and the functions <cite>rfft</cite> and <cite>irfft</cite> from <cite>scipy.fftpack</cite>
replace the files <cite>drffti.f</cite>, <cite>drfftf.f</cite>, and <cite>drfftb.f</cite> in the original code.</p>
<p>The original documentation has just been adjusted where necessary, and put into
a more pythonic format (e.g. using ‘Parameters’ and ‘Returns’ in the
documentation’).</p>
<p><strong>*</strong> From the original documentation <strong>*</strong></p>
<div class="section" id="the-fftlog-code">
<h4>THE FFTLog CODE<a class="headerlink" href="#the-fftlog-code" title="Permalink to this headline">¶</a></h4>
<dl class="simple">
<dt>FFTLog</dt><dd><p>computes the discrete Fast Fourier Transform or Fast Hankel Transform (of
arbitrary real index) of a periodic logarithmic sequence.</p>
</dd>
</dl>
<p>Version of 5 July 1999.</p>
<p>For more information about FFTLog, see <a class="reference external" href="http://casa.colorado.edu/~ajsh/FFTLog">http://casa.colorado.edu/~ajsh/FFTLog</a>.</p>
<p>Andrew J S Hamilton March 1999, email: <a class="reference external" href="mailto:Andrew&#46;Hamilton&#37;&#52;&#48;Colorado&#46;EDU">Andrew<span>&#46;</span>Hamilton<span>&#64;</span>Colorado<span>&#46;</span>EDU</a></p>
<dl class="simple">
<dt>Refs: Talman J. D., 1978, J. Comp. Phys., 29, 35; Hamilton A. J. S., 2000,</dt><dd><p>MNRAS, 312, 257 (<a class="reference external" href="http://xxx.lanl.gov/abs/astro-ph/9905191">http://xxx.lanl.gov/abs/astro-ph/9905191</a>)</p>
</dd>
</dl>
<p>FFTLog computes a discrete version of the Hankel Transform (= Fourier-Bessel
Transform) with a power law bias (k r)^q</p>
<blockquote>
<div><blockquote>
<div><p>infinity
/           q</p>
</div></blockquote>
<dl>
<dt>ã(k) = | a(r) (k r)  J  (k r) k dr</dt><dd><p>/              mu
0</p>
<p>infinity
/           -q</p>
</dd>
<dt>a(r) = | ã(k) (k r)   J  (k r) r dk</dt><dd><p>/               mu
0</p>
</dd>
</dl>
</div></blockquote>
<p>where J_mu is the Bessel function of order mu.  The index mu may be any real
number, positive or negative.</p>
<p>The input array a_j is a periodic sequence of length n, uniformly
logarithmically spaced with spacing dlnr</p>
<blockquote>
<div><p>a_j = a(r_j)   at   r_j = r_c exp[(j-j_c) dlnr]</p>
</div></blockquote>
<p>centred about the point r_c.  The central index j_c = (n+1)/2 is 1/2 integral
if n is even.  Similarly, the output array ã_j is a periodic sequence of length
n, also uniformly logarithmically spaced with spacing dlnr</p>
<blockquote>
<div><p>ã_j = ã(k_j)   at   k_j = k_c exp[(j-j_c) dlnr]</p>
</div></blockquote>
<p>centred about the point k_c.</p>
<p>The centre points r_c and k_c of the periodic intervals may be chosen
arbitrarily; but it would be normal to choose the product</p>
<blockquote>
<div><p>kr = k_c r_c = k_j r_(n+1-j) = k_(n+1-j) r_j</p>
</div></blockquote>
<p>to be about 1 (or 2, or pi, to taste).</p>
<p>The FFTLog algorithm is (see Hamilton 2000):
1. FFT the input array a_j to obtain the Fourier coefficients c_m ;
2. Multiply c_m by</p>
<blockquote>
<div><blockquote>
<div><p>u_m = (kr)^[- i 2 m pi/(n dlnr)] U_mu[q + i 2 m pi/(n dlnr)]</p>
</div></blockquote>
<dl class="simple">
<dt>where</dt><dd><p>U_mu(x) = 2^x Gamma[(mu+1+x)/2] / Gamma[(mu+1-x)/2]</p>
</dd>
</dl>
<p>to obtain c_m u_m ;</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>FFT c_m u_m back to obtain the discrete Hankel transform ã_j .</p></li>
</ol>
<blockquote>
<div><blockquote>
<div><dl class="simple">
<dt>infinity</dt><dd><p>/</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>Ã(k) = sqrt(2/pi) | A(r) sin(k r) dr</dt><dd><blockquote>
<div><p>/</p>
</div></blockquote>
<p>0</p>
<dl class="simple">
<dt>infinity</dt><dd><p>/</p>
</dd>
</dl>
</dd>
<dt>Ã(k) = sqrt(2/pi) | A(r) cos(k r) dr</dt><dd><blockquote>
<div><p>/</p>
</div></blockquote>
<p>0</p>
</dd>
</dl>
</div></blockquote>
<p>may be regarded as special cases of the Hankel transform with mu = 1/2 and -1/2
since</p>
<blockquote>
<div><dl class="simple">
<dt>sqrt(2/pi) sin(x) = sqrt(x) J   (x)</dt><dd><p>1/2</p>
</dd>
<dt>sqrt(2/pi) cos(x) = sqrt(x) J    (x)</dt><dd><p>-1/2</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>The Fourier transforms may be done by making the substitutions</dt><dd><blockquote>
<div><p>q-(1/2)                      -q-(1/2)</p>
</div></blockquote>
<p>A(r) = a(r) r          and   Ã(k) = ã(k) k</p>
</dd>
</dl>
<p>and Hankel transforming a(r) with a power law bias (k r)^q</p>
<blockquote>
<div><blockquote>
<div><p>infinity
/           q</p>
</div></blockquote>
<dl class="simple">
<dt>ã(k) = | a(r) (k r)  J    (k r) k dr</dt><dd><p>/              ±1/2
0</p>
</dd>
</dl>
</div></blockquote>
<p>Different choices of power law bias q lead to different discrete Fourier
transforms of A(r), because the assumption of periodicity of a(r) = A(r)
r^[-q+(1/2)] is different for different q.</p>
<p>If A(r) is a power law, A(r) proportional to r^[q-(1/2)], then applying a bias
q yields a discrete Fourier transform Ã(k) that is exactly equal to the
continuous Fourier transform, because then a(r) is a constant, which is a
periodic function.</p>
<blockquote>
<div><blockquote>
<div><p>infinity
/</p>
</div></blockquote>
<dl class="simple">
<dt>Ã(k) = | A(r) J  (k r) k dr</dt><dd><p>/       mu
0</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>may be done by making the substitutions</dt><dd><blockquote>
<div><p>q                      -q</p>
</div></blockquote>
<p>A(r) = a(r) r    and   Ã(k) = ã(k) k</p>
</dd>
</dl>
<p>and Hankel transforming a(r) with a power law bias (k r)^q</p>
<blockquote>
<div><blockquote>
<div><p>infinity
/           q</p>
</div></blockquote>
<dl class="simple">
<dt>ã(k) = | a(r) (k r)  J  (k r) k dr</dt><dd><p>/              mu
0</p>
</dd>
</dl>
</div></blockquote>
<p>Different choices of power law bias q lead to different discrete Hankel
transforms of A(r), because the assumption of periodicity of a(r) = A(r) r^-q
is different for different q.</p>
<p>If A(r) is a power law, A(r) proportional to r^q, then applying a bias q yields
a discrete Hankel transform Ã(k) that is exactly equal to the continuous Hankel
transform, because then a(r) is a constant, which is a periodic function.</p>
<div class="section" id="there-are-five-routines">
<h5>There are five routines:<a class="headerlink" href="#there-are-five-routines" title="Permalink to this headline">¶</a></h5>
<p>Comments in the subroutines contain further details.</p>
<ol class="arabic simple">
<li><p>subroutine fhti(n,mu,q,dlnr,kr,kropt,wsave,ok)
is an initialization routine.</p></li>
<li><p>subroutine fftl(n,a,rk,dir,wsave)
computes the discrete Fourier sine or cosine transform of a logarithmically
spaced periodic sequence. This is a driver routine that calls fhtq.</p></li>
<li><p>subroutine fht(n,a,dir,wsave)
computes the discrete Hankel transform of a logarithmically spaced periodic
sequence.  This is a driver routine that calls fhtq.</p></li>
<li><p>subroutine fhtq(n,a,dir,wsave)
computes the biased discrete Hankel transform of a logarithmically spaced
periodic sequence.  This is the basic FFTLog routine.</p></li>
<li><p>real*8 function krgood(mu,q,dlnr,kr)
takes an input kr and returns the nearest low-ringing kr.  This is an
optional routine called by fhti.</p></li>
</ol>
<dl class="function">
<dt id="bacco.pyfftlog.fftl">
<code class="sig-prename descclassname">bacco.pyfftlog.</code><code class="sig-name descname">fftl</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">xsave</em>, <em class="sig-param">rk=1</em>, <em class="sig-param">tdir=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/pyfftlog.html#fftl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.pyfftlog.fftl" title="Permalink to this definition">¶</a></dt>
<dd><p>Logarithmic fast Fourier transform FFTLog.</p>
<p>This is a driver routine that calls fhtq.</p>
<p>fftl computes a discrete version of the Fourier sine (if mu = 1/2) or
cosine (if mu = -1/2) transform</p>
<blockquote>
<div><blockquote>
<div><dl class="simple">
<dt>infinity</dt><dd><p>/</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>Ã(k) = sqrt(2/pi) | A(r) sin(k r) dr</dt><dd><blockquote>
<div><p>/</p>
</div></blockquote>
<p>0</p>
<dl class="simple">
<dt>infinity</dt><dd><p>/</p>
</dd>
</dl>
</dd>
<dt>Ã(k) = sqrt(2/pi) | A(r) cos(k r) dr</dt><dd><blockquote>
<div><p>/</p>
</div></blockquote>
<p>0</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>by making the substitutions</dt><dd><blockquote>
<div><p>q-(1/2)                      -q-(1/2)</p>
</div></blockquote>
<p>A(r) = a(r) r          and   Ã(k) = ã(k) k</p>
</dd>
</dl>
<p>and applying a biased Hankel transform to a(r).</p>
<p>The steps are:
1. a(r) = A(r) r^[-dir*(q-.5)]
2. call fhtq to transform a(r) -&gt; ã(k)
3. Ã(k) = ã(k) k^[-dir*(q+.5)]</p>
<p>fhti must be called before the first call to fftl, with mu = 1/2 for a sine
transform, or mu = -1/2 for a cosine transform.</p>
<p>A call to fftl with dir=1 followed by a call to fftl with dir=-1 (and rk
unchanged), or vice versa, leaves the array a unchanged.</p>
<dl>
<dt>a<span class="classifier">array</span></dt><dd><p>Array A(r) to transform: a(j) is A(r_j) at r_j = r_c exp[(j-jc) dlnr],
where jc = (n+1)/2 = central index of array.</p>
</dd>
<dt>xsave<span class="classifier">array</span></dt><dd><p>Working array set up by fhti.</p>
</dd>
<dt>rk<span class="classifier">float, optional</span></dt><dd><p>r_c/k_c = r_j/k_j (a constant, the same constant for any j); rk is not
(necessarily) the same quantity as kr.  rk is used only to multiply the
output array by sqrt(rk)^diqr, so if you want to do the normalization
later, or you don’t care about the normalization, you can set rk = 1.
Defaults to 1.</p>
</dd>
<dt>tdir<span class="classifier">int, optional; {1, -1}</span></dt><dd><ul class="simple">
<li><p>1 for forward transform (default),</p></li>
<li><p>-1 for backward transform.</p></li>
</ul>
<p>A backward transform (dir = -1) is the same as a forward transform with
q -&gt; -q and rk -&gt; 1/rk, for any kr if n is odd, for low-ringing kr if n
is even.</p>
</dd>
</dl>
<dl class="simple">
<dt>a<span class="classifier">array</span></dt><dd><p>Transformed array Ã(k): a(j) is Ã(k_j) at k_j = k_c exp[(j-jc) dlnr].</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.pyfftlog.fht">
<code class="sig-prename descclassname">bacco.pyfftlog.</code><code class="sig-name descname">fht</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">xsave</em>, <em class="sig-param">tdir=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/pyfftlog.html#fht"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.pyfftlog.fht" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast Hankel transform FHT.</p>
<p>This is a driver routine that calls fhtq.</p>
<p>fht computes a discrete version of the Hankel transform</p>
<blockquote>
<div><blockquote>
<div><dl class="simple">
<dt>infinity</dt><dd><p>/</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>Ã(k) = | A(r) J  (k r) k dr</dt><dd><blockquote>
<div><p>/       mu</p>
</div></blockquote>
<p>0</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>by making the substitutions</dt><dd><blockquote>
<div><p>q                      -q</p>
</div></blockquote>
<p>A(r) = a(r) r    and   Ã(k) = ã(k) k</p>
</dd>
</dl>
<p>and applying a biased Hankel transform to a(r).</p>
<p>The steps are:
1. a(r) = A(r) r^(-dir*q)
2. call fhtq to transform a(r) -&gt; ã(k)
3. Ã(k) = ã(k) k^(-dir*q)</p>
<p>fhti must be called before the first call to fht.</p>
<p>A call to fht with dir=1 followed by a call to fht with dir=-1, or vice
versa, leaves the array a unchanged.</p>
<dl>
<dt>a<span class="classifier">array</span></dt><dd><p>Array A(r) to transform: a(j) is A(r_j) at r_j = r_c exp[(j-jc) dlnr],
where jc = (n+1)/2 = central index of array.</p>
</dd>
<dt>xsave<span class="classifier">array</span></dt><dd><p>Working array set up by fhti.</p>
</dd>
<dt>tdir<span class="classifier">int, optional; {1, -1}</span></dt><dd><ul class="simple">
<li><p>1 for forward transform (default),</p></li>
<li><p>-1 for backward transform.</p></li>
</ul>
<p>A backward transform (dir = -1) is the same as a forward transform with
q -&gt; -q, for any kr if n is odd, for low-ringing kr if n is even.</p>
</dd>
</dl>
<dl class="simple">
<dt>a<span class="classifier">array</span></dt><dd><p>Transformed array Ã(k): a(j) is Ã(k_j) at k_j = k_c exp[(j-jc) dlnr].</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.pyfftlog.fhti">
<code class="sig-prename descclassname">bacco.pyfftlog.</code><code class="sig-name descname">fhti</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">mu</em>, <em class="sig-param">dlnr</em>, <em class="sig-param">q=0</em>, <em class="sig-param">kr=1</em>, <em class="sig-param">kropt=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/pyfftlog.html#fhti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.pyfftlog.fhti" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the working array xsave used by fftl, fht, and fhtq.</p>
<p>fhti initializes the working array xsave used by fftl, fht, and fhtq.  fhti
need be called once, whereafter fftl, fht, or fhtq may be called many
times, as long as n, mu, q, dlnr, and kr remain unchanged. fhti should be
called each time n, mu, q, dlnr, or kr is changed. The work array xsave
should not be changed between calls to fftl, fht, or fhtq.</p>
<dl class="simple">
<dt>n<span class="classifier">int</span></dt><dd><p>Number of points in the array to be transformed; n may be any positive
integer, but the FFT routines run fastest if n is a product of small
primes 2, 3, 5.</p>
</dd>
<dt>mu<span class="classifier">float</span></dt><dd><p>Index of J_mu in Hankel transform; mu may be any real number, positive
or negative.</p>
</dd>
<dt>dlnr<span class="classifier">float</span></dt><dd><p>Separation between natural log of points; dlnr may be positive or
negative.</p>
</dd>
<dt>q<span class="classifier">float, optional</span></dt><dd><p>Exponent of power law bias; q may be any real number, positive or
negative.  If in doubt, use q = 0, for which case the Hankel transform
is orthogonal, i.e. self-inverse, provided also that, for n even, kr is
low-ringing.  Non-zero q may yield better approximations to the
continuous Hankel transform for some functions.
Defaults to 0 (unbiased).</p>
</dd>
<dt>kr<span class="classifier">float, optional</span></dt><dd><p>k_c r_c where c is central point of array
= k_j r_(n+1-j) = k_(n+1-j) r_j .
Normally one would choose kr to be about 1 (default) (or 2, or pi, to
taste).</p>
</dd>
<dt>kropt<span class="classifier">int, optional; {0, 1, 2, 3}</span></dt><dd><ul class="simple">
<li><p>0 to use input kr as is (default);</p></li>
<li><p>1 to change kr to nearest low-ringing kr, quietly;</p></li>
<li><p>2 to change kr to nearest low-ringing kr, verbosely;</p></li>
<li><p>3 for option to change kr interactively.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>kr<span class="classifier">float, optional</span></dt><dd><p>kr, adjusted depending on kropt.</p>
</dd>
<dt>xsave<span class="classifier">array</span></dt><dd><p>Working array used by fftl, fht, and fhtq. Dimension:
- for q = 0 (unbiased transform): n+3
- for q != 0 (biased transform): 1.5*n+4
If odd, last element is not needed.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.pyfftlog.fhtq">
<code class="sig-prename descclassname">bacco.pyfftlog.</code><code class="sig-name descname">fhtq</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">xsave</em>, <em class="sig-param">tdir=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/pyfftlog.html#fhtq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.pyfftlog.fhtq" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel routine of FFTLog.</p>
<p>This is the basic FFTLog routine.</p>
<p>fhtq computes a discrete version of the biased Hankel transform</p>
<blockquote>
<div><blockquote>
<div><dl class="simple">
<dt>infinity</dt><dd><p>/           q</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>ã(k) = | a(r) (k r)  J  (k r) k dr</dt><dd><blockquote>
<div><p>/              mu</p>
</div></blockquote>
<p>0</p>
</dd>
</dl>
</div></blockquote>
<p>fhti must be called before the first call to fhtq.</p>
<p>A call to fhtq with dir=1 followed by a call to fhtq with dir=-1, or vice
versa, leaves the array a unchanged.</p>
<dl>
<dt>a<span class="classifier">array</span></dt><dd><p>Periodic array a(r) to transform: a(j) is a(r_j) at r_j = r_c
exp[(j-jc) dlnr] where jc = (n+1)/2 = central index of array.</p>
</dd>
<dt>xsave<span class="classifier">array</span></dt><dd><p>Working array set up by fhti.</p>
</dd>
<dt>tdir<span class="classifier">int, optional; {1, -1}</span></dt><dd><ul class="simple">
<li><p>1 for forward transform (default),</p></li>
<li><p>-1 for backward transform.</p></li>
</ul>
<p>A backward transform (dir = -1) is the same as a forward transform with
q -&gt; -q, for any kr if n is odd, for low-ringing kr if n is even.</p>
</dd>
</dl>
<dl class="simple">
<dt>a<span class="classifier">array</span></dt><dd><p>Transformed periodic array ã(k): a(j) is ã(k_j) at k_j = k_c exp[(j-jc)
dlnr].</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.pyfftlog.krgood">
<code class="sig-prename descclassname">bacco.pyfftlog.</code><code class="sig-name descname">krgood</code><span class="sig-paren">(</span><em class="sig-param">mu</em>, <em class="sig-param">q</em>, <em class="sig-param">dlnr</em>, <em class="sig-param">kr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/pyfftlog.html#krgood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.pyfftlog.krgood" title="Permalink to this definition">¶</a></dt>
<dd><p>Return optimal kr</p>
<p>Use of this routine is optional.</p>
<dl class="simple">
<dt>Choosing kr so that</dt><dd><p>(kr)^(- i pi/dlnr) U_mu(q + i pi/dlnr)</p>
</dd>
</dl>
<p>is real may reduce ringing of the discrete Hankel transform, because it
makes the transition of this function across the period boundary smoother.</p>
<dl class="simple">
<dt>mu<span class="classifier">float</span></dt><dd><p>index of J_mu in Hankel transform; mu may be any real number, positive
or negative.</p>
</dd>
<dt>q<span class="classifier">float</span></dt><dd><p>exponent of power law bias; q may be any real number, positive or
negative.  If in doubt, use q = 0, for which case the Hankel transform
is orthogonal, i.e. self-inverse, provided also that, for n even, kr is
low-ringing.  Non-zero q may yield better approximations to the
continuous Hankel transform for some functions.</p>
</dd>
<dt>dlnr<span class="classifier">float</span></dt><dd><p>separation between natural log of points; dlnr may be positive or
negative.</p>
</dd>
<dt>kr<span class="classifier">float, optional</span></dt><dd><p>k_c r_c where c is central point of array
= k_j r_(n+1-j) = k_(n+1-j) r_j .
Normally one would choose kr to be about 1 (default) (or 2, or pi, to
taste).</p>
</dd>
</dl>
<dl class="simple">
<dt>krgood<span class="classifier">float</span></dt><dd><p>low-ringing value of kr nearest to input kr.  ln(krgood) is always
within dlnr/2 of ln(kr).</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
</div>
<div class="section" id="module-bacco.sampler">
<span id="bacco-sampler-module"></span><h2>bacco.sampler module<a class="headerlink" href="#module-bacco.sampler" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Sampler’ class and helper functions</p>
<dl class="class">
<dt id="bacco.sampler.Sampler">
<em class="property">class </em><code class="sig-prename descclassname">bacco.sampler.</code><code class="sig-name descname">Sampler</code><span class="sig-paren">(</span><em class="sig-param">method='metropolis'</em>, <em class="sig-param">lnlike=None</em>, <em class="sig-param">lnlike_args=None</em>, <em class="sig-param">lnlike_scatter=None</em>, <em class="sig-param">lnlike_scatter_args=None</em>, <em class="sig-param">nchains=None</em>, <em class="sig-param">ndims=None</em>, <em class="sig-param">nwalkers=None</em>, <em class="sig-param">bounds=None</em>, <em class="sig-param">par_names=None</em>, <em class="sig-param">backup_fname=None</em>, <em class="sig-param">load_backup=False</em>, <em class="sig-param">convergence_crit=0.05</em>, <em class="sig-param">auto_stop=False</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">analysis_mode=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that defines some MCMC sampling utilities</p>
<dl class="method">
<dt id="bacco.sampler.Sampler.compute_multvar_gauss_fit">
<code class="sig-name descname">compute_multvar_gauss_fit</code><span class="sig-paren">(</span><em class="sig-param">lhc_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.compute_multvar_gauss_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.compute_multvar_gauss_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.emulate_likelihood">
<code class="sig-name descname">emulate_likelihood</code><span class="sig-paren">(</span><em class="sig-param">emulator=None</em>, <em class="sig-param">file=None</em>, <em class="sig-param">hyperspace=None</em>, <em class="sig-param">space_rotation=False</em>, <em class="sig-param">space_rotation_points=None</em>, <em class="sig-param">divide_by_multvar_gaussian=False</em>, <em class="sig-param">add_points=None</em>, <em class="sig-param">add_likes=None</em>, <em class="sig-param">lhc_seed=5</em>, <em class="sig-param">lhc_spread=True</em>, <em class="sig-param">lhc_nbuild=150</em>, <em class="sig-param">gp='george'</em>, <em class="sig-param">gp_variance=1</em>, <em class="sig-param">gp_lengthscale=1</em>, <em class="sig-param">gp_num_restarts=9</em>, <em class="sig-param">gp_seed=1</em>, <em class="sig-param">gp_realisation=False</em>, <em class="sig-param">gp_fix_hyperparams=False</em>, <em class="sig-param">gp_noise_stdev=0.0</em>, <em class="sig-param">fix_noise=0.0</em>, <em class="sig-param">use_fitted=None</em>, <em class="sig-param">ln_ln=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.emulate_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.emulate_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>emulator: emulator object, if None it will be builded.
file: file containing coordinates and likelihood evaluations to build the emulator. If None</p>
<blockquote>
<div><p>a latin hypercube will be builded</p>
</div></blockquote>
<p>hyperspace: boundaries for the emulator latin hypercube, if None the sampler boundaries will be used
space rotation: if True the emulator space will be rotated and renormalised
add_points: points to be added to the latin hypercube
add_likes: likelihoods associated to add_points to be added to the latin hypercube, if None they will be computed
lhc_seed: seed fot the latin hypercube
lhc_spread: if True, the projected distances will be maximised
lhc_nbuild: number of points in the latin hypercube
gp: gaussian process to be used, between ‘george’ (default), ‘gpy’ and ‘sklearn’
gp_variance: gaussian process variance, default is 1
gp_lengthscale: gaussian process lenghtscale, default is 1
gp_num_restarts = gaussian process number of optimisation restarts, default is 9
gp_seed= gaussian process seed, default is 1
gp_realisation = if True, a random realisation of the emulator will be returned instead of the mean. Default is False</p>
</dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.emulated_lnlike">
<code class="sig-name descname">emulated_lnlike</code><span class="sig-paren">(</span><em class="sig-param">points</em>, <em class="sig-param">return_cov=False</em>, <em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.emulated_lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.emulated_lnlike" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.get_latex_table">
<code class="sig-name descname">get_latex_table</code><span class="sig-paren">(</span><em class="sig-param">fname</em>, <em class="sig-param">lims=68</em>, <em class="sig-param">compilation=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.get_latex_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.get_latex_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.get_lims68">
<code class="sig-name descname">get_lims68</code><span class="sig-paren">(</span><em class="sig-param">par=None</em>, <em class="sig-param">latex=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.get_lims68"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.get_lims68" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.get_lims95">
<code class="sig-name descname">get_lims95</code><span class="sig-paren">(</span><em class="sig-param">par=None</em>, <em class="sig-param">latex=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.get_lims95"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.get_lims95" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.get_lims99">
<code class="sig-name descname">get_lims99</code><span class="sig-paren">(</span><em class="sig-param">par=None</em>, <em class="sig-param">latex=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.get_lims99"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.get_lims99" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.get_marginalised_stats">
<code class="sig-name descname">get_marginalised_stats</code><span class="sig-paren">(</span><em class="sig-param">burnin=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.get_marginalised_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.get_marginalised_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.initialize_run">
<code class="sig-name descname">initialize_run</code><span class="sig-paren">(</span><em class="sig-param">method='latinhypercube'</em>, <em class="sig-param">fname=None</em>, <em class="sig-param">lh_seed=5</em>, <em class="sig-param">lh_spread=True</em>, <em class="sig-param">initguess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.initialize_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.initialize_run" title="Permalink to this definition">¶</a></dt>
<dd><p>fname: file with the initial positions of the chains.
initguess: array of initial positions of the chains. In case of emulated likelihoods,</p>
<blockquote>
<div><p>these points will be added on top of the latin hypercube ones.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.plot_mcmc_chains">
<code class="sig-name descname">plot_mcmc_chains</code><span class="sig-paren">(</span><em class="sig-param">target_values=None</em>, <em class="sig-param">show_plot=False</em>, <em class="sig-param">save_plot=False</em>, <em class="sig-param">burnin=0.1</em>, <em class="sig-param">labels=None</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.plot_mcmc_chains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.plot_mcmc_chains" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.plot_mcmc_contours">
<code class="sig-name descname">plot_mcmc_contours</code><span class="sig-paren">(</span><em class="sig-param">target_values=None, burnin=0.1, quantiles=[0.16, 0.5, 0.84], levels=None, smooth=1.0, fix_bounds=False, show_plot=True, save_plot=False, plot_points=None, name=None, ranges=None, labels=None, **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.plot_mcmc_contours"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.plot_mcmc_contours" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.plot_mcmc_likelihood">
<code class="sig-name descname">plot_mcmc_likelihood</code><span class="sig-paren">(</span><em class="sig-param">show_plot=False</em>, <em class="sig-param">save_plot=False</em>, <em class="sig-param">burnin=0.1</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.plot_mcmc_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.plot_mcmc_likelihood" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.reset_chains">
<code class="sig-name descname">reset_chains</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.reset_chains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.reset_chains" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">nsteps=5000</em>, <em class="sig-param">maxrepetitions=1</em>, <em class="sig-param">nbackup=1</em>, <em class="sig-param">nconverge=1</em>, <em class="sig-param">nupdate=0</em>, <em class="sig-param">seeds=None</em>, <em class="sig-param">nsuperupdate=0</em>, <em class="sig-param">initial_step=0.05</em>, <em class="sig-param">use_ntry=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>nupdate=0 and nsuperupdate=0 to not update covariance matrix and jumping
factor, respectively.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.sampler.Sampler.transform_coordinates">
<code class="sig-name descname">transform_coordinates</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/sampler.html#Sampler.transform_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.sampler.Sampler.transform_coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.scaler">
<span id="bacco-scaler-module"></span><h2>bacco.scaler module<a class="headerlink" href="#module-bacco.scaler" title="Permalink to this headline">¶</a></h2>
<p>The main  scaler class</p>
<dl class="class">
<dt id="bacco.scaler.Scaler">
<em class="property">class </em><code class="sig-prename descclassname">bacco.scaler.</code><code class="sig-name descname">Scaler</code><span class="sig-paren">(</span><em class="sig-param">OriginalCosmology</em>, <em class="sig-param">MinRadius=0.3</em>, <em class="sig-param">MaxRadius=10.0</em>, <em class="sig-param">mode='backward'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An Scaler object</p>
<p>:param original cosmology</p>
<dl class="method">
<dt id="bacco.scaler.Scaler.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.compute_growthdiff">
<code class="sig-name descname">compute_growthdiff</code><span class="sig-paren">(</span><em class="sig-param">scaleTime</em>, <em class="sig-param">scaleLength</em>, <em class="sig-param">tcosmo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.compute_growthdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.compute_growthdiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.compute_sigmadiff">
<code class="sig-name descname">compute_sigmadiff</code><span class="sig-paren">(</span><em class="sig-param">scaleTime</em>, <em class="sig-param">scaleLength</em>, <em class="sig-param">tcosmo</em>, <em class="sig-param">radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.compute_sigmadiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.compute_sigmadiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.cost_function">
<code class="sig-name descname">cost_function</code><span class="sig-paren">(</span><em class="sig-param">pars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.cost_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.cost_function" title="Permalink to this definition">¶</a></dt>
<dd><p>This defines the function to minimise to find the best scaling parameter
:param pars: The first and secdon elements are the length and time scaling factors, respectively.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.estimate_errors">
<code class="sig-name descname">estimate_errors</code><span class="sig-paren">(</span><em class="sig-param">run</em>, <em class="sig-param">pk=True</em>, <em class="sig-param">concentration=True</em>, <em class="sig-param">sigma=True</em>, <em class="sig-param">da=True</em>, <em class="sig-param">mf=True</em>, <em class="sig-param">lss_correction=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.estimate_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.estimate_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>This function estimates the magnitude of the error of the rescaled
simulation for several quantities</p>
</dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.pk_correction">
<code class="sig-name descname">pk_correction</code><span class="sig-paren">(</span><em class="sig-param">run</em>, <em class="sig-param">wavemode=None</em>, <em class="sig-param">correction_type='additive'</em>, <em class="sig-param">cold=False</em>, <em class="sig-param">nlin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.pk_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.pk_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute large-scale correction to be applied to the rescaled
power spectrum.</p>
<dl class="simple">
<dt>if correction_type is additive:</dt><dd><p>returns pk_correction such that
pk_corrected = pk_target + pk_correction</p>
</dd>
<dt>if correction_type is multiplicative:</dt><dd><p>retruns pk_correction such that
pk_corrected = pk_target * pk_correction</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.plots">
<code class="sig-name descname">plots</code><span class="sig-paren">(</span><em class="sig-param">run</em>, <em class="sig-param">block=False</em>, <em class="sig-param">fig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.plots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">TargetCosmology</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Here we find the values of the transformation that minimise the function defined in cost_function()</p>
</dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.runmin">
<code class="sig-name descname">runmin</code><span class="sig-paren">(</span><em class="sig-param">ctarget</em>, <em class="sig-param">use_growth=False</em>, <em class="sig-param">use_nlpk=False</em>, <em class="sig-param">limit_scaleLength=None</em>, <em class="sig-param">limit_scaleTime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.runmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.runmin" title="Permalink to this definition">¶</a></dt>
<dd><p>#Here we should find the transformations that minimise the difference in the
variances.</p>
</dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.runmin_sigma8">
<code class="sig-name descname">runmin_sigma8</code><span class="sig-paren">(</span><em class="sig-param">ctarget</em>, <em class="sig-param">limit_scaleTime=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.runmin_sigma8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.runmin_sigma8" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds scale time by just minimizing sigma8. Scale length is fixed (=1).</p>
</dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.scale_simulation">
<code class="sig-name descname">scale_simulation</code><span class="sig-paren">(</span><em class="sig-param">osim</em>, <em class="sig-param">scl_run</em>, <em class="sig-param">ngrid=128</em>, <em class="sig-param">scl_dm=True</em>, <em class="sig-param">scl_halos=True</em>, <em class="sig-param">scl_sdm=False</em>, <em class="sig-param">scl_sub=False</em>, <em class="sig-param">secondLPT=False</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">lss_correction=True</em>, <em class="sig-param">add_relativistic_effects=False</em>, <em class="sig-param">conc_correction=False</em>, <em class="sig-param">compute_m200c=False</em>, <em class="sig-param">scale_snaplist=True</em>, <em class="sig-param">remeasure_halo_profiles=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.scale_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.scale_simulation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.scaler.Scaler.update_runmin_a">
<code class="sig-name descname">update_runmin_a</code><span class="sig-paren">(</span><em class="sig-param">run</em>, <em class="sig-param">expfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#Scaler.update_runmin_a"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.Scaler.update_runmin_a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bacco.scaler.runmin_cleanup">
<code class="sig-prename descclassname">bacco.scaler.</code><code class="sig-name descname">runmin_cleanup</code><span class="sig-paren">(</span><em class="sig-param">run</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/scaler.html#runmin_cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.scaler.runmin_cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-bacco.simDesign">
<span id="bacco-simdesign-module"></span><h2>bacco.simDesign module<a class="headerlink" href="#module-bacco.simDesign" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="bacco.simDesign.Parameter_Space">
<em class="property">class </em><code class="sig-prename descclassname">bacco.simDesign.</code><code class="sig-name descname">Parameter_Space</code><span class="sig-paren">(</span><em class="sig-param">Cosmology</em>, <em class="sig-param">cosmo_parameters</em>, <em class="sig-param">param_bounds</em>, <em class="sig-param">n_simulations</em>, <em class="sig-param">ErrFunc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Parameter_Space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Parameter_Space" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to define a cosmological hyperparameters space.</p>
<dl class="class">
<dt id="bacco.simDesign.Parameter_Space.EuclideanDistance">
<em class="property">class </em><code class="sig-name descname">EuclideanDistance</code><span class="sig-paren">(</span><em class="sig-param">parameter_space</em>, <em class="sig-param">o_points</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Parameter_Space.EuclideanDistance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Parameter_Space.EuclideanDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to define the euclidean distance between two points.</p>
<dl class="method">
<dt id="bacco.simDesign.Parameter_Space.EuclideanDistance.multiple_points">
<code class="sig-name descname">multiple_points</code><span class="sig-paren">(</span><em class="sig-param">t_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Parameter_Space.EuclideanDistance.multiple_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Parameter_Space.EuclideanDistance.multiple_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="bacco.simDesign.Parameter_Space.ScalerError">
<em class="property">class </em><code class="sig-name descname">ScalerError</code><span class="sig-paren">(</span><em class="sig-param">parameter_space</em>, <em class="sig-param">o_points</em>, <em class="sig-param">quantity='pk_05'</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Parameter_Space.ScalerError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Parameter_Space.ScalerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to define the error between two points in the Power Spectrum evaluation</p>
<dl class="method">
<dt id="bacco.simDesign.Parameter_Space.ScalerError.multiple_points">
<code class="sig-name descname">multiple_points</code><span class="sig-paren">(</span><em class="sig-param">t_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Parameter_Space.ScalerError.multiple_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Parameter_Space.ScalerError.multiple_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</dd></dl>

<dl class="class">
<dt id="bacco.simDesign.Optimisation">
<em class="property">class </em><code class="sig-prename descclassname">bacco.simDesign.</code><code class="sig-name descname">Optimisation</code><span class="sig-paren">(</span><em class="sig-param">parameter_space</em>, <em class="sig-param">minimiser</em>, <em class="sig-param">step_min</em>, <em class="sig-param">min_chain_size</em>, <em class="sig-param">Nsl=20</em>, <em class="sig-param">Pi=0.7</em>, <em class="sig-param">Pf=0.1</em>, <em class="sig-param">burn_in=100</em>, <em class="sig-param">min_method='mean_min'</em>, <em class="sig-param">LongStep_nchains=None</em>, <em class="sig-param">dir_output='output/'</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">rand_seed=123</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to find the best cosmological parameters for an ensamble of simulations,
by minimising the maximum error obtained by scaling the
simulations within the whole hyperparameters space.</p>
<dl class="class">
<dt id="bacco.simDesign.Optimisation.AdaptiveStepsize">
<em class="property">class </em><code class="sig-name descname">AdaptiveStepsize</code><span class="sig-paren">(</span><em class="sig-param">parameter_space</em>, <em class="sig-param">takestep</em>, <em class="sig-param">accept_rate=0.5</em>, <em class="sig-param">interval=1000</em>, <em class="sig-param">factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.AdaptiveStepsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.AdaptiveStepsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#bacco.simDesign.Parameter_Space" title="bacco.simDesign.Parameter_Space"><code class="xref py py-class docutils literal notranslate"><span class="pre">bacco.simDesign.Parameter_Space</span></code></a></p>
<p>Class to implement adaptive stepsize. Taken and Modified from scipy.</p>
<dl class="method">
<dt id="bacco.simDesign.Optimisation.AdaptiveStepsize.n_accepted">
<code class="sig-name descname">n_accepted</code><span class="sig-paren">(</span><em class="sig-param">j</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.AdaptiveStepsize.n_accepted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.AdaptiveStepsize.n_accepted" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.AdaptiveStepsize.n_total_steps">
<code class="sig-name descname">n_total_steps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.AdaptiveStepsize.n_total_steps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.AdaptiveStepsize.n_total_steps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.AdaptiveStepsize.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param">accept</em>, <em class="sig-param">k</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.AdaptiveStepsize.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.AdaptiveStepsize.report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.AdaptiveStepsize.take_step">
<code class="sig-name descname">take_step</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">multiple_steps</em>, <em class="sig-param">k</em>, <em class="sig-param">prior</em>, <em class="sig-param">E</em>, <em class="sig-param">x0</em>, <em class="sig-param">E0</em>, <em class="sig-param">x1</em>, <em class="sig-param">E1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.AdaptiveStepsize.take_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.AdaptiveStepsize.take_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.DistanceFromVertices">
<code class="sig-name descname">DistanceFromVertices</code><span class="sig-paren">(</span><em class="sig-param">original_points</em>, <em class="sig-param">n_cycles</em>, <em class="sig-param">last_maxima=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.DistanceFromVertices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.DistanceFromVertices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.FindMax">
<code class="sig-name descname">FindMax</code><span class="sig-paren">(</span><em class="sig-param">original_points</em>, <em class="sig-param">LongStep</em>, <em class="sig-param">last_maxima=None</em>, <em class="sig-param">displ_min=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.FindMax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.FindMax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.FindMin">
<code class="sig-name descname">FindMin</code><span class="sig-paren">(</span><em class="sig-param">seeds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.FindMin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.FindMin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.PiS">
<code class="sig-name descname">PiS</code><span class="sig-paren">(</span><em class="sig-param">points</em>, <em class="sig-param">nchains=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.PiS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.PiS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.SimulatedAnnealMin">
<code class="sig-name descname">SimulatedAnnealMin</code><span class="sig-paren">(</span><em class="sig-param">seeds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.SimulatedAnnealMin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.SimulatedAnnealMin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="bacco.simDesign.Optimisation.TakeStep">
<em class="property">class </em><code class="sig-name descname">TakeStep</code><span class="sig-paren">(</span><em class="sig-param">parameter_space</em>, <em class="sig-param">stepsize</em>, <em class="sig-param">nchains</em>, <em class="sig-param">random_seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.TakeStep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.TakeStep" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to generate the proposal position of the chains</p>
<dl class="method">
<dt id="bacco.simDesign.Optimisation.TakeStep.eff_stepsize">
<code class="sig-name descname">eff_stepsize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.TakeStep.eff_stepsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.TakeStep.eff_stepsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.TakeStep.priors_gradient">
<code class="sig-name descname">priors_gradient</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">prior</em>, <em class="sig-param">E=None</em>, <em class="sig-param">x0=None</em>, <em class="sig-param">E0=None</em>, <em class="sig-param">x1=None</em>, <em class="sig-param">E1=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.TakeStep.priors_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.TakeStep.priors_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.WriteDesign">
<code class="sig-name descname">WriteDesign</code><span class="sig-paren">(</span><em class="sig-param">GlobMinimum_position</em>, <em class="sig-param">GlobalMinimum_error</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.WriteDesign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.WriteDesign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.estimate_minimum">
<code class="sig-name descname">estimate_minimum</code><span class="sig-paren">(</span><em class="sig-param">point_chain</em>, <em class="sig-param">error_chain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.estimate_minimum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.estimate_minimum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.plots">
<code class="sig-name descname">plots</code><span class="sig-paren">(</span><em class="sig-param">point_chain</em>, <em class="sig-param">error_chain</em>, <em class="sig-param">x_minima</em>, <em class="sig-param">plot_figures</em>, <em class="sig-param">show</em>, <em class="sig-param">save</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.plots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.run_chains">
<code class="sig-name descname">run_chains</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.run_chains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.run_chains" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.select_ErrFunc">
<code class="sig-name descname">select_ErrFunc</code><span class="sig-paren">(</span><em class="sig-param">ErrFunc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.select_ErrFunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.select_ErrFunc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simDesign.Optimisation.select_optimizer">
<code class="sig-name descname">select_optimizer</code><span class="sig-paren">(</span><em class="sig-param">optimizer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simDesign.html#Optimisation.select_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simDesign.Optimisation.select_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.sim_parameters">
<span id="bacco-sim-parameters-module"></span><h2>bacco.sim_parameters module<a class="headerlink" href="#module-bacco.sim_parameters" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-bacco.simulation">
<span id="bacco-simulation-module"></span><h2>bacco.simulation module<a class="headerlink" href="#module-bacco.simulation" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Simulation’ class and helper functions</p>
<dl class="class">
<dt id="bacco.simulation.Simulation">
<em class="property">class </em><code class="sig-prename descclassname">bacco.simulation.</code><code class="sig-name descname">Simulation</code><span class="sig-paren">(</span><em class="sig-param">basedir=None</em>, <em class="sig-param">dm_file=None</em>, <em class="sig-param">halo_file=None</em>, <em class="sig-param">desc_file=None</em>, <em class="sig-param">tree_file=None</em>, <em class="sig-param">lgals_file=None</em>, <em class="sig-param">sim_cosmology=None</em>, <em class="sig-param">parameter_file=None</em>, <em class="sig-param">Nmesh=None</em>, <em class="sig-param">snapnum=None</em>, <em class="sig-param">use_orphans=False</em>, <em class="sig-param">tag='Default'</em>, <em class="sig-param">pkfile=None</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">ns=None</em>, <em class="sig-param">tau=None</em>, <em class="sig-param">A_s=None</em>, <em class="sig-param">sigma8=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">sim_format='gadget_hdf5'</em>, <em class="sig-param">do_compression=False</em>, <em class="sig-param">dask=False</em>, <em class="sig-param">fixedPk=None</em>, <em class="sig-param">RaylQuantile=0</em>, <em class="sig-param">phase=None</em>, <em class="sig-param">add_relativistic_effects=False</em>, <em class="sig-param">lpicola=False</em>, <em class="sig-param">pinocchio=False</em>, <em class="sig-param">total_snapshots=100</em>, <em class="sig-param">numpart=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that defines a cosmological simulation</p>
<dl class="attribute">
<dt id="bacco.simulation.Simulation.BiasMass">
<code class="sig-name descname">BiasMass</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.BiasMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.BiasMass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.ConcentrationMass">
<code class="sig-name descname">ConcentrationMass</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.ConcentrationMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.ConcentrationMass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.Correl">
<code class="sig-name descname">Correl</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.MassFunction">
<code class="sig-name descname">MassFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.MassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.MassFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.Power">
<code class="sig-name descname">Power</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.Power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.Power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.SubhaloMassFunction">
<code class="sig-name descname">SubhaloMassFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.SubhaloMassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.SubhaloMassFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.VmaxFunction">
<code class="sig-name descname">VmaxFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.VmaxFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.VmaxFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.VpeakFunction">
<code class="sig-name descname">VpeakFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.VpeakFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.VpeakFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><em class="sig-param">attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_haloPower">
<code class="sig-name descname">compute_haloPower</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_haloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_haloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_halo_Correl">
<code class="sig-name descname">compute_halo_Correl</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_halo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_halo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_halo_bispectrum">
<code class="sig-name descname">compute_halo_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_halo_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_halo_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_halo_multipoles">
<code class="sig-name descname">compute_halo_multipoles</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_halo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_halo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_hmm_bispectrum">
<code class="sig-name descname">compute_hmm_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_hmm_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_hmm_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_m200_from_profiles">
<code class="sig-name descname">compute_m200_from_profiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_m200_from_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_m200_from_profiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_sdm_bispectrum">
<code class="sig-name descname">compute_sdm_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_sdm_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_sdm_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subPower">
<code class="sig-name descname">compute_subPower</code><span class="sig-paren">(</span><em class="sig-param">prop='mpeak'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">Mask_Type=2</em>, <em class="sig-param">alive_allsats=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_Correl">
<code class="sig-name descname">compute_subhalo_Correl</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">recheck_boundary_condition=False</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_Correl_JN">
<code class="sig-name descname">compute_subhalo_Correl_JN</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">recheck_boundary_condition=False</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">n_jn3=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_Correl_JN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_Correl_JN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_hod">
<code class="sig-name descname">compute_subhalo_hod</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">LogMmin=10</em>, <em class="sig-param">LogMmax=15</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">only_centrals=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_hod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_hod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_mask">
<code class="sig-name descname">compute_subhalo_mask</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes 2 masks to apply to subhalo positions and velocities: one mask
selects subs according a property (vmax, vpeak), either retaining
only the objects that make up the given number density n (if cut is
None), or retaining all objects with values of the given propery larger
than cut.</p>
<dl>
<dt>Inputs:</dt><dd><p>prop:              the property used to sort subs (vmax, vpeak)
cut:               the threshold for prop; if None, n is used to</p>
<blockquote>
<div><p>fix a number density</p>
</div></blockquote>
<p>n:                 used when cut is None to fix a number density
compute_noOrphans: if True, only subs that are not orphans are</p>
<blockquote>
<div><p>retained</p>
</div></blockquote>
<dl class="simple">
<dt>no_destruction:    if False, only consider subs that are still</dt><dd><p>alive</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="simple">
<dt>mask, mask_orph:   two masks, the first one that selects the</dt><dd><p>subs that comply with the selection criterion
while mask_orph selects, from the provious
sample, the ones that are not orphans</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_multipoles">
<code class="sig-name descname">compute_subhalo_multipoles</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">nbin=30</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">recheck_boundary_condition=False</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_multipoles_JN">
<code class="sig-name descname">compute_subhalo_multipoles_JN</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">nbin=30</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">recheck_boundary_condition=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_multipoles_JN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_multipoles_JN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_pmulti">
<code class="sig-name descname">compute_subhalo_pmulti</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_pmulti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_pmulti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.compute_subhalo_powerspectrum">
<code class="sig-name descname">compute_subhalo_powerspectrum</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.compute_subhalo_powerspectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.compute_subhalo_powerspectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.concentration_from_vmax">
<code class="sig-name descname">concentration_from_vmax</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.concentration_from_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.concentration_from_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.decompress">
<code class="sig-name descname">decompress</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.decompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.decompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.deltathetaPower">
<code class="sig-name descname">deltathetaPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.deltathetaPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.deltathetaPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.density_field">
<code class="sig-name descname">density_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.density_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.density_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.density_field_from_displacements">
<code class="sig-name descname">density_field_from_displacements</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.density_field_from_displacements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.density_field_from_displacements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.disp_field">
<code class="sig-name descname">disp_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.disp_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.disp_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.dm">
<code class="sig-name descname">dm</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.dm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.dm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.fit_halo_profiles">
<code class="sig-name descname">fit_halo_profiles</code><span class="sig-paren">(</span><em class="sig-param">use_cengine=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.fit_halo_profiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.fit_halo_profiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.fof">
<code class="sig-name descname">fof</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.fof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.fof" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.fofcat">
<code class="sig-name descname">fofcat</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.fofcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.fofcat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.get_dynamical_friction_time">
<code class="sig-name descname">get_dynamical_friction_time</code><span class="sig-paren">(</span><em class="sig-param">mhost</em>, <em class="sig-param">msat</em>, <em class="sig-param">rsat</em>, <em class="sig-param">infall_snap</em>, <em class="sig-param">mergertime_factor=1.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.get_dynamical_friction_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.get_dynamical_friction_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.get_halo_particles">
<code class="sig-name descname">get_halo_particles</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">sDM=False</em>, <em class="sig-param">key='pos'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.get_halo_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.get_halo_particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.get_subhalos_alive">
<code class="sig-name descname">get_subhalos_alive</code><span class="sig-paren">(</span><em class="sig-param">mergertime_factor=1.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.get_subhalos_alive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.get_subhalos_alive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.get_subhalos_alive_v2">
<code class="sig-name descname">get_subhalos_alive_v2</code><span class="sig-paren">(</span><em class="sig-param">a=1.0</em>, <em class="sig-param">b=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.get_subhalos_alive_v2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.get_subhalos_alive_v2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.haloPower">
<code class="sig-name descname">haloPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.haloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.haloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.haloPower_100particles">
<code class="sig-name descname">haloPower_100particles</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.haloPower_100particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.haloPower_100particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.halo_Correl">
<code class="sig-name descname">halo_Correl</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.halo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.halo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.halo_density_field">
<code class="sig-name descname">halo_density_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.halo_density_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.halo_density_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.halo_multipoles">
<code class="sig-name descname">halo_multipoles</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.halo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.halo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.halo_qdata">
<code class="sig-name descname">halo_qdata</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.halo_qdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.halo_qdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.halo_zCorrel">
<code class="sig-name descname">halo_zCorrel</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.halo_zCorrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.halo_zCorrel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.haloqPower">
<code class="sig-name descname">haloqPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.haloqPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.haloqPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.header">
<code class="sig-name descname">header</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.lgals">
<code class="sig-name descname">lgals</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.lgals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.lgals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.linear_field">
<code class="sig-name descname">linear_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.linear_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.linear_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.linear_field_zspace">
<code class="sig-name descname">linear_field_zspace</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.linear_field_zspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.linear_field_zspace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.load_subhalo">
<code class="sig-name descname">load_subhalo</code><span class="sig-paren">(</span><em class="sig-param">cat_type</em>, <em class="sig-param">Sorted=False</em>, <em class="sig-param">top=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.load_subhalo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.load_subhalo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.lptPower">
<code class="sig-name descname">lptPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.lptPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.lptPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.lpt_field">
<code class="sig-name descname">lpt_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.lpt_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.lpt_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.neutrino_density_field">
<code class="sig-name descname">neutrino_density_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.neutrino_density_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.neutrino_density_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.nuPower">
<code class="sig-name descname">nuPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.nuPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.nuPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.orphancat">
<code class="sig-name descname">orphancat</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.orphancat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.orphancat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.plots">
<code class="sig-name descname">plots</code><span class="sig-paren">(</span><em class="sig-param">block=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.plots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.qPower">
<code class="sig-name descname">qPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.qPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.qPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.qdata">
<code class="sig-name descname">qdata</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.qdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.qdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdm">
<code class="sig-name descname">sdm</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdmPower">
<code class="sig-name descname">sdmPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdmPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdmPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdm_density_field">
<code class="sig-name descname">sdm_density_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdm_density_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdm_density_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdm_in_haloes">
<code class="sig-name descname">sdm_in_haloes</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdm_in_haloes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdm_in_haloes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdm_qdata">
<code class="sig-name descname">sdm_qdata</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdm_qdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdm_qdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdm_theta_field">
<code class="sig-name descname">sdm_theta_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdm_theta_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdm_theta_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdm_velocity_field">
<code class="sig-name descname">sdm_velocity_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdm_velocity_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdm_velocity_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdmqPower">
<code class="sig-name descname">sdmqPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdmqPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdmqPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sdmzPower">
<code class="sig-name descname">sdmzPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sdmzPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sdmzPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.select_random">
<code class="sig-name descname">select_random</code><span class="sig-paren">(</span><em class="sig-param">size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.select_random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.select_random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.select_top_subhalos">
<code class="sig-name descname">select_top_subhalos</code><span class="sig-paren">(</span><em class="sig-param">top=None</em>, <em class="sig-param">arg='vmax'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.select_top_subhalos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.select_top_subhalos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.set_halo_particles">
<code class="sig-name descname">set_halo_particles</code><span class="sig-paren">(</span><em class="sig-param">ihalo</em>, <em class="sig-param">value</em>, <em class="sig-param">sDM=False</em>, <em class="sig-param">key='pos'</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">wrap=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.set_halo_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.set_halo_particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.store_and_load_sdm_statistics">
<code class="sig-name descname">store_and_load_sdm_statistics</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_method='sampled'</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">gadget_pk=False</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.store_and_load_sdm_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.store_and_load_sdm_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>To load power spectrum, correlation function &amp; bispectrum from file.</p>
<p>If the file does not exist or force_recompute is True, these quantities
are computed and stored to file, before being returned.</p>
<p>TODO: could possibly become part of self.sdmPower</p>
</dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.store_and_load_statistics">
<code class="sig-name descname">store_and_load_statistics</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_method='sampled'</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">dilution=None</em>, <em class="sig-param">gadget_pk=False</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.store_and_load_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.store_and_load_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>To load power spectrum, correlation function &amp; bispectrum from file.</p>
<p>If the file does not exist or force_recompute is True, these quantities
are computed and stored to file, before being returned.</p>
<p>If dilution is not None, it must contain the dilution level expressed as
the percentage of particles to RETAIN (so, dilution=0.2 will create a
catalogue containing the 20% of the original catalogue).</p>
<p>TODO: could possibly become part of self.Power</p>
</dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.store_and_load_xspectra">
<code class="sig-name descname">store_and_load_xspectra</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_method='brute-force'</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">dilution=None</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.store_and_load_xspectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.store_and_load_xspectra" title="Permalink to this definition">¶</a></dt>
<dd><p>To load cross power spectrum from file.</p>
<p>If the file does not exist or force_recompute is True, these quantity
is computed and stored to file, before being returned.</p>
<p>If dilution is not None, it must contain the dilution level expressed as
the percentage of particles to RETAIN (so, dilution=0.2 will create a
catalogue containing the 20% of the original catalogue).</p>
</dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sub">
<code class="sig-name descname">sub</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sub"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subHOD">
<code class="sig-name descname">subHOD</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subHOD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subHOD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subPower">
<code class="sig-name descname">subPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.sub_qdata">
<code class="sig-name descname">sub_qdata</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.sub_qdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.sub_qdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_Correl">
<code class="sig-name descname">subhalo_Correl</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.subhalo_Correl_tmp">
<code class="sig-name descname">subhalo_Correl_tmp</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">compute_noOrphans=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_Correl_tmp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_Correl_tmp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_multipoles">
<code class="sig-name descname">subhalo_multipoles</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_multipoles_vmax">
<code class="sig-name descname">subhalo_multipoles_vmax</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_multipoles_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_multipoles_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_multipoles_vpeak">
<code class="sig-name descname">subhalo_multipoles_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_multipoles_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_multipoles_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_pmulti_vpeak">
<code class="sig-name descname">subhalo_pmulti_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_pmulti_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_pmulti_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_power_vmax">
<code class="sig-name descname">subhalo_power_vmax</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_power_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_power_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_power_vmax_real">
<code class="sig-name descname">subhalo_power_vmax_real</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_power_vmax_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_power_vmax_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_power_vpeak">
<code class="sig-name descname">subhalo_power_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_power_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_power_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_power_vpeak_real">
<code class="sig-name descname">subhalo_power_vpeak_real</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_power_vpeak_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_power_vpeak_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.subhalo_zCorrel">
<code class="sig-name descname">subhalo_zCorrel</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.subhalo_zCorrel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.subhalo_zCorrel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.Simulation.tetimage">
<code class="sig-name descname">tetimage</code><span class="sig-paren">(</span><em class="sig-param">ngrid=512</em>, <em class="sig-param">box=None</em>, <em class="sig-param">pos=None</em>, <em class="sig-param">ids=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">deconvolve=True</em>, <em class="sig-param">nthreads=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.tetimage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.tetimage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.thetaPower">
<code class="sig-name descname">thetaPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.thetaPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.thetaPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.theta_field">
<code class="sig-name descname">theta_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.theta_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.theta_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.totPower">
<code class="sig-name descname">totPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.totPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.totPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.tree">
<code class="sig-name descname">tree</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.tree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.velocity_field">
<code class="sig-name descname">velocity_field</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.velocity_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.velocity_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.zPower">
<code class="sig-name descname">zPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.zPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.zPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.zhaloPower">
<code class="sig-name descname">zhaloPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.zhaloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.zhaloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.zhaloPower_100particles">
<code class="sig-name descname">zhaloPower_100particles</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.zhaloPower_100particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.zhaloPower_100particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.zqPower">
<code class="sig-name descname">zqPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.zqPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.zqPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.Simulation.zsubPower">
<code class="sig-name descname">zsubPower</code><a class="reference internal" href="_modules/bacco/simulation.html#Simulation.zsubPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.Simulation.zsubPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="bacco.simulation.PairedSimulation">
<em class="property">class </em><code class="sig-prename descclassname">bacco.simulation.</code><code class="sig-name descname">PairedSimulation</code><span class="sig-paren">(</span><em class="sig-param">sim_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.BiasMass">
<code class="sig-name descname">BiasMass</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.BiasMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.BiasMass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.ConcentrationMass">
<code class="sig-name descname">ConcentrationMass</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.ConcentrationMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.ConcentrationMass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.MassFunction">
<code class="sig-name descname">MassFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.MassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.MassFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.Power">
<code class="sig-name descname">Power</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.Power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.Power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.SubhaloMassFunction">
<code class="sig-name descname">SubhaloMassFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.SubhaloMassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.SubhaloMassFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.VmaxFunction">
<code class="sig-name descname">VmaxFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.VmaxFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.VmaxFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.VpeakFunction">
<code class="sig-name descname">VpeakFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.VpeakFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.VpeakFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><em class="sig-param">attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_haloPower">
<code class="sig-name descname">compute_haloPower</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_haloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_haloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_halo_Correl">
<code class="sig-name descname">compute_halo_Correl</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_halo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_halo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_halo_bispectrum">
<code class="sig-name descname">compute_halo_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_halo_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_halo_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_halo_multipoles">
<code class="sig-name descname">compute_halo_multipoles</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_halo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_halo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_hmm_bispectrum">
<code class="sig-name descname">compute_hmm_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_hmm_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_hmm_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_sdm_bispectrum">
<code class="sig-name descname">compute_sdm_bispectrum</code><span class="sig-paren">(</span><em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_sdm_bispectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_sdm_bispectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_subPower">
<code class="sig-name descname">compute_subPower</code><span class="sig-paren">(</span><em class="sig-param">prop='mpeak'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">Mask_Type=2</em>, <em class="sig-param">alive_allsats=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_subPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_subPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_subhalo_Correl">
<code class="sig-name descname">compute_subhalo_Correl</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_subhalo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_subhalo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_subhalo_multipoles">
<code class="sig-name descname">compute_subhalo_multipoles</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_subhalo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_subhalo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_subhalo_multipoles_JN">
<code class="sig-name descname">compute_subhalo_multipoles_JN</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">n_jn3=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_subhalo_multipoles_JN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_subhalo_multipoles_JN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.compute_subhalo_powerspectrum">
<code class="sig-name descname">compute_subhalo_powerspectrum</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.compute_subhalo_powerspectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.compute_subhalo_powerspectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.haloPower">
<code class="sig-name descname">haloPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.haloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.haloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.haloPower_100particles">
<code class="sig-name descname">haloPower_100particles</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.haloPower_100particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.haloPower_100particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.qPower">
<code class="sig-name descname">qPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.qPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.qPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.sdmPower">
<code class="sig-name descname">sdmPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.sdmPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.sdmPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.sdmzPower">
<code class="sig-name descname">sdmzPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.sdmzPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.sdmzPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.store_and_load_sdm_statistics">
<code class="sig-name descname">store_and_load_sdm_statistics</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">linear_field=False</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">clean_dm=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.store_and_load_sdm_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.store_and_load_sdm_statistics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.store_and_load_statistics">
<code class="sig-name descname">store_and_load_statistics</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">linear_field=False</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">dilution=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.store_and_load_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.store_and_load_statistics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.PairedSimulation.store_and_load_xspectra">
<code class="sig-name descname">store_and_load_xspectra</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_method='brute-force'</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">clean_dm=True</em>, <em class="sig-param">dilution=None</em>, <em class="sig-param">lpt_field=False</em>, <em class="sig-param">linear_field=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.store_and_load_xspectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.store_and_load_xspectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subPower">
<code class="sig-name descname">subPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subhalo_multipoles_vmax">
<code class="sig-name descname">subhalo_multipoles_vmax</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subhalo_multipoles_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subhalo_multipoles_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subhalo_multipoles_vpeak">
<code class="sig-name descname">subhalo_multipoles_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subhalo_multipoles_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subhalo_multipoles_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subhalo_power_vmax">
<code class="sig-name descname">subhalo_power_vmax</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subhalo_power_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subhalo_power_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subhalo_power_vmax_real">
<code class="sig-name descname">subhalo_power_vmax_real</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subhalo_power_vmax_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subhalo_power_vmax_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subhalo_power_vpeak">
<code class="sig-name descname">subhalo_power_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subhalo_power_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subhalo_power_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.subhalo_power_vpeak_real">
<code class="sig-name descname">subhalo_power_vpeak_real</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.subhalo_power_vpeak_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.subhalo_power_vpeak_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.totPower">
<code class="sig-name descname">totPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.totPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.totPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.zPower">
<code class="sig-name descname">zPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.zPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.zPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.zhaloPower">
<code class="sig-name descname">zhaloPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.zhaloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.zhaloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.zhaloPower_100particles">
<code class="sig-name descname">zhaloPower_100particles</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.zhaloPower_100particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.zhaloPower_100particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.zqPower">
<code class="sig-name descname">zqPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.zqPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.zqPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.PairedSimulation.zsubPower">
<code class="sig-name descname">zsubPower</code><a class="reference internal" href="_modules/bacco/simulation.html#PairedSimulation.zsubPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.PairedSimulation.zsubPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="bacco.simulation.ScaledSimulation">
<em class="property">class </em><code class="sig-prename descclassname">bacco.simulation.</code><code class="sig-name descname">ScaledSimulation</code><span class="sig-paren">(</span><em class="sig-param">cosmology</em>, <em class="sig-param">basedir='./'</em>, <em class="sig-param">dm_file=None</em>, <em class="sig-param">halo_file=None</em>, <em class="sig-param">paired=True</em>, <em class="sig-param">conc_correction=True</em>, <em class="sig-param">lss_correction=True</em>, <em class="sig-param">use_orphans=True</em>, <em class="sig-param">A_s=None</em>, <em class="sig-param">baryons={}</em>, <em class="sig-param">Arr_Snap1=None</em>, <em class="sig-param">Arr_Snap2=None</em>, <em class="sig-param">Nsnap=None</em>, <em class="sig-param">interpolate_snaps=True</em>, <em class="sig-param">scl_sdm=None</em>, <em class="sig-param">scl_halos=None</em>, <em class="sig-param">scl_sub=None</em>, <em class="sig-param">fof_props=[]</em>, <em class="sig-param">sub_props=[]</em>, <em class="sig-param">use_half=False</em>, <em class="sig-param">verbose=None</em>, <em class="sig-param">**scaler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.BiasMass">
<code class="sig-name descname">BiasMass</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.BiasMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.BiasMass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.ConcentrationMass">
<code class="sig-name descname">ConcentrationMass</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.ConcentrationMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.ConcentrationMass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.MassFunction">
<code class="sig-name descname">MassFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.MassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.MassFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.Power">
<code class="sig-name descname">Power</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.Power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.Power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.SubhaloMassFunction">
<code class="sig-name descname">SubhaloMassFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.SubhaloMassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.SubhaloMassFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.VmaxFunction">
<code class="sig-name descname">VmaxFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.VmaxFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.VmaxFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.VpeakFunction">
<code class="sig-name descname">VpeakFunction</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.VpeakFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.VpeakFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><em class="sig-param">attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_haloPower">
<code class="sig-name descname">compute_haloPower</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_haloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_haloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_halo_Correl">
<code class="sig-name descname">compute_halo_Correl</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_halo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_halo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_halo_multipoles">
<code class="sig-name descname">compute_halo_multipoles</code><span class="sig-paren">(</span><em class="sig-param">prop='halo_mfof'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_halo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_halo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_subPower">
<code class="sig-name descname">compute_subPower</code><span class="sig-paren">(</span><em class="sig-param">prop='mpeak'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.11</em>, <em class="sig-param">Mask_Type=2</em>, <em class="sig-param">alive_allsats=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_subPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_subPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_subhalo_Correl">
<code class="sig-name descname">compute_subhalo_Correl</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_subhalo_Correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_subhalo_Correl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_subhalo_multipoles">
<code class="sig-name descname">compute_subhalo_multipoles</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_subhalo_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_subhalo_multipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_subhalo_multipoles_JN">
<code class="sig-name descname">compute_subhalo_multipoles_JN</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em>, <em class="sig-param">mergertime_factor=1.1</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">n_jn3=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_subhalo_multipoles_JN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_subhalo_multipoles_JN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.simulation.ScaledSimulation.compute_subhalo_powerspectrum">
<code class="sig-name descname">compute_subhalo_powerspectrum</code><span class="sig-paren">(</span><em class="sig-param">prop='vmax'</em>, <em class="sig-param">cut=None</em>, <em class="sig-param">n=0.001</em>, <em class="sig-param">Mhalo_lim=None</em>, <em class="sig-param">zspace=True</em>, <em class="sig-param">compute_noOrphans=False</em>, <em class="sig-param">no_destruction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.compute_subhalo_powerspectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.compute_subhalo_powerspectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.haloPower">
<code class="sig-name descname">haloPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.haloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.haloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.haloPower_100particles">
<code class="sig-name descname">haloPower_100particles</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.haloPower_100particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.haloPower_100particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.sdmPower">
<code class="sig-name descname">sdmPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.sdmPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.sdmPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.sdmzPower">
<code class="sig-name descname">sdmzPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.sdmzPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.sdmzPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subPower">
<code class="sig-name descname">subPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_multipoles_vmax">
<code class="sig-name descname">subhalo_multipoles_vmax</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_multipoles_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_multipoles_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_multipoles_vpeak">
<code class="sig-name descname">subhalo_multipoles_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_multipoles_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_multipoles_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_pmulti_vpeak">
<code class="sig-name descname">subhalo_pmulti_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_pmulti_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_pmulti_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_power_vmax">
<code class="sig-name descname">subhalo_power_vmax</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_power_vmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_power_vmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_power_vmax_real">
<code class="sig-name descname">subhalo_power_vmax_real</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_power_vmax_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_power_vmax_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_power_vpeak">
<code class="sig-name descname">subhalo_power_vpeak</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_power_vpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_power_vpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.subhalo_power_vpeak_real">
<code class="sig-name descname">subhalo_power_vpeak_real</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.subhalo_power_vpeak_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.subhalo_power_vpeak_real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.zPower">
<code class="sig-name descname">zPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.zPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.zPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.zhaloPower">
<code class="sig-name descname">zhaloPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.zhaloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.zhaloPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.zhaloPower_100particles">
<code class="sig-name descname">zhaloPower_100particles</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.zhaloPower_100particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.zhaloPower_100particles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="bacco.simulation.ScaledSimulation.zsubPower">
<code class="sig-name descname">zsubPower</code><a class="reference internal" href="_modules/bacco/simulation.html#ScaledSimulation.zsubPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.simulation.ScaledSimulation.zsubPower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco.statistics">
<span id="bacco-statistics-module"></span><h2>bacco.statistics module<a class="headerlink" href="#module-bacco.statistics" title="Permalink to this headline">¶</a></h2>
<p>A collection of miscelaneous functions</p>
<dl class="function">
<dt id="bacco.statistics.compute_powerspectrum">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_powerspectrum</code><span class="sig-paren">(</span><em class="sig-param">ngrid=None</em>, <em class="sig-param">box=None</em>, <em class="sig-param">pos=None</em>, <em class="sig-param">vel=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">unit_in_Mpc=1</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">log_binning=None</em>, <em class="sig-param">log_binning_kmax=None</em>, <em class="sig-param">log_binning_nbins=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">cosmology=None</em>, <em class="sig-param">pmulti_interp='polyfit'</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">grid1=None</em>, <em class="sig-param">dilution=None</em>, <em class="sig-param">folds=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_powerspectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_powerspectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_twopointcorr">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_twopointcorr</code><span class="sig-paren">(</span><em class="sig-param">pos=None</em>, <em class="sig-param">ran=None</em>, <em class="sig-param">vel=None</em>, <em class="sig-param">box=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">cosmology=None</em>, <em class="sig-param">method='tree'</em>, <em class="sig-param">random=None</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">ngrid=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_twopointcorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_twopointcorr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_crossspectrum">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_crossspectrum</code><span class="sig-paren">(</span><em class="sig-param">pos1=None</em>, <em class="sig-param">pos2=None</em>, <em class="sig-param">vel1=None</em>, <em class="sig-param">vel2=None</em>, <em class="sig-param">grid2=None</em>, <em class="sig-param">ngrid=None</em>, <em class="sig-param">box=None</em>, <em class="sig-param">mass1=None</em>, <em class="sig-param">mass2=None</em>, <em class="sig-param">bs_method=None</em>, <em class="sig-param">bs_num_triangles=10000</em>, <em class="sig-param">bs_k1=0.01</em>, <em class="sig-param">bs_k2=None</em>, <em class="sig-param">bs_deltak=None</em>, <em class="sig-param">interlacing=None</em>, <em class="sig-param">deposit_method=None</em>, <em class="sig-param">log_binning=None</em>, <em class="sig-param">log_binning_kmax=None</em>, <em class="sig-param">log_binning_nbins=None</em>, <em class="sig-param">zspace=False</em>, <em class="sig-param">cosmology=None</em>, <em class="sig-param">nthreads=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_crossspectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_crossspectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_halo_mass_function">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_halo_mass_function</code><span class="sig-paren">(</span><em class="sig-param">sim</em>, <em class="sig-param">Njk=4</em>, <em class="sig-param">convert_kpc_to_Mpc=False</em>, <em class="sig-param">show_plot=False</em>, <em class="sig-param">qty='dn_dlnM'</em>, <em class="sig-param">mdef='mfof'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_halo_mass_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_halo_mass_function" title="Permalink to this definition">¶</a></dt>
<dd><p>halo_mass_function(sim, convert_kpc_to_Mpc=True)</p>
<p>Compute and the halo mass function and its covariance matrix.
The units of the HMF are h^{4} Mpc^{-3} <a href="#id35"><span class="problematic" id="id36">M_</span></a>odot^{-1}. The covariance
matrix is computed with a jackknife, dividing each dimension into Njk
cells (default is 4). Note that an improved jackkinfe is implemented
here, following arXiv:1503.00313.</p>
<p>If convert_kpc_2o_Mpc=True halo positions are assumed to be in kpc/h
and are converted to Mpc/h. Otherwise, they are assumed to already be
in Mpc/h and no correction is applied.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_concentration">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_concentration</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">density</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an NFW profile to the input density profile.
Inputs: radii/r_200 and density in [h^2 Msun/Mpc^3]
Returns the scale radius (rs), the typical density (rhoc), and the best-fit profile evalutated at</p>
<blockquote>
<div><p>the input radii</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_multipoles">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_multipoles</code><span class="sig-paren">(</span><em class="sig-param">pos, box, order=[0, 2, 4], rmin=0.1, rmax=150, log_rmin=None, log_rmax=None, nbin=50, n_mubin=10, axis_zsd=2, method='halotools', random=None, seed=None, nthreads=None, logspace=False, rbins=None, zspace=False, cosmology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the multipoles of xi with halotools.
more info:
-<a class="reference external" href="http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.s_mu_tpcf.html#halotools.mock_observables.s_mu_tpcf">http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.s_mu_tpcf.html#halotools.mock_observables.s_mu_tpcf</a>
-<a class="reference external" href="http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.tpcf_multipole.html#halotools.mock_observables.tpcf_multipole">http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.tpcf_multipole.html#halotools.mock_observables.tpcf_multipole</a>
If zspace is False, it assume the redshift space distortion effect
is already include in the position
TODO: Add a simulation implementation, improve this description</p>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_twopointcorr_jackknife">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_twopointcorr_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pos</em>, <em class="sig-param">box</em>, <em class="sig-param">rmin=0.001</em>, <em class="sig-param">rmax=150</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">random=None</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_twopointcorr_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_twopointcorr_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute 2PCF and their jackknife errorsself.</dt><dd><p>The Jackknife samples are done removing cubic subsamples
from the primary (not secondary) galaxy sampleself.
The number of jackknife samples are equaly to n_jn3^3</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array</em>) – Position of the objects</p></li>
<li><p><strong>box</strong> (<em>float</em>) – Size of the periodic comoving box of the simulation</p></li>
<li><p><strong>rmin</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given, defaults to 0.01</p></li>
<li><p><strong>rmax</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3, defaults to 150</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘r’ array, defaults to 50</p></li>
<li><p><strong>random</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points used to compute the multipoles. None means all the points, defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Algorithm to compute the multipoles. Corrfunc is the only working right now. defaults to “Corrfunc”</p></li>
<li><p><strong>n_jn3</strong> (<em>int</em><em>, </em><em>optional</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3., defaults to 3</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of threads, defaults to None</p></li>
<li><p><strong>rbins</strong> (<em>list</em><em> , </em><em>optional</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins., defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The correlation function and their jn errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_wp_jackknife">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_wp_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pos</em>, <em class="sig-param">box</em>, <em class="sig-param">pi_max=20.0</em>, <em class="sig-param">rmin=0.1</em>, <em class="sig-param">rmax=50</em>, <em class="sig-param">nbin=50</em>, <em class="sig-param">method='Corrfunc'</em>, <em class="sig-param">n_jn3=3</em>, <em class="sig-param">random=None</em>, <em class="sig-param">nthreads=None</em>, <em class="sig-param">seed=None</em>, <em class="sig-param">NtimesRandom=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_wp_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_wp_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute wp jackknife.</dt><dd><p>For halotools check:
<a class="reference external" href="http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.wp_jackknife.html#halotools.mock_observables.wp_jackknife">http://halotools.readthedocs.io/en/latest/api/halotools.mock_observables.wp_jackknife.html#halotools.mock_observables.wp_jackknife</a>
For Corrfunc:
The Jackknife samples are done removing cubic subsamples
from the primary (not secondary) galaxy sampleself.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array</em>) – Position of the objects</p></li>
<li><p><strong>box</strong> (<em>float</em>) – Size of the periodic comoving box of the simulation</p></li>
<li><p><strong>pi_max</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum value of pi to integrate, defaults to 20.</p></li>
<li><p><strong>rmax</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3, defaults to 150</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘r’ array, defaults to 50</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Algorithm to compute the multipoles. Corrfunc and halotools are the only working right now. defaults to “Corrfunc”</p></li>
<li><p><strong>n_jn3</strong> (<em>int</em><em>, </em><em>optional</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3., defaults to 3</p></li>
<li><p><strong>random</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points used to compute the multipoles. None means all the points, defaults to None</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of threads, defaults to None</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – value of the random seed, defaults to None</p></li>
<li><p><strong>NtimesRandom</strong> (<em>int</em><em>, </em><em>optional</em>) – number of randoms relative to the original sample, defaults to 10</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>projected correlation function and covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_multipoles_jackknife">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_multipoles_jackknife</code><span class="sig-paren">(</span><em class="sig-param">pos, box, rmin=0.01, rmax=150, nbin=50, n_mubin=10, random=None, method='Corrfunc', n_jn3=3, nthreads=None, order=[0, 2, 4], rbins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_multipoles_jackknife"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_multipoles_jackknife" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute xi_l and their jackknife errorsself.</dt><dd><p>The Jackknife samples are done removing cubic subsamples
from the primary (not secondary) galaxy sample.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array</em>) – Position of the objects</p></li>
<li><p><strong>box</strong> (<em>float</em>) – Size of the periodic comoving box of the simulation</p></li>
<li><p><strong>rmin</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum value of ‘r’ were wp is measured, not valid if rbins is given, defaults to 0.01</p></li>
<li><p><strong>rmax</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum value of ‘r’ were wp is measured, not valid if rbins is given. It has to be &lt; box/3, defaults to 150</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘r’ array, defaults to 50</p></li>
<li><p><strong>n_mubin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins of ‘mu’ array, defaults to 10</p></li>
<li><p><strong>random</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points used to compute the multipoles. None means all the points, defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Algorithm to compute the multipoles. Corrfunc is the only working right now. defaults to “Corrfunc”</p></li>
<li><p><strong>n_jn3</strong> (<em>int</em><em>, </em><em>optional</em>) – cubic root of the number of jackknife samples (eg. jn3 = 5 -&gt; spliting the cubic periodic 
box in 125 part, 5 per dimentions). Is strongly recomended that rmax &lt;= Lbox/jn3., defaults to 3</p></li>
<li><p><strong>nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of threads, defaults to None</p></li>
<li><p><strong>order</strong> (<em>list</em><em>, </em><em>optional</em>) – Array of int, with the order to compute the multipoles (use for now [0,2,4] only, 
monopole, quadrupole and hexadecapole), defaults to [0, 2, 4]</p></li>
<li><p><strong>rbins</strong> (<em>list</em><em> , </em><em>optional</em>) – Array of float of leanght nbins+1. Edges of the ‘r’ bins., defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The multipoles and their jn errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_theory_error_cov">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_theory_error_cov</code><span class="sig-paren">(</span><em class="sig-param">corr_scale</em>, <em class="sig-param">xx</em>, <em class="sig-param">comp_envelope=False</em>, <em class="sig-param">Env=None</em>, <em class="sig-param">physical_quantity=None</em>, <em class="sig-param">Env_amp=None</em>, <em class="sig-param">xx_amp=None</em>, <em class="sig-param">method='lin_interpol'</em>, <em class="sig-param">etype='gpy'</em>, <em class="sig-param">emul_points=50</em>, <em class="sig-param">variance_emul=1</em>, <em class="sig-param">corr_scale_emul=1</em>, <em class="sig-param">num_restarts=9</em>, <em class="sig-param">seed=1</em>, <em class="sig-param">gaussian_error=None</em>, <em class="sig-param">fix_hyperparams=False</em>, <em class="sig-param">noise_stdev_emul=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_theory_error_cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_theory_error_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the covariance matrix for the theory errors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_scale</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>xx</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>comp_envelope</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description], defaults to False</p></li>
<li><p><strong>Env</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>physical_quantity</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>Env_amp</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>xx_amp</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – [description], defaults to “lin_interpol”</p></li>
<li><p><strong>etype</strong> (<em>str</em><em>, </em><em>optional</em>) – [description], defaults to ‘gpy’</p></li>
<li><p><strong>emul_points</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 50</p></li>
<li><p><strong>variance_emul</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 1</p></li>
<li><p><strong>corr_scale_emul</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 1</p></li>
<li><p><strong>num_restarts</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 9</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], defaults to 1</p></li>
<li><p><strong>gaussian_error</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to None</p></li>
<li><p><strong>fix_hyperparams</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description], defaults to False</p></li>
<li><p><strong>noise_stdev_emul</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description], defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.statistics.compute_gaussian_error_multipoles_power">
<code class="sig-prename descclassname">bacco.statistics.</code><code class="sig-name descname">compute_gaussian_error_multipoles_power</code><span class="sig-paren">(</span><em class="sig-param">l1</em>, <em class="sig-param">l2</em>, <em class="sig-param">mono</em>, <em class="sig-param">quad</em>, <em class="sig-param">hexa</em>, <em class="sig-param">Vol</em>, <em class="sig-param">nmean</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/statistics.html#compute_gaussian_error_multipoles_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.statistics.compute_gaussian_error_multipoles_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the gaussian error of the multipoles of the power spectrum
divided by the volume. The actual P(k) error is this times the volume,
divided by the number of modes in each wavemode bin.
Attention: Vol corresponds to the volume in real space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l1</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>l2</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>mono</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>quad</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>hexa</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>Vol</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>nmean</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="bacco-tf-vis-module">
<h2>bacco.tf_vis module<a class="headerlink" href="#bacco-tf-vis-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-bacco.utils">
<span id="bacco-utils-module"></span><h2>bacco.utils module<a class="headerlink" href="#module-bacco.utils" title="Permalink to this headline">¶</a></h2>
<p>A collection of miscelaneous functions</p>
<dl class="function">
<dt id="bacco.utils.crossmatch">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">crossmatch</code><span class="sig-paren">(</span><em class="sig-param">X1</em>, <em class="sig-param">X2</em>, <em class="sig-param">max_distance=inf</em>, <em class="sig-param">neighbour=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#crossmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.crossmatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.sigma_displacement">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">sigma_displacement</code><span class="sig-paren">(</span><em class="sig-param">kk</em>, <em class="sig-param">pk</em>, <em class="sig-param">lbox=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#sigma_displacement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.sigma_displacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="bacco.utils.cached_property">
<em class="property">class </em><code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">cached_property</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">name=None</em>, <em class="sig-param">doc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#cached_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.cached_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A decorator that converts a function into a lazy property.  The
function wrapped is called the first time to retrieve the result
and then that calculated result is used the next time you access
the value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># calculate something important here</span>
        <span class="k">return</span> <span class="mi">42</span>
</pre></div>
</div>
<p>The class has to have a <cite>__dict__</cite> in order for this property to
work.</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.load_powerspec_MS">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">load_powerspec_MS</code><span class="sig-paren">(</span><em class="sig-param">redshift=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#load_powerspec_MS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.load_powerspec_MS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.sbesselj0">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">sbesselj0</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#sbesselj0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.sbesselj0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.sbesselj1">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">sbesselj1</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#sbesselj1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.sbesselj1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.xi2pk">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">xi2pk</code><span class="sig-paren">(</span><em class="sig-param">rr</em>, <em class="sig-param">xi</em>, <em class="sig-param">kk</em>, <em class="sig-param">lbox=None</em>, <em class="sig-param">FFTLog=True</em>, <em class="sig-param">smooth_cutoff=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#xi2pk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.xi2pk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.pk2xi">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">pk2xi</code><span class="sig-paren">(</span><em class="sig-param">kk</em>, <em class="sig-param">pk</em>, <em class="sig-param">rr</em>, <em class="sig-param">jn=0</em>, <em class="sig-param">lbox=None</em>, <em class="sig-param">Log=True</em>, <em class="sig-param">FFTLog=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#pk2xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.pk2xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the correlation function from a tabulated power spectrum data
TODO: Rewrite variables to utilize the same Bessel function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kk</strong> – Wavevectors</p></li>
<li><p><strong>pk</strong> – Power spectrum</p></li>
<li><p><strong>rr</strong> – Values at which to compute the correlation function</p></li>
<li><p><strong>Log</strong> – Decide whether the interpolation is done in linear or logarithmic scales</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.sigmaR">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">sigmaR</code><span class="sig-paren">(</span><em class="sig-param">kk</em>, <em class="sig-param">pk</em>, <em class="sig-param">rr</em>, <em class="sig-param">omegaM=0.25</em>, <em class="sig-param">lbox=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#sigmaR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.sigmaR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.make_pk2d">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">make_pk2d</code><span class="sig-paren">(</span><em class="sig-param">kk</em>, <em class="sig-param">pk</em>, <em class="sig-param">mu</em>, <em class="sig-param">beta=1</em>, <em class="sig-param">sigma_s=1</em>, <em class="sig-param">RSD=True</em>, <em class="sig-param">FOG='gaussian'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#make_pk2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.make_pk2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.ximulti">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">ximulti</code><span class="sig-paren">(</span><em class="sig-param">rr</em>, <em class="sig-param">kk</em>, <em class="sig-param">p_ell</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#ximulti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.ximulti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.pkmulti">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">pkmulti</code><span class="sig-paren">(</span><em class="sig-param">kk</em>, <em class="sig-param">mu</em>, <em class="sig-param">pk2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#pkmulti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.pkmulti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.xibar">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">xibar</code><span class="sig-paren">(</span><em class="sig-param">rr</em>, <em class="sig-param">xi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#xibar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.xibar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bacco.utils.create_dir">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">create_dir</code><span class="sig-paren">(</span><em class="sig-param">directory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#create_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.create_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>We try to create a directory. If it exists, we ignore the error. We catch any other error</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.read_parameter_file">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">read_parameter_file</code><span class="sig-paren">(</span><em class="sig-param">parameter_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#read_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.read_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the parameters file of a simulation</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.write_parameter_file">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">write_parameter_file</code><span class="sig-paren">(</span><em class="sig-param">parameter_file</em>, <em class="sig-param">pars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#write_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.write_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the parameters file of a simulation</p>
</dd></dl>

<dl class="function">
<dt id="bacco.utils.remove_IDs_HDF5">
<code class="sig-prename descclassname">bacco.utils.</code><code class="sig-name descname">remove_IDs_HDF5</code><span class="sig-paren">(</span><em class="sig-param">basedir=None</em>, <em class="sig-param">halo_file=None</em>, <em class="sig-param">snaplist=None</em>, <em class="sig-param">lastsnap=None</em>, <em class="sig-param">pair=False</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/utils.html#remove_IDs_HDF5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.utils.remove_IDs_HDF5" title="Permalink to this definition">¶</a></dt>
<dd><p>Delect IDs folder from the groups in the HDF5 files.</p>
<p>BETA! not elegant (not even close…) needs h5repack installed</p>
<p>basedir:   The directory of the simulation, eg. /scratch/user/LCDM_L04096N32768
halo_file: The name of the halofile of ANY snapshot (even if it is not in snaplist), eg.
groups_001/fof_subhalo_history_tab_orph_wweight_001
snaplist:  The list of snapshots to clean, eg. [7,14,21]
lastsnap:  The final snapshot to clean, eg. 100. Use snaplist OR lastsnap
pair:      If there are Pair simulations
verbose:   verbose</p>
<p>If snaplist is given, it will fix only a particular set of snapshots.
If lastsnap is given, it will fix all snapshot untill that snapshot (included)
if a snapshot is missing, the code will <em>not</em> stop
If neither snaplist or lastsnap is given, the code will run from group_000 until
there is no groups</p>
</dd></dl>

</div>
<div class="section" id="module-bacco.visualization">
<span id="bacco-visualization-module"></span><h2>bacco.visualization module<a class="headerlink" href="#module-bacco.visualization" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the ‘Simulation’ class and helper functions</p>
<dl class="class">
<dt id="bacco.visualization.Visualization">
<em class="property">class </em><code class="sig-prename descclassname">bacco.visualization.</code><code class="sig-name descname">Visualization</code><span class="sig-paren">(</span><em class="sig-param">pos=None, simulation=None, npix=[128, 128], boxsize=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Visualization class</p>
<p>in principle this should simply take a simulation object
and offer several methods to visualize the simulattion simply</p>
<p>since the simulation objects are not working for generic 
cases, right now the current default usage is to provide
an (idsorted) position array and the boxsize</p>
<dl class="method">
<dt id="bacco.visualization.Visualization.get_pos">
<code class="sig-name descname">get_pos</code><span class="sig-paren">(</span><em class="sig-param">a=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.get_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.get_pos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.image">
<code class="sig-name descname">image</code><span class="sig-paren">(</span><em class="sig-param">maxngrid=0</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">show=False</em>, <em class="sig-param">wrapto=None</em>, <em class="sig-param">spherical_smoothing=None</em>, <em class="sig-param">rbins=None</em>, <em class="sig-param">rfac=None</em>, <em class="sig-param">tetnbody=None</em>, <em class="sig-param">mass=1.0</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws (resampled interpolated) particles using a projection matrix</p>
<p>This function use the sheet interpolation to create interpolated
pseudo particles which are binned to an image. The parameters
control projection, refinement, weighting, binning and wrapping</p>
<dl class="simple">
<dt>pos<span class="classifier">numpy array of float 32 with shape (npart, 3)</span></dt><dd><p>input positions which are assumed to be sorted (unless ids given)</p>
</dd>
<dt>projection<span class="classifier">numpy array of float 32 with shape (4,4) </span></dt><dd><p>matrix that is used to project the positions to the image
plane (which goes from [-0.5,0.5] in x and y and [0,1] in z for
distance clipping). Best to use functions to define it</p>
</dd>
<dt>npix<span class="classifier">tuple with 2 ints of form (npix_x, npix_y)</span></dt><dd><p>defines x and y pixel resolution</p>
</dd>
<dt>boxsize<span class="classifier">float</span></dt><dd><p>boxsize (used for periodic wrapping – to [-L/2, L/2])</p>
</dd>
<dt>wrapto<span class="classifier">tuple with 3 floats of form (x, y, z)</span></dt><dd><p>(if boxsize &gt; 0.) the wrapping is done sothat (x,y,z) is the
center of the box (note that no shift is applied). Usually you 
should use wrapto = lookat (or eye) when using a lookat matrix</p>
</dd>
<dt>maxngrid<span class="classifier">integer</span></dt><dd><p>maximum resampled particles per tet per dimension (in the default
deposit mode the number of resampled particles is set exactly to 
this)</p>
</dd>
<dt>nthreads: integer</dt><dd><p>number of openmp threads</p>
</dd>
</dl>
<dl class="simple">
<dt>ndeposit<span class="classifier">int32 array of length npart to specify the deposit depth</span></dt><dd><p>for each tet (limitted to maxngrid)</p>
</dd>
<dt>fade<span class="classifier">tuple of two float32 arrays of form tuple(ri, fi)</span></dt><dd><p>ri specifies a set of distances and fi specifies the weight 
particles at each distance should be multiplied with</p>
</dd>
<dt>spherical<span class="classifier">boolean</span></dt><dd><p>set to True to use equirectangular projection</p>
</dd>
<dt>rclip<span class="classifier">tuple of two float32 (rnear, rfar)</span></dt><dd><p>clipping boundaries in case of spherical projection (ignored 
otherwise)</p>
</dd>
<dt>mass<span class="classifier">a single float or an array of npart float32</span></dt><dd><p>particle mass(es) used for weighting</p>
</dd>
<dt>ids<span class="classifier">numpy array of npart int64 values</span></dt><dd><p>if specified these will be used for sorting the positions</p>
</dd>
<dt>usecic<span class="classifier">boolean</span></dt><dd><p>set to True if you want a cic binning (otherwise ngp)</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>verbosity (can be 0 for no output or higher)</p>
</dd>
</dl>
<p>don’t use these for now, look into qtets.imagenew for more information</p>
<p>Typically you want to call this function in the following manner
proj = matrix_perspective_lookat(…)
myim = vi.qtets_image(pos, proj, npix=.., boxsize=.., wrapto=..,</p>
<blockquote>
<div><p>maxngrid=4, nthreads=4)</p>
</div></blockquote>
<p>where npix and maxngrid are the main quality parameters. Make sure
that pos and proj are float32 arrays with the correct shapes.
More advanced features are best interfaced through the Visualization
class below</p>
<p>catch errors with wrong shapes
catch error for int32 ids
simplify code for checking input</p>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.make_animation">
<code class="sig-name descname">make_animation</code><span class="sig-paren">(</span><em class="sig-param">images</em>, <em class="sig-param">dpi=96</em>, <em class="sig-param">colormap='inferno'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.make_animation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.make_animation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.make_movie">
<code class="sig-name descname">make_movie</code><span class="sig-paren">(</span><em class="sig-param">camera_path</em>, <em class="sig-param">outputdir</em>, <em class="sig-param">cachefile=None</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">resetcache=True</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">frames=None</em>, <em class="sig-param">doffmpeg=False</em>, <em class="sig-param">framerate=24</em>, <em class="sig-param">tetnbody=None</em>, <em class="sig-param">label=''</em>, <em class="sig-param">colormap='cubehelix'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.make_movie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.make_movie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.project_points">
<code class="sig-name descname">project_points</code><span class="sig-paren">(</span><em class="sig-param">pos=None</em>, <em class="sig-param">boxwrapping=False</em>, <em class="sig-param">nthreads=1</em>, <em class="sig-param">wrapto=None</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">clipping=True</em>, <em class="sig-param">pixels=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.project_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.project_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Projects points in to the image plane normalized to (-0.5,0.5)</p>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_fade_equation">
<code class="sig-name descname">set_fade_equation</code><span class="sig-paren">(</span><em class="sig-param">ri=None</em>, <em class="sig-param">rclip=None</em>, <em class="sig-param">rfade=None</em>, <em class="sig-param">r0=1.0</em>, <em class="sig-param">rpow=0.0</em>, <em class="sig-param">plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_fade_equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_fade_equation" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives some intuitive interface for the fading equation</p>
<p>The goal is to define a set of ri and fi values as a radial 
weighting function. Use plot=True to see what happens</p>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_fading">
<code class="sig-name descname">set_fading</code><span class="sig-paren">(</span><em class="sig-param">ri</em>, <em class="sig-param">fi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_fading"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_fading" title="Permalink to this definition">¶</a></dt>
<dd><p>set fading (distance dependent weights)</p>
<p>ri : radii of the weights
fi : weights</p>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_fixed_smoothing">
<code class="sig-name descname">set_fixed_smoothing</code><span class="sig-paren">(</span><em class="sig-param">r=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_fixed_smoothing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_fixed_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>set a fixed smoothing</p>
<dl class="simple">
<dt>r<span class="classifier">float</span></dt><dd><p>size of the smoothing in percent of the image width</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_mixed_tetnb">
<code class="sig-name descname">set_mixed_tetnb</code><span class="sig-paren">(</span><em class="sig-param">relf</em>, <em class="sig-param">npos=None</em>, <em class="sig-param">mass=0.015625</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_mixed_tetnb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_mixed_tetnb" title="Permalink to this definition">¶</a></dt>
<dd><p>relf has shape (ngrid/2, ngrid/2, ngrid/2)</p>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_ortho_projection">
<code class="sig-name descname">set_ortho_projection</code><span class="sig-paren">(</span><em class="sig-param">eye=(0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">-1)</em>, <em class="sig-param">lookat=(0.0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">up=(0.0</em>, <em class="sig-param">1.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">width=1.0</em>, <em class="sig-param">height=None</em>, <em class="sig-param">zclip=(0.0</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">wrapto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_ortho_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_ortho_projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_perspective_projection">
<code class="sig-name descname">set_perspective_projection</code><span class="sig-paren">(</span><em class="sig-param">eye=(0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">-1)</em>, <em class="sig-param">lookat=(0.0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">up=(0.0</em>, <em class="sig-param">1.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">angle=1.0</em>, <em class="sig-param">zclip=(0.0001</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">aspect=None</em>, <em class="sig-param">wrapto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_perspective_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_perspective_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the projection matrix to a planar perspective lookat projection
Chains a projection matrix “lookat” with a perspective projection</p>
<blockquote>
<div><p>See matrix_perspective (defines position/directions) and matrix_look_at 
(defines camera angle and clipping) for detailled explanations:</p>
<p>eye : (3 component) location of the camera
lookat : (3 component) location the camera is looking at
up : (3 component) the y-direction in the image
angle : opening angle of the projection
znear : close clipping plane
zfar : far away clipping plane
aspect : aspect ratio of the camera image</p>
<p>res : (4,4) projection matrix (homogeneous coordinates)</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_pos">
<code class="sig-name descname">set_pos</code><span class="sig-paren">(</span><em class="sig-param">pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_pos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_projection">
<code class="sig-name descname">set_projection</code><span class="sig-paren">(</span><em class="sig-param">projection</em>, <em class="sig-param">spherical=None</em>, <em class="sig-param">wrapto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_smoothing">
<code class="sig-name descname">set_smoothing</code><span class="sig-paren">(</span><em class="sig-param">rbins=None</em>, <em class="sig-param">rfac=1.0</em>, <em class="sig-param">extsize=None</em>, <em class="sig-param">nbrfac=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_smoothing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>set an adaptive smoothing</p>
<p>Set smoothing with number of rbins different kernelsizes
rbins can be an array or an integer (recommended). – 
this is normalized to the mean particle separation. For simulations
this is a good choice generally. However, in other cases you can use 
the parameter extsize to rescale the default physical width of the 
kernels</p>
<dl class="simple">
<dt>extsize<span class="classifier">Can be used to manipulate the calculation of the mean particle</span></dt><dd><p>separation (default extsize=boxsize). dr = extsize/cbrt(npart)
This can be used as a constant factor to rescale the kernel size to fit
into the kernel bins</p>
</dd>
<dt>rbins<span class="classifier">the kernel bin boundaries or the number of bins </span></dt><dd><p>This is given in image coordinates. E.g. a kernel size of
0.3 means that the sigma of a gaussian kernel is 30% of the
image width</p>
</dd>
</dl>
<p>rfac : has a similar effect like extsize, but is only applied after the binning</p>
</dd></dl>

<dl class="method">
<dt id="bacco.visualization.Visualization.set_spherical_projection">
<code class="sig-name descname">set_spherical_projection</code><span class="sig-paren">(</span><em class="sig-param">eye=(0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">-1)</em>, <em class="sig-param">lookat=(0.0</em>, <em class="sig-param">0.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">up=(0.0</em>, <em class="sig-param">1.0</em>, <em class="sig-param">0.0)</em>, <em class="sig-param">rclip=(0.0</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">wrapto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco/visualization.html#Visualization.set_spherical_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.visualization.Visualization.set_spherical_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up a spherical projection</p>
<blockquote>
<div><p>Sets up a spherical projection and defines the camera position/direction 
through a look_at matrix as in matrix_lookat</p>
<dl class="simple">
<dt>rclip<span class="classifier">tuple with 2 entries (rnear, rfar)</span></dt><dd><p>inner / outer clipping boundary</p>
</dd>
</dl>
<p class="attribution">—matrix_lookat —
Creates a rotation/translation matrix in homogeneous coordinates</p>
</div></blockquote>
<p>This function creates a projection matrix which rotates/translates
the coordinate system so that an object (lookat) is focused from
the camera position (eye)</p>
<p>eye : (3 component) location of the camera
lookat : (3 component) location the camera is looking at
up : (3 component) the y-direction in the image</p>
<p>res : (4,4) projection matrix (homogeneous coordinates)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-bacco">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bacco" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bacco.test">
<code class="sig-prename descclassname">bacco.</code><code class="sig-name descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bacco.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bacco.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Raul E. Angulo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>